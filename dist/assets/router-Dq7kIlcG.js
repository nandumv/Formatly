const Ft={view:"builder",resume:{meta:{score:0,border:!1,template:"modern"},personal:{firstName:"",lastName:"",jobTitle:"",email:"",phone:"",linkedin:"",country:"",city:"",address:"",postalCode:""},socials:[],languages:[],summary:"",education:[],experience:[],skills:[],projects:[],certifications:[],awards:[],interests:"",references:[],references:[],custom:[]},aiUsage:{experience:0,summary:0,skills:0,jobMatch:0},limits:{free:3}},hn=new Set,ye={get:()=>Ft,update:(t,e)=>{const r=t.split(".");let a=Ft;for(let u=0;u<r.length-1;u++)a=a[r[u]];a[r[r.length-1]]=e,yr()},addItem:(t,e)=>{const r=t.split(".");let a=Ft;for(let u=0;u<r.length;u++)a=a[r[u]];Array.isArray(a)&&(a.push(e),yr())},removeItem:(t,e)=>{const r=t.split(".");let a=Ft;for(let l=0;l<r.length-1;l++)a=a[r[l]];const u=r[r.length-1];Array.isArray(a[u])&&(a[u]=a[u].filter(l=>l.id!==e),yr())},subscribe:t=>(hn.add(t),()=>hn.delete(t))};function yr(){hn.forEach(t=>t(Ft))}function pa(t){t.innerHTML=`
    <!-- Navbar -->
    <nav class="navbar">
        <div class="container nav-content">
            <div class="logo">FORMATLY</div>
            <div class="nav-links">
                <a href="#" class="active">Resume Builder</a>
                <a href="#" style="opacity:0.6; cursor:not-allowed;">Cover Letter (Soon)</a>
                <a href="#" style="opacity:0.6; cursor:not-allowed;">About</a>
            </div>
            <button class="btn btn-primary glow-effect" onclick="window.location.hash='#builder'">Get Started</button>
        </div>
    </nav>

    <!-- Hero Section -->
    <header class="hero">
        <div class="container hero-content">
            <div class="badge">âœ¨ v2.0 Now Available</div>
            <h1 class="hero-title">Create Perfect <span class="gradient-text">Documents</span> Instantly.</h1>
            <p class="hero-subtitle">Effortless Formatting. Instant Results. Join thousands of professionals creating ATS-friendly resumes in minutes.</p>
            <div class="hero-actions">
                <button class="btn btn-primary btn-lg glow-effect" onclick="window.navigate('builder')">Build Resume Now</button>
                <button class="btn btn-secondary btn-lg">View Samples</button>
            </div>
        </div>
         <div class="hero-background">
            <div class="blob blob-1"></div>
            <div class="blob blob-2"></div>
        </div>
    </header>

    <!-- Features Section -->
    <section class="features">
        <div class="container">
            <div class="section-title">
                <h2>Why Choose Formatly?</h2>
                <p>Powerful features to help you land your dream job.</p>
            </div>
            <div class="features-grid">
                <div class="feature-card">
                    <div class="icon-box">âš¡</div>
                    <h3>Instant Generation</h3>
                    <p>Create polished DOCX files in seconds. No complex formatting required.</p>
                </div>
                <div class="feature-card">
                    <div class="icon-box">ðŸ§ </div>
                    <h3>AI Assistant</h3>
                    <p>Built-in AI tools to enhance your summary, experience, and skills.</p>
                </div>
                <div class="feature-card">
                    <div class="icon-box">ðŸŽ¯</div>
                    <h3>ATS Optimized</h3>
                    <p>Designed to pass Applicant Tracking Systems with 99% success rate.</p>
                </div>
                 <div class="feature-card">
                    <div class="icon-box">ðŸŽ¨</div>
                    <h3>Premium Design</h3>
                    <p>Modern, professional layouts that stand out to recruiters.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2026 Formatly. All Rights Reserved.</p>
        </div>
    </footer>
    `}function gt(){const t=document.getElementById("resume-preview");if(!t)return;const e=ye.get().resume;t.style.border=e.meta.border?"1.5pt solid black":"none";const r=`
        text-align: center;
        margin-bottom: 10pt;
        border-bottom: 1px solid black;
        padding-bottom: 5pt;
    `,a=`
        background-color: #e5e7eb; 
        font-size: 14pt; 
        font-weight: bold; 
        text-transform: uppercase; 
        padding: 2pt 4pt;
        margin-top: 10pt;
        margin-bottom: 6pt;
    `,u=`
        display: flex; 
        justify-content: space-between; 
        align-items: baseline;
        font-size: 12pt;
        margin-top: 6pt;
    `;let l=`
        <div style="${r}">
            <div style="font-size: 16pt; font-weight: bold; text-transform: uppercase;">${(e.personal.firstName+" "+e.personal.lastName).toUpperCase()||"YOUR NAME"}</div>
            <div style="font-size: 11pt; margin-top: 2pt;">${(e.personal.jobTitle||"").toUpperCase()}</div>
            <div style="font-size: 10pt; margin-top: 4pt;">
                ${[e.personal.city,e.personal.country].filter(Boolean).join(", ")}
            </div>
            <div style="font-size: 10pt;">
                ${[e.personal.email,e.personal.phone].filter(Boolean).join(" | ")}
            </div>
             <div style="font-size: 10pt;">
                ${[e.personal.linkedin,e.personal.address].filter(Boolean).join(" | ")}
            </div>
             <div style="font-size: 10pt;">
                 ${e.socials.map(o=>o.url).join(" | ")}
            </div>
        </div>
    `;e.summary&&e.summary.trim()&&(l+=`
            <div style="${a}">Professional Summary</div>
            <div class="preview-body" style="text-align: justify;">${e.summary}</div>
        `),e.experience.length>0&&(l+=`<div style="${a}">Experience</div>`,e.experience.forEach(o=>{l+=`
                <div>
                    <div style="${u}">
                        <div style="font-weight: bold;">${o.jobTitle}</div>
                        <div style="font-weight: bold;">${o.startDate} â€“ ${o.endDate}</div>
                    </div>
                    <div style="${u}; margin-top: 0;">
                        <div style="font-style: italic;">${o.employer}</div>
                        <div style="font-style: italic;">${o.city}</div>
                    </div>
                    <div class="preview-body" style="margin-top: 4pt;">${o.desc?"â€¢ "+o.desc.replaceAll(`
`,"<br>â€¢ "):""}</div>
                </div>
            `})),e.education.length>0&&(l+=`<div style="${a}">Education</div>`,e.education.forEach(o=>{l+=`
                 <div>
                    <div style="${u}">
                        <div style="font-weight: bold;">${o.institution}</div>
                        <div style="font-weight: bold;">${o.startDate} â€“ ${o.endDate}</div>
                    </div>
                    <div style="${u}; margin-top: 0;">
                        <div style="font-style: italic;">${o.degree}</div>
                        <div style="font-style: italic;">${o.city}</div>
                    </div>
                    <div class="preview-body" style="margin-top: 2pt;">${o.desc}</div>
                </div>
            `})),e.skills.length>0&&(l+=`<div style="${a}">Skills</div>`,l+='<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 12pt;">',e.skills.forEach(o=>{l+=`<div>â€¢ <span style="font-weight: bold;">${o.name}</span></div>`}),l+="</div>"),e.languages.length>0&&(l+=`<div style="${a}">Languages</div>`,l+='<div style="display: flex; gap: 15px; flex-wrap: wrap;">',e.languages.forEach(o=>{l+=`<div style="font-size: 12pt;">â€¢ <b>${o.language}</b>: ${o.proficiency}</div>`}),l+="</div>"),e.projects.length>0&&(l+=`<div style="${a}">Projects</div>`,e.projects.forEach(o=>{l+=`
                <div style="margin-bottom: 6pt;">
                    <div style="font-weight: bold; font-size: 12pt;">${o.title}</div>
                    <div class="preview-body">${o.desc}</div>
                </div>
            `})),e.certifications.length>0&&(l+=`<div style="${a}">Certifications</div><ul>`,e.certifications.forEach(o=>{l+=`<li class="preview-body">${o.name}</li>`}),l+="</ul>"),e.awards.length>0&&(l+=`<div style="${a}">Awards</div><ul>`,e.awards.forEach(o=>{l+=`<li class="preview-body"><b>${o.name}</b> ${o.desc?"- "+o.desc:""}</li>`}),l+="</ul>"),e.interests&&(l+=`<div style="${a}">Interests</div>`,l+=`<div class="preview-body">${e.interests}</div>`),e.references.length>0&&(l+=`<div style="${a}">References</div>`,e.references.forEach(o=>{l+=`<div class="preview-body">â€¢ <b>${o.name}</b> (${o.contact})</div>`})),e.custom.length>0&&e.custom.forEach(o=>{l+=`<div style="${a}">${o.title}</div>`,l+=`<div class="preview-body">${o.content}</div>`}),t.innerHTML=l,t.innerHTML=l,t.classList.remove("fade-in"),t.offsetWidth,t.classList.add("fade-in")}var ma=Object.defineProperty,wa=Object.defineProperties,ga=Object.getOwnPropertyDescriptors,Jn=Object.getOwnPropertySymbols,ya=Object.prototype.hasOwnProperty,va=Object.prototype.propertyIsEnumerable,pn=(t,e,r)=>e in t?ma(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ve=(t,e)=>{for(var r in e||(e={}))ya.call(e,r)&&pn(t,r,e[r]);if(Jn)for(var r of Jn(e))va.call(e,r)&&pn(t,r,e[r]);return t},Dt=(t,e)=>wa(t,ga(e)),re=(t,e,r)=>(pn(t,typeof e!="symbol"?e+"":e,r),r),zt=(t,e,r)=>new Promise((a,u)=>{var l=c=>{try{s(r.next(c))}catch(y){u(y)}},o=c=>{try{s(r.throw(c))}catch(y){u(y)}},s=c=>c.done?a(c.value):Promise.resolve(c.value).then(l,o);s((r=r.apply(t,e)).next())});class er{constructor(e){re(this,"rootKey"),this.rootKey=e}}const ba=Object.seal({});class ne extends er{constructor(e){super(e),re(this,"root"),this.root=new Array}prepForXml(e){var r;e.stack.push(this);const a=this.root.map(u=>u instanceof er?u.prepForXml(e):u).filter(u=>u!==void 0);return e.stack.pop(),{[this.rootKey]:a.length?a.length===1&&((r=a[0])!=null&&r._attr)?a[0]:a:ba}}addChildElement(e){return this.root.push(e),this}}class Xe extends ne{prepForXml(e){const r=super.prepForXml(e);if(r&&(typeof r[this.rootKey]!="object"||Object.keys(r[this.rootKey]).length))return r}}class pe extends er{constructor(e){super("_attr"),re(this,"xmlKeys"),this.root=e}prepForXml(e){const r={};return Object.keys(this.root).forEach(a=>{const u=this.root[a];if(u!==void 0){const l=this.xmlKeys&&this.xmlKeys[a]||a;r[l]=u}}),{_attr:r}}}class rt extends er{constructor(e){super("_attr"),this.root=e}prepForXml(e){return{_attr:Object.values(this.root).filter(({value:a})=>a!==void 0).reduce((a,{key:u,value:l})=>Dt(ve({},a),{[u]:l}),{})}}}class Te extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{val:"w:val",color:"w:color",fill:"w:fill",space:"w:space",sz:"w:sz",type:"w:type",rsidR:"w:rsidR",rsidRPr:"w:rsidRPr",rsidSect:"w:rsidSect",w:"w:w",h:"w:h",top:"w:top",right:"w:right",bottom:"w:bottom",left:"w:left",header:"w:header",footer:"w:footer",gutter:"w:gutter",linePitch:"w:linePitch",pos:"w:pos"})}}var Ge=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function os(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ls={},En={exports:{}},ht=typeof Reflect=="object"?Reflect:null,Qn=ht&&typeof ht.apply=="function"?ht.apply:function(e,r,a){return Function.prototype.apply.call(e,r,a)},Zt;ht&&typeof ht.ownKeys=="function"?Zt=ht.ownKeys:Object.getOwnPropertySymbols?Zt=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Zt=function(e){return Object.getOwnPropertyNames(e)};function xa(t){console&&console.warn&&console.warn(t)}var us=Number.isNaN||function(e){return e!==e};function Ee(){Ee.init.call(this)}En.exports=Ee;En.exports.once=Ta;Ee.EventEmitter=Ee;Ee.prototype._events=void 0;Ee.prototype._eventsCount=0;Ee.prototype._maxListeners=void 0;var ei=10;function or(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Ee,"defaultMaxListeners",{enumerable:!0,get:function(){return ei},set:function(t){if(typeof t!="number"||t<0||us(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");ei=t}});Ee.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Ee.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||us(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function cs(t){return t._maxListeners===void 0?Ee.defaultMaxListeners:t._maxListeners}Ee.prototype.getMaxListeners=function(){return cs(this)};Ee.prototype.emit=function(e){for(var r=[],a=1;a<arguments.length;a++)r.push(arguments[a]);var u=e==="error",l=this._events;if(l!==void 0)u=u&&l.error===void 0;else if(!u)return!1;if(u){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var c=l[e];if(c===void 0)return!1;if(typeof c=="function")Qn(c,this,r);else for(var y=c.length,b=ms(c,y),a=0;a<y;++a)Qn(b[a],this,r);return!0};function fs(t,e,r,a){var u,l,o;if(or(r),l=t._events,l===void 0?(l=t._events=Object.create(null),t._eventsCount=0):(l.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),l=t._events),o=l[e]),o===void 0)o=l[e]=r,++t._eventsCount;else if(typeof o=="function"?o=l[e]=a?[r,o]:[o,r]:a?o.unshift(r):o.push(r),u=cs(t),u>0&&o.length>u&&!o.warned){o.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=t,s.type=e,s.count=o.length,xa(s)}return t}Ee.prototype.addListener=function(e,r){return fs(this,e,r,!1)};Ee.prototype.on=Ee.prototype.addListener;Ee.prototype.prependListener=function(e,r){return fs(this,e,r,!0)};function _a(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function ds(t,e,r){var a={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},u=_a.bind(a);return u.listener=r,a.wrapFn=u,u}Ee.prototype.once=function(e,r){return or(r),this.on(e,ds(this,e,r)),this};Ee.prototype.prependOnceListener=function(e,r){return or(r),this.prependListener(e,ds(this,e,r)),this};Ee.prototype.removeListener=function(e,r){var a,u,l,o,s;if(or(r),u=this._events,u===void 0)return this;if(a=u[e],a===void 0)return this;if(a===r||a.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete u[e],u.removeListener&&this.emit("removeListener",e,a.listener||r));else if(typeof a!="function"){for(l=-1,o=a.length-1;o>=0;o--)if(a[o]===r||a[o].listener===r){s=a[o].listener,l=o;break}if(l<0)return this;l===0?a.shift():Ea(a,l),a.length===1&&(u[e]=a[0]),u.removeListener!==void 0&&this.emit("removeListener",e,s||r)}return this};Ee.prototype.off=Ee.prototype.removeListener;Ee.prototype.removeAllListeners=function(e){var r,a,u;if(a=this._events,a===void 0)return this;if(a.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):a[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete a[e]),this;if(arguments.length===0){var l=Object.keys(a),o;for(u=0;u<l.length;++u)o=l[u],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=a[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(u=r.length-1;u>=0;u--)this.removeListener(e,r[u]);return this};function hs(t,e,r){var a=t._events;if(a===void 0)return[];var u=a[e];return u===void 0?[]:typeof u=="function"?r?[u.listener||u]:[u]:r?Sa(u):ms(u,u.length)}Ee.prototype.listeners=function(e){return hs(this,e,!0)};Ee.prototype.rawListeners=function(e){return hs(this,e,!1)};Ee.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):ps.call(t,e)};Ee.prototype.listenerCount=ps;function ps(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Ee.prototype.eventNames=function(){return this._eventsCount>0?Zt(this._events):[]};function ms(t,e){for(var r=new Array(e),a=0;a<e;++a)r[a]=t[a];return r}function Ea(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function Sa(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function Ta(t,e){return new Promise(function(r,a){function u(o){t.removeListener(e,l),a(o)}function l(){typeof t.removeListener=="function"&&t.removeListener("error",u),r([].slice.call(arguments))}ws(t,e,l,{once:!0}),e!=="error"&&Aa(t,u,{once:!0})})}function Aa(t,e,r){typeof t.on=="function"&&ws(t,"error",e,r)}function ws(t,e,r,a){if(typeof t.on=="function")a.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function u(l){a.once&&t.removeEventListener(e,u),r(l)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var Sn=En.exports,mn={exports:{}};typeof Object.create=="function"?mn.exports=function(e,r){r&&(e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:mn.exports=function(e,r){if(r){e.super_=r;var a=function(){};a.prototype=r.prototype,e.prototype=new a,e.prototype.constructor=e}};var ut=mn.exports;function ka(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var gs={exports:{}},Re=gs.exports={},ze,We;function wn(){throw new Error("setTimeout has not been defined")}function gn(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?ze=setTimeout:ze=wn}catch{ze=wn}try{typeof clearTimeout=="function"?We=clearTimeout:We=gn}catch{We=gn}})();function ys(t){if(ze===setTimeout)return setTimeout(t,0);if((ze===wn||!ze)&&setTimeout)return ze=setTimeout,setTimeout(t,0);try{return ze(t,0)}catch{try{return ze.call(null,t,0)}catch{return ze.call(this,t,0)}}}function Ra(t){if(We===clearTimeout)return clearTimeout(t);if((We===gn||!We)&&clearTimeout)return We=clearTimeout,clearTimeout(t);try{return We(t)}catch{try{return We.call(null,t)}catch{return We.call(this,t)}}}var $e=[],pt=!1,at,Jt=-1;function Ia(){!pt||!at||(pt=!1,at.length?$e=at.concat($e):Jt=-1,$e.length&&vs())}function vs(){if(!pt){var t=ys(Ia);pt=!0;for(var e=$e.length;e;){for(at=$e,$e=[];++Jt<e;)at&&at[Jt].run();Jt=-1,e=$e.length}at=null,pt=!1,Ra(t)}}Re.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];$e.push(new bs(t,e)),$e.length===1&&!pt&&ys(vs)};function bs(t,e){this.fun=t,this.array=e}bs.prototype.run=function(){this.fun.apply(null,this.array)};Re.title="browser";Re.browser=!0;Re.env={};Re.argv=[];Re.version="";Re.versions={};function Ye(){}Re.on=Ye;Re.addListener=Ye;Re.once=Ye;Re.off=Ye;Re.removeListener=Ye;Re.removeAllListeners=Ye;Re.emit=Ye;Re.prependListener=Ye;Re.prependOnceListener=Ye;Re.listeners=function(t){return[]};Re.binding=function(t){throw new Error("process.binding is not supported")};Re.cwd=function(){return"/"};Re.chdir=function(t){throw new Error("process.chdir is not supported")};Re.umask=function(){return 0};var Ca=gs.exports;const ge=ka(Ca);var vr,ti;function xs(){return ti||(ti=1,vr=Sn.EventEmitter),vr}var br={},Rt={},ri;function Na(){if(ri)return Rt;ri=1,Rt.byteLength=s,Rt.toByteArray=y,Rt.fromByteArray=x;for(var t=[],e=[],r=typeof Uint8Array<"u"?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=0,l=a.length;u<l;++u)t[u]=a[u],e[a.charCodeAt(u)]=u;e[45]=62,e[95]=63;function o(w){var E=w.length;if(E%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var v=w.indexOf("=");v===-1&&(v=E);var A=v===E?0:4-v%4;return[v,A]}function s(w){var E=o(w),v=E[0],A=E[1];return(v+A)*3/4-A}function c(w,E,v){return(E+v)*3/4-v}function y(w){var E,v=o(w),A=v[0],p=v[1],S=new r(c(w,A,p)),k=0,F=p>0?A-4:A,L;for(L=0;L<F;L+=4)E=e[w.charCodeAt(L)]<<18|e[w.charCodeAt(L+1)]<<12|e[w.charCodeAt(L+2)]<<6|e[w.charCodeAt(L+3)],S[k++]=E>>16&255,S[k++]=E>>8&255,S[k++]=E&255;return p===2&&(E=e[w.charCodeAt(L)]<<2|e[w.charCodeAt(L+1)]>>4,S[k++]=E&255),p===1&&(E=e[w.charCodeAt(L)]<<10|e[w.charCodeAt(L+1)]<<4|e[w.charCodeAt(L+2)]>>2,S[k++]=E>>8&255,S[k++]=E&255),S}function b(w){return t[w>>18&63]+t[w>>12&63]+t[w>>6&63]+t[w&63]}function T(w,E,v){for(var A,p=[],S=E;S<v;S+=3)A=(w[S]<<16&16711680)+(w[S+1]<<8&65280)+(w[S+2]&255),p.push(b(A));return p.join("")}function x(w){for(var E,v=w.length,A=v%3,p=[],S=16383,k=0,F=v-A;k<F;k+=S)p.push(T(w,k,k+S>F?F:k+S));return A===1?(E=w[v-1],p.push(t[E>>2]+t[E<<4&63]+"==")):A===2&&(E=(w[v-2]<<8)+w[v-1],p.push(t[E>>10]+t[E>>4&63]+t[E<<2&63]+"=")),p.join("")}return Rt}var Wt={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var ni;function Oa(){return ni||(ni=1,Wt.read=function(t,e,r,a,u){var l,o,s=u*8-a-1,c=(1<<s)-1,y=c>>1,b=-7,T=r?u-1:0,x=r?-1:1,w=t[e+T];for(T+=x,l=w&(1<<-b)-1,w>>=-b,b+=s;b>0;l=l*256+t[e+T],T+=x,b-=8);for(o=l&(1<<-b)-1,l>>=-b,b+=a;b>0;o=o*256+t[e+T],T+=x,b-=8);if(l===0)l=1-y;else{if(l===c)return o?NaN:(w?-1:1)*(1/0);o=o+Math.pow(2,a),l=l-y}return(w?-1:1)*o*Math.pow(2,l-a)},Wt.write=function(t,e,r,a,u,l){var o,s,c,y=l*8-u-1,b=(1<<y)-1,T=b>>1,x=u===23?Math.pow(2,-24)-Math.pow(2,-77):0,w=a?0:l-1,E=a?1:-1,v=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,o=b):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+T>=1?e+=x/c:e+=x*Math.pow(2,1-T),e*c>=2&&(o++,c/=2),o+T>=b?(s=0,o=b):o+T>=1?(s=(e*c-1)*Math.pow(2,u),o=o+T):(s=e*Math.pow(2,T-1)*Math.pow(2,u),o=0));u>=8;t[r+w]=s&255,w+=E,s/=256,u-=8);for(o=o<<u|s,y+=u;y>0;t[r+w]=o&255,w+=E,o/=256,y-=8);t[r+w-E]|=v*128}),Wt}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var ii;function lr(){return ii||(ii=1,function(t){var e=Na(),r=Oa(),a=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=s,t.SlowBuffer=S,t.INSPECT_MAX_BYTES=50;var u=2147483647;t.kMaxLength=u,s.TYPED_ARRAY_SUPPORT=l(),!s.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function l(){try{var g=new Uint8Array(1),n={foo:function(){return 42}};return Object.setPrototypeOf(n,Uint8Array.prototype),Object.setPrototypeOf(g,n),g.foo()===42}catch{return!1}}Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}});function o(g){if(g>u)throw new RangeError('The value "'+g+'" is invalid for option "size"');var n=new Uint8Array(g);return Object.setPrototypeOf(n,s.prototype),n}function s(g,n,i){if(typeof g=="number"){if(typeof n=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return T(g)}return c(g,n,i)}s.poolSize=8192;function c(g,n,i){if(typeof g=="string")return x(g,n);if(ArrayBuffer.isView(g))return E(g);if(g==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof g);if(Y(g,ArrayBuffer)||g&&Y(g.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Y(g,SharedArrayBuffer)||g&&Y(g.buffer,SharedArrayBuffer)))return v(g,n,i);if(typeof g=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var f=g.valueOf&&g.valueOf();if(f!=null&&f!==g)return s.from(f,n,i);var O=A(g);if(O)return O;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof g[Symbol.toPrimitive]=="function")return s.from(g[Symbol.toPrimitive]("string"),n,i);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof g)}s.from=function(g,n,i){return c(g,n,i)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array);function y(g){if(typeof g!="number")throw new TypeError('"size" argument must be of type number');if(g<0)throw new RangeError('The value "'+g+'" is invalid for option "size"')}function b(g,n,i){return y(g),g<=0?o(g):n!==void 0?typeof i=="string"?o(g).fill(n,i):o(g).fill(n):o(g)}s.alloc=function(g,n,i){return b(g,n,i)};function T(g){return y(g),o(g<0?0:p(g)|0)}s.allocUnsafe=function(g){return T(g)},s.allocUnsafeSlow=function(g){return T(g)};function x(g,n){if((typeof n!="string"||n==="")&&(n="utf8"),!s.isEncoding(n))throw new TypeError("Unknown encoding: "+n);var i=k(g,n)|0,f=o(i),O=f.write(g,n);return O!==i&&(f=f.slice(0,O)),f}function w(g){for(var n=g.length<0?0:p(g.length)|0,i=o(n),f=0;f<n;f+=1)i[f]=g[f]&255;return i}function E(g){if(Y(g,Uint8Array)){var n=new Uint8Array(g);return v(n.buffer,n.byteOffset,n.byteLength)}return w(g)}function v(g,n,i){if(n<0||g.byteLength<n)throw new RangeError('"offset" is outside of buffer bounds');if(g.byteLength<n+(i||0))throw new RangeError('"length" is outside of buffer bounds');var f;return n===void 0&&i===void 0?f=new Uint8Array(g):i===void 0?f=new Uint8Array(g,n):f=new Uint8Array(g,n,i),Object.setPrototypeOf(f,s.prototype),f}function A(g){if(s.isBuffer(g)){var n=p(g.length)|0,i=o(n);return i.length===0||g.copy(i,0,0,n),i}if(g.length!==void 0)return typeof g.length!="number"||d(g.length)?o(0):w(g);if(g.type==="Buffer"&&Array.isArray(g.data))return w(g.data)}function p(g){if(g>=u)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+u.toString(16)+" bytes");return g|0}function S(g){return+g!=g&&(g=0),s.alloc(+g)}s.isBuffer=function(n){return n!=null&&n._isBuffer===!0&&n!==s.prototype},s.compare=function(n,i){if(Y(n,Uint8Array)&&(n=s.from(n,n.offset,n.byteLength)),Y(i,Uint8Array)&&(i=s.from(i,i.offset,i.byteLength)),!s.isBuffer(n)||!s.isBuffer(i))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(n===i)return 0;for(var f=n.length,O=i.length,U=0,P=Math.min(f,O);U<P;++U)if(n[U]!==i[U]){f=n[U],O=i[U];break}return f<O?-1:O<f?1:0},s.isEncoding=function(n){switch(String(n).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(n,i){if(!Array.isArray(n))throw new TypeError('"list" argument must be an Array of Buffers');if(n.length===0)return s.alloc(0);var f;if(i===void 0)for(i=0,f=0;f<n.length;++f)i+=n[f].length;var O=s.allocUnsafe(i),U=0;for(f=0;f<n.length;++f){var P=n[f];if(Y(P,Uint8Array))U+P.length>O.length?s.from(P).copy(O,U):Uint8Array.prototype.set.call(O,P,U);else if(s.isBuffer(P))P.copy(O,U);else throw new TypeError('"list" argument must be an Array of Buffers');U+=P.length}return O};function k(g,n){if(s.isBuffer(g))return g.length;if(ArrayBuffer.isView(g)||Y(g,ArrayBuffer))return g.byteLength;if(typeof g!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof g);var i=g.length,f=arguments.length>2&&arguments[2]===!0;if(!f&&i===0)return 0;for(var O=!1;;)switch(n){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":return h(g).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return i*2;case"hex":return i>>>1;case"base64":return I(g).length;default:if(O)return f?-1:h(g).length;n=(""+n).toLowerCase(),O=!0}}s.byteLength=k;function F(g,n,i){var f=!1;if((n===void 0||n<0)&&(n=0),n>this.length||((i===void 0||i>this.length)&&(i=this.length),i<=0)||(i>>>=0,n>>>=0,i<=n))return"";for(g||(g="utf8");;)switch(g){case"hex":return ee(this,n,i);case"utf8":case"utf-8":return _(this,n,i);case"ascii":return V(this,n,i);case"latin1":case"binary":return de(this,n,i);case"base64":return K(this,n,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return fe(this,n,i);default:if(f)throw new TypeError("Unknown encoding: "+g);g=(g+"").toLowerCase(),f=!0}}s.prototype._isBuffer=!0;function L(g,n,i){var f=g[n];g[n]=g[i],g[i]=f}s.prototype.swap16=function(){var n=this.length;if(n%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var i=0;i<n;i+=2)L(this,i,i+1);return this},s.prototype.swap32=function(){var n=this.length;if(n%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var i=0;i<n;i+=4)L(this,i,i+3),L(this,i+1,i+2);return this},s.prototype.swap64=function(){var n=this.length;if(n%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var i=0;i<n;i+=8)L(this,i,i+7),L(this,i+1,i+6),L(this,i+2,i+5),L(this,i+3,i+4);return this},s.prototype.toString=function(){var n=this.length;return n===0?"":arguments.length===0?_(this,0,n):F.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(n){if(!s.isBuffer(n))throw new TypeError("Argument must be a Buffer");return this===n?!0:s.compare(this,n)===0},s.prototype.inspect=function(){var n="",i=t.INSPECT_MAX_BYTES;return n=this.toString("hex",0,i).replace(/(.{2})/g,"$1 ").trim(),this.length>i&&(n+=" ... "),"<Buffer "+n+">"},a&&(s.prototype[a]=s.prototype.inspect),s.prototype.compare=function(n,i,f,O,U){if(Y(n,Uint8Array)&&(n=s.from(n,n.offset,n.byteLength)),!s.isBuffer(n))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof n);if(i===void 0&&(i=0),f===void 0&&(f=n?n.length:0),O===void 0&&(O=0),U===void 0&&(U=this.length),i<0||f>n.length||O<0||U>this.length)throw new RangeError("out of range index");if(O>=U&&i>=f)return 0;if(O>=U)return-1;if(i>=f)return 1;if(i>>>=0,f>>>=0,O>>>=0,U>>>=0,this===n)return 0;for(var P=U-O,te=f-i,oe=Math.min(P,te),ie=this.slice(O,U),ue=n.slice(i,f),he=0;he<oe;++he)if(ie[he]!==ue[he]){P=ie[he],te=ue[he];break}return P<te?-1:te<P?1:0};function X(g,n,i,f,O){if(g.length===0)return-1;if(typeof i=="string"?(f=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,d(i)&&(i=O?0:g.length-1),i<0&&(i=g.length+i),i>=g.length){if(O)return-1;i=g.length-1}else if(i<0)if(O)i=0;else return-1;if(typeof n=="string"&&(n=s.from(n,f)),s.isBuffer(n))return n.length===0?-1:G(g,n,i,f,O);if(typeof n=="number")return n=n&255,typeof Uint8Array.prototype.indexOf=="function"?O?Uint8Array.prototype.indexOf.call(g,n,i):Uint8Array.prototype.lastIndexOf.call(g,n,i):G(g,[n],i,f,O);throw new TypeError("val must be string, number or Buffer")}function G(g,n,i,f,O){var U=1,P=g.length,te=n.length;if(f!==void 0&&(f=String(f).toLowerCase(),f==="ucs2"||f==="ucs-2"||f==="utf16le"||f==="utf-16le")){if(g.length<2||n.length<2)return-1;U=2,P/=2,te/=2,i/=2}function oe(De,Ze){return U===1?De[Ze]:De.readUInt16BE(Ze*U)}var ie;if(O){var ue=-1;for(ie=i;ie<P;ie++)if(oe(g,ie)===oe(n,ue===-1?0:ie-ue)){if(ue===-1&&(ue=ie),ie-ue+1===te)return ue*U}else ue!==-1&&(ie-=ie-ue),ue=-1}else for(i+te>P&&(i=P-te),ie=i;ie>=0;ie--){for(var he=!0,me=0;me<te;me++)if(oe(g,ie+me)!==oe(n,me)){he=!1;break}if(he)return ie}return-1}s.prototype.includes=function(n,i,f){return this.indexOf(n,i,f)!==-1},s.prototype.indexOf=function(n,i,f){return X(this,n,i,f,!0)},s.prototype.lastIndexOf=function(n,i,f){return X(this,n,i,f,!1)};function Z(g,n,i,f){i=Number(i)||0;var O=g.length-i;f?(f=Number(f),f>O&&(f=O)):f=O;var U=n.length;f>U/2&&(f=U/2);for(var P=0;P<f;++P){var te=parseInt(n.substr(P*2,2),16);if(d(te))return P;g[i+P]=te}return P}function R(g,n,i,f){return N(h(n,g.length-i),g,i,f)}function se(g,n,i,f){return N(M(n),g,i,f)}function ce(g,n,i,f){return N(I(n),g,i,f)}function B(g,n,i,f){return N(D(n,g.length-i),g,i,f)}s.prototype.write=function(n,i,f,O){if(i===void 0)O="utf8",f=this.length,i=0;else if(f===void 0&&typeof i=="string")O=i,f=this.length,i=0;else if(isFinite(i))i=i>>>0,isFinite(f)?(f=f>>>0,O===void 0&&(O="utf8")):(O=f,f=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var U=this.length-i;if((f===void 0||f>U)&&(f=U),n.length>0&&(f<0||i<0)||i>this.length)throw new RangeError("Attempt to write outside buffer bounds");O||(O="utf8");for(var P=!1;;)switch(O){case"hex":return Z(this,n,i,f);case"utf8":case"utf-8":return R(this,n,i,f);case"ascii":case"latin1":case"binary":return se(this,n,i,f);case"base64":return ce(this,n,i,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,n,i,f);default:if(P)throw new TypeError("Unknown encoding: "+O);O=(""+O).toLowerCase(),P=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function K(g,n,i){return n===0&&i===g.length?e.fromByteArray(g):e.fromByteArray(g.slice(n,i))}function _(g,n,i){i=Math.min(g.length,i);for(var f=[],O=n;O<i;){var U=g[O],P=null,te=U>239?4:U>223?3:U>191?2:1;if(O+te<=i){var oe,ie,ue,he;switch(te){case 1:U<128&&(P=U);break;case 2:oe=g[O+1],(oe&192)===128&&(he=(U&31)<<6|oe&63,he>127&&(P=he));break;case 3:oe=g[O+1],ie=g[O+2],(oe&192)===128&&(ie&192)===128&&(he=(U&15)<<12|(oe&63)<<6|ie&63,he>2047&&(he<55296||he>57343)&&(P=he));break;case 4:oe=g[O+1],ie=g[O+2],ue=g[O+3],(oe&192)===128&&(ie&192)===128&&(ue&192)===128&&(he=(U&15)<<18|(oe&63)<<12|(ie&63)<<6|ue&63,he>65535&&he<1114112&&(P=he))}}P===null?(P=65533,te=1):P>65535&&(P-=65536,f.push(P>>>10&1023|55296),P=56320|P&1023),f.push(P),O+=te}return le(f)}var $=4096;function le(g){var n=g.length;if(n<=$)return String.fromCharCode.apply(String,g);for(var i="",f=0;f<n;)i+=String.fromCharCode.apply(String,g.slice(f,f+=$));return i}function V(g,n,i){var f="";i=Math.min(g.length,i);for(var O=n;O<i;++O)f+=String.fromCharCode(g[O]&127);return f}function de(g,n,i){var f="";i=Math.min(g.length,i);for(var O=n;O<i;++O)f+=String.fromCharCode(g[O]);return f}function ee(g,n,i){var f=g.length;(!n||n<0)&&(n=0),(!i||i<0||i>f)&&(i=f);for(var O="",U=n;U<i;++U)O+=q[g[U]];return O}function fe(g,n,i){for(var f=g.slice(n,i),O="",U=0;U<f.length-1;U+=2)O+=String.fromCharCode(f[U]+f[U+1]*256);return O}s.prototype.slice=function(n,i){var f=this.length;n=~~n,i=i===void 0?f:~~i,n<0?(n+=f,n<0&&(n=0)):n>f&&(n=f),i<0?(i+=f,i<0&&(i=0)):i>f&&(i=f),i<n&&(i=n);var O=this.subarray(n,i);return Object.setPrototypeOf(O,s.prototype),O};function W(g,n,i){if(g%1!==0||g<0)throw new RangeError("offset is not uint");if(g+n>i)throw new RangeError("Trying to access beyond buffer length")}s.prototype.readUintLE=s.prototype.readUIntLE=function(n,i,f){n=n>>>0,i=i>>>0,f||W(n,i,this.length);for(var O=this[n],U=1,P=0;++P<i&&(U*=256);)O+=this[n+P]*U;return O},s.prototype.readUintBE=s.prototype.readUIntBE=function(n,i,f){n=n>>>0,i=i>>>0,f||W(n,i,this.length);for(var O=this[n+--i],U=1;i>0&&(U*=256);)O+=this[n+--i]*U;return O},s.prototype.readUint8=s.prototype.readUInt8=function(n,i){return n=n>>>0,i||W(n,1,this.length),this[n]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(n,i){return n=n>>>0,i||W(n,2,this.length),this[n]|this[n+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(n,i){return n=n>>>0,i||W(n,2,this.length),this[n]<<8|this[n+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(n,i){return n=n>>>0,i||W(n,4,this.length),(this[n]|this[n+1]<<8|this[n+2]<<16)+this[n+3]*16777216},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(n,i){return n=n>>>0,i||W(n,4,this.length),this[n]*16777216+(this[n+1]<<16|this[n+2]<<8|this[n+3])},s.prototype.readIntLE=function(n,i,f){n=n>>>0,i=i>>>0,f||W(n,i,this.length);for(var O=this[n],U=1,P=0;++P<i&&(U*=256);)O+=this[n+P]*U;return U*=128,O>=U&&(O-=Math.pow(2,8*i)),O},s.prototype.readIntBE=function(n,i,f){n=n>>>0,i=i>>>0,f||W(n,i,this.length);for(var O=i,U=1,P=this[n+--O];O>0&&(U*=256);)P+=this[n+--O]*U;return U*=128,P>=U&&(P-=Math.pow(2,8*i)),P},s.prototype.readInt8=function(n,i){return n=n>>>0,i||W(n,1,this.length),this[n]&128?(255-this[n]+1)*-1:this[n]},s.prototype.readInt16LE=function(n,i){n=n>>>0,i||W(n,2,this.length);var f=this[n]|this[n+1]<<8;return f&32768?f|4294901760:f},s.prototype.readInt16BE=function(n,i){n=n>>>0,i||W(n,2,this.length);var f=this[n+1]|this[n]<<8;return f&32768?f|4294901760:f},s.prototype.readInt32LE=function(n,i){return n=n>>>0,i||W(n,4,this.length),this[n]|this[n+1]<<8|this[n+2]<<16|this[n+3]<<24},s.prototype.readInt32BE=function(n,i){return n=n>>>0,i||W(n,4,this.length),this[n]<<24|this[n+1]<<16|this[n+2]<<8|this[n+3]},s.prototype.readFloatLE=function(n,i){return n=n>>>0,i||W(n,4,this.length),r.read(this,n,!0,23,4)},s.prototype.readFloatBE=function(n,i){return n=n>>>0,i||W(n,4,this.length),r.read(this,n,!1,23,4)},s.prototype.readDoubleLE=function(n,i){return n=n>>>0,i||W(n,8,this.length),r.read(this,n,!0,52,8)},s.prototype.readDoubleBE=function(n,i){return n=n>>>0,i||W(n,8,this.length),r.read(this,n,!1,52,8)};function C(g,n,i,f,O,U){if(!s.isBuffer(g))throw new TypeError('"buffer" argument must be a Buffer instance');if(n>O||n<U)throw new RangeError('"value" argument is out of bounds');if(i+f>g.length)throw new RangeError("Index out of range")}s.prototype.writeUintLE=s.prototype.writeUIntLE=function(n,i,f,O){if(n=+n,i=i>>>0,f=f>>>0,!O){var U=Math.pow(2,8*f)-1;C(this,n,i,f,U,0)}var P=1,te=0;for(this[i]=n&255;++te<f&&(P*=256);)this[i+te]=n/P&255;return i+f},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(n,i,f,O){if(n=+n,i=i>>>0,f=f>>>0,!O){var U=Math.pow(2,8*f)-1;C(this,n,i,f,U,0)}var P=f-1,te=1;for(this[i+P]=n&255;--P>=0&&(te*=256);)this[i+P]=n/te&255;return i+f},s.prototype.writeUint8=s.prototype.writeUInt8=function(n,i,f){return n=+n,i=i>>>0,f||C(this,n,i,1,255,0),this[i]=n&255,i+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(n,i,f){return n=+n,i=i>>>0,f||C(this,n,i,2,65535,0),this[i]=n&255,this[i+1]=n>>>8,i+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(n,i,f){return n=+n,i=i>>>0,f||C(this,n,i,2,65535,0),this[i]=n>>>8,this[i+1]=n&255,i+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(n,i,f){return n=+n,i=i>>>0,f||C(this,n,i,4,4294967295,0),this[i+3]=n>>>24,this[i+2]=n>>>16,this[i+1]=n>>>8,this[i]=n&255,i+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(n,i,f){return n=+n,i=i>>>0,f||C(this,n,i,4,4294967295,0),this[i]=n>>>24,this[i+1]=n>>>16,this[i+2]=n>>>8,this[i+3]=n&255,i+4},s.prototype.writeIntLE=function(n,i,f,O){if(n=+n,i=i>>>0,!O){var U=Math.pow(2,8*f-1);C(this,n,i,f,U-1,-U)}var P=0,te=1,oe=0;for(this[i]=n&255;++P<f&&(te*=256);)n<0&&oe===0&&this[i+P-1]!==0&&(oe=1),this[i+P]=(n/te>>0)-oe&255;return i+f},s.prototype.writeIntBE=function(n,i,f,O){if(n=+n,i=i>>>0,!O){var U=Math.pow(2,8*f-1);C(this,n,i,f,U-1,-U)}var P=f-1,te=1,oe=0;for(this[i+P]=n&255;--P>=0&&(te*=256);)n<0&&oe===0&&this[i+P+1]!==0&&(oe=1),this[i+P]=(n/te>>0)-oe&255;return i+f},s.prototype.writeInt8=function(n,i,f){return n=+n,i=i>>>0,f||C(this,n,i,1,127,-128),n<0&&(n=255+n+1),this[i]=n&255,i+1},s.prototype.writeInt16LE=function(n,i,f){return n=+n,i=i>>>0,f||C(this,n,i,2,32767,-32768),this[i]=n&255,this[i+1]=n>>>8,i+2},s.prototype.writeInt16BE=function(n,i,f){return n=+n,i=i>>>0,f||C(this,n,i,2,32767,-32768),this[i]=n>>>8,this[i+1]=n&255,i+2},s.prototype.writeInt32LE=function(n,i,f){return n=+n,i=i>>>0,f||C(this,n,i,4,2147483647,-2147483648),this[i]=n&255,this[i+1]=n>>>8,this[i+2]=n>>>16,this[i+3]=n>>>24,i+4},s.prototype.writeInt32BE=function(n,i,f){return n=+n,i=i>>>0,f||C(this,n,i,4,2147483647,-2147483648),n<0&&(n=4294967295+n+1),this[i]=n>>>24,this[i+1]=n>>>16,this[i+2]=n>>>8,this[i+3]=n&255,i+4};function z(g,n,i,f,O,U){if(i+f>g.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function H(g,n,i,f,O){return n=+n,i=i>>>0,O||z(g,n,i,4),r.write(g,n,i,f,23,4),i+4}s.prototype.writeFloatLE=function(n,i,f){return H(this,n,i,!0,f)},s.prototype.writeFloatBE=function(n,i,f){return H(this,n,i,!1,f)};function Q(g,n,i,f,O){return n=+n,i=i>>>0,O||z(g,n,i,8),r.write(g,n,i,f,52,8),i+8}s.prototype.writeDoubleLE=function(n,i,f){return Q(this,n,i,!0,f)},s.prototype.writeDoubleBE=function(n,i,f){return Q(this,n,i,!1,f)},s.prototype.copy=function(n,i,f,O){if(!s.isBuffer(n))throw new TypeError("argument should be a Buffer");if(f||(f=0),!O&&O!==0&&(O=this.length),i>=n.length&&(i=n.length),i||(i=0),O>0&&O<f&&(O=f),O===f||n.length===0||this.length===0)return 0;if(i<0)throw new RangeError("targetStart out of bounds");if(f<0||f>=this.length)throw new RangeError("Index out of range");if(O<0)throw new RangeError("sourceEnd out of bounds");O>this.length&&(O=this.length),n.length-i<O-f&&(O=n.length-i+f);var U=O-f;return this===n&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(i,f,O):Uint8Array.prototype.set.call(n,this.subarray(f,O),i),U},s.prototype.fill=function(n,i,f,O){if(typeof n=="string"){if(typeof i=="string"?(O=i,i=0,f=this.length):typeof f=="string"&&(O=f,f=this.length),O!==void 0&&typeof O!="string")throw new TypeError("encoding must be a string");if(typeof O=="string"&&!s.isEncoding(O))throw new TypeError("Unknown encoding: "+O);if(n.length===1){var U=n.charCodeAt(0);(O==="utf8"&&U<128||O==="latin1")&&(n=U)}}else typeof n=="number"?n=n&255:typeof n=="boolean"&&(n=Number(n));if(i<0||this.length<i||this.length<f)throw new RangeError("Out of range index");if(f<=i)return this;i=i>>>0,f=f===void 0?this.length:f>>>0,n||(n=0);var P;if(typeof n=="number")for(P=i;P<f;++P)this[P]=n;else{var te=s.isBuffer(n)?n:s.from(n,O),oe=te.length;if(oe===0)throw new TypeError('The value "'+n+'" is invalid for argument "value"');for(P=0;P<f-i;++P)this[P+i]=te[P%oe]}return this};var j=/[^+/0-9A-Za-z-_]/g;function m(g){if(g=g.split("=")[0],g=g.trim().replace(j,""),g.length<2)return"";for(;g.length%4!==0;)g=g+"=";return g}function h(g,n){n=n||1/0;for(var i,f=g.length,O=null,U=[],P=0;P<f;++P){if(i=g.charCodeAt(P),i>55295&&i<57344){if(!O){if(i>56319){(n-=3)>-1&&U.push(239,191,189);continue}else if(P+1===f){(n-=3)>-1&&U.push(239,191,189);continue}O=i;continue}if(i<56320){(n-=3)>-1&&U.push(239,191,189),O=i;continue}i=(O-55296<<10|i-56320)+65536}else O&&(n-=3)>-1&&U.push(239,191,189);if(O=null,i<128){if((n-=1)<0)break;U.push(i)}else if(i<2048){if((n-=2)<0)break;U.push(i>>6|192,i&63|128)}else if(i<65536){if((n-=3)<0)break;U.push(i>>12|224,i>>6&63|128,i&63|128)}else if(i<1114112){if((n-=4)<0)break;U.push(i>>18|240,i>>12&63|128,i>>6&63|128,i&63|128)}else throw new Error("Invalid code point")}return U}function M(g){for(var n=[],i=0;i<g.length;++i)n.push(g.charCodeAt(i)&255);return n}function D(g,n){for(var i,f,O,U=[],P=0;P<g.length&&!((n-=2)<0);++P)i=g.charCodeAt(P),f=i>>8,O=i%256,U.push(O),U.push(f);return U}function I(g){return e.toByteArray(m(g))}function N(g,n,i,f){for(var O=0;O<f&&!(O+i>=n.length||O>=g.length);++O)n[O+i]=g[O];return O}function Y(g,n){return g instanceof n||g!=null&&g.constructor!=null&&g.constructor.name!=null&&g.constructor.name===n.name}function d(g){return g!==g}var q=function(){for(var g="0123456789abcdef",n=new Array(256),i=0;i<16;++i)for(var f=i*16,O=0;O<16;++O)n[f+O]=g[i]+g[O];return n}()}(br)),br}var xr={},_r={},Er,si;function _s(){return si||(si=1,Er=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},r=Symbol("test"),a=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(a)!=="[object Symbol]")return!1;var u=42;e[r]=u;for(r in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var l=Object.getOwnPropertySymbols(e);if(l.length!==1||l[0]!==r||!Object.prototype.propertyIsEnumerable.call(e,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(e,r);if(o.value!==u||o.enumerable!==!0)return!1}return!0}),Er}var Sr,ai;function Tn(){if(ai)return Sr;ai=1;var t=_s();return Sr=function(){return t()&&!!Symbol.toStringTag},Sr}var Tr,oi;function Fa(){if(oi)return Tr;oi=1;var t=typeof Symbol<"u"&&Symbol,e=_s();return Tr=function(){return typeof t!="function"||typeof Symbol!="function"||typeof t("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},Tr}var Ar,li;function Ba(){if(li)return Ar;li=1;var t={foo:{}},e=Object;return Ar=function(){return{__proto__:t}.foo===t.foo&&!({__proto__:null}instanceof e)},Ar}var kr,ui;function Da(){if(ui)return kr;ui=1;var t="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,r=Math.max,a="[object Function]",u=function(c,y){for(var b=[],T=0;T<c.length;T+=1)b[T]=c[T];for(var x=0;x<y.length;x+=1)b[x+c.length]=y[x];return b},l=function(c,y){for(var b=[],T=y,x=0;T<c.length;T+=1,x+=1)b[x]=c[T];return b},o=function(s,c){for(var y="",b=0;b<s.length;b+=1)y+=s[b],b+1<s.length&&(y+=c);return y};return kr=function(c){var y=this;if(typeof y!="function"||e.apply(y)!==a)throw new TypeError(t+y);for(var b=l(arguments,1),T,x=function(){if(this instanceof T){var p=y.apply(this,u(b,arguments));return Object(p)===p?p:this}return y.apply(c,u(b,arguments))},w=r(0,y.length-b.length),E=[],v=0;v<w;v++)E[v]="$"+v;if(T=Function("binder","return function ("+o(E,",")+"){ return binder.apply(this,arguments); }")(x),y.prototype){var A=function(){};A.prototype=y.prototype,T.prototype=new A,A.prototype=null}return T},kr}var Rr,ci;function An(){if(ci)return Rr;ci=1;var t=Da();return Rr=Function.prototype.bind||t,Rr}var Ir,fi;function Pa(){if(fi)return Ir;fi=1;var t=Function.prototype.call,e=Object.prototype.hasOwnProperty,r=An();return Ir=r.call(t,e),Ir}var Cr,di;function Et(){if(di)return Cr;di=1;var t,e=SyntaxError,r=Function,a=TypeError,u=function(B){try{return r('"use strict"; return ('+B+").constructor;")()}catch{}},l=Object.getOwnPropertyDescriptor;if(l)try{l({},"")}catch{l=null}var o=function(){throw new a},s=l?function(){try{return arguments.callee,o}catch{try{return l(arguments,"callee").get}catch{return o}}}():o,c=Fa()(),y=Ba()(),b=Object.getPrototypeOf||(y?function(B){return B.__proto__}:null),T={},x=typeof Uint8Array>"u"||!b?t:b(Uint8Array),w={"%AggregateError%":typeof AggregateError>"u"?t:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?t:ArrayBuffer,"%ArrayIteratorPrototype%":c&&b?b([][Symbol.iterator]()):t,"%AsyncFromSyncIteratorPrototype%":t,"%AsyncFunction%":T,"%AsyncGenerator%":T,"%AsyncGeneratorFunction%":T,"%AsyncIteratorPrototype%":T,"%Atomics%":typeof Atomics>"u"?t:Atomics,"%BigInt%":typeof BigInt>"u"?t:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?t:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?t:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?t:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?t:Float32Array,"%Float64Array%":typeof Float64Array>"u"?t:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?t:FinalizationRegistry,"%Function%":r,"%GeneratorFunction%":T,"%Int8Array%":typeof Int8Array>"u"?t:Int8Array,"%Int16Array%":typeof Int16Array>"u"?t:Int16Array,"%Int32Array%":typeof Int32Array>"u"?t:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":c&&b?b(b([][Symbol.iterator]())):t,"%JSON%":typeof JSON=="object"?JSON:t,"%Map%":typeof Map>"u"?t:Map,"%MapIteratorPrototype%":typeof Map>"u"||!c||!b?t:b(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?t:Promise,"%Proxy%":typeof Proxy>"u"?t:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?t:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?t:Set,"%SetIteratorPrototype%":typeof Set>"u"||!c||!b?t:b(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?t:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":c&&b?b(""[Symbol.iterator]()):t,"%Symbol%":c?Symbol:t,"%SyntaxError%":e,"%ThrowTypeError%":s,"%TypedArray%":x,"%TypeError%":a,"%Uint8Array%":typeof Uint8Array>"u"?t:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?t:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?t:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?t:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?t:WeakMap,"%WeakRef%":typeof WeakRef>"u"?t:WeakRef,"%WeakSet%":typeof WeakSet>"u"?t:WeakSet};if(b)try{null.error}catch(B){var E=b(b(B));w["%Error.prototype%"]=E}var v=function B(K){var _;if(K==="%AsyncFunction%")_=u("async function () {}");else if(K==="%GeneratorFunction%")_=u("function* () {}");else if(K==="%AsyncGeneratorFunction%")_=u("async function* () {}");else if(K==="%AsyncGenerator%"){var $=B("%AsyncGeneratorFunction%");$&&(_=$.prototype)}else if(K==="%AsyncIteratorPrototype%"){var le=B("%AsyncGenerator%");le&&b&&(_=b(le.prototype))}return w[K]=_,_},A={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},p=An(),S=Pa(),k=p.call(Function.call,Array.prototype.concat),F=p.call(Function.apply,Array.prototype.splice),L=p.call(Function.call,String.prototype.replace),X=p.call(Function.call,String.prototype.slice),G=p.call(Function.call,RegExp.prototype.exec),Z=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,R=/\\(\\)?/g,se=function(K){var _=X(K,0,1),$=X(K,-1);if(_==="%"&&$!=="%")throw new e("invalid intrinsic syntax, expected closing `%`");if($==="%"&&_!=="%")throw new e("invalid intrinsic syntax, expected opening `%`");var le=[];return L(K,Z,function(V,de,ee,fe){le[le.length]=ee?L(fe,R,"$1"):de||V}),le},ce=function(K,_){var $=K,le;if(S(A,$)&&(le=A[$],$="%"+le[0]+"%"),S(w,$)){var V=w[$];if(V===T&&(V=v($)),typeof V>"u"&&!_)throw new a("intrinsic "+K+" exists, but is not available. Please file an issue!");return{alias:le,name:$,value:V}}throw new e("intrinsic "+K+" does not exist!")};return Cr=function(K,_){if(typeof K!="string"||K.length===0)throw new a("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof _!="boolean")throw new a('"allowMissing" argument must be a boolean');if(G(/^%?[^%]*%?$/,K)===null)throw new e("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var $=se(K),le=$.length>0?$[0]:"",V=ce("%"+le+"%",_),de=V.name,ee=V.value,fe=!1,W=V.alias;W&&(le=W[0],F($,k([0,1],W)));for(var C=1,z=!0;C<$.length;C+=1){var H=$[C],Q=X(H,0,1),j=X(H,-1);if((Q==='"'||Q==="'"||Q==="`"||j==='"'||j==="'"||j==="`")&&Q!==j)throw new e("property names with quotes must have matching quotes");if((H==="constructor"||!z)&&(fe=!0),le+="."+H,de="%"+le+"%",S(w,de))ee=w[de];else if(ee!=null){if(!(H in ee)){if(!_)throw new a("base intrinsic for "+K+" exists, but the property is not available.");return}if(l&&C+1>=$.length){var m=l(ee,H);z=!!m,z&&"get"in m&&!("originalValue"in m.get)?ee=m.get:ee=ee[H]}else z=S(ee,H),ee=ee[H];z&&!fe&&(w[de]=ee)}}return ee},Cr}var Nr={exports:{}},Or,hi;function Es(){if(hi)return Or;hi=1;var t=Et(),e=t("%Object.defineProperty%",!0),r=function(){if(e)try{return e({},"a",{value:1}),!0}catch{return!1}return!1};return r.hasArrayLengthDefineBug=function(){if(!r())return null;try{return e([],"length",{value:1}).length!==1}catch{return!0}},Or=r,Or}var Fr,pi;function kn(){if(pi)return Fr;pi=1;var t=Et(),e=t("%Object.getOwnPropertyDescriptor%",!0);if(e)try{e([],"length")}catch{e=null}return Fr=e,Fr}var Br,mi;function La(){if(mi)return Br;mi=1;var t=Es()(),e=Et(),r=t&&e("%Object.defineProperty%",!0);if(r)try{r({},"a",{value:1})}catch{r=!1}var a=e("%SyntaxError%"),u=e("%TypeError%"),l=kn();return Br=function(s,c,y){if(!s||typeof s!="object"&&typeof s!="function")throw new u("`obj` must be an object or a function`");if(typeof c!="string"&&typeof c!="symbol")throw new u("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new u("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new u("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new u("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new u("`loose`, if provided, must be a boolean");var b=arguments.length>3?arguments[3]:null,T=arguments.length>4?arguments[4]:null,x=arguments.length>5?arguments[5]:null,w=arguments.length>6?arguments[6]:!1,E=!!l&&l(s,c);if(r)r(s,c,{configurable:x===null&&E?E.configurable:!x,enumerable:b===null&&E?E.enumerable:!b,value:y,writable:T===null&&E?E.writable:!T});else if(w||!b&&!T&&!x)s[c]=y;else throw new a("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},Br}var Dr,wi;function Ma(){if(wi)return Dr;wi=1;var t=Et(),e=La(),r=Es()(),a=kn(),u=t("%TypeError%"),l=t("%Math.floor%");return Dr=function(s,c){if(typeof s!="function")throw new u("`fn` is not a function");if(typeof c!="number"||c<0||c>4294967295||l(c)!==c)throw new u("`length` must be a positive 32-bit integer");var y=arguments.length>2&&!!arguments[2],b=!0,T=!0;if("length"in s&&a){var x=a(s,"length");x&&!x.configurable&&(b=!1),x&&!x.writable&&(T=!1)}return(b||T||!y)&&(r?e(s,"length",c,!0,!0):e(s,"length",c)),s},Dr}var gi;function Ss(){return gi||(gi=1,function(t){var e=An(),r=Et(),a=Ma(),u=r("%TypeError%"),l=r("%Function.prototype.apply%"),o=r("%Function.prototype.call%"),s=r("%Reflect.apply%",!0)||e.call(o,l),c=r("%Object.defineProperty%",!0),y=r("%Math.max%");if(c)try{c({},"a",{value:1})}catch{c=null}t.exports=function(x){if(typeof x!="function")throw new u("a function is required");var w=s(e,o,arguments);return a(w,1+y(0,x.length-(arguments.length-1)),!0)};var b=function(){return s(e,l,arguments)};c?c(t.exports,"apply",{value:b}):t.exports.apply=b}(Nr)),Nr.exports}var Pr,yi;function Ts(){if(yi)return Pr;yi=1;var t=Et(),e=Ss(),r=e(t("String.prototype.indexOf"));return Pr=function(u,l){var o=t(u,!!l);return typeof o=="function"&&r(u,".prototype.")>-1?e(o):o},Pr}var Lr,vi;function Ua(){if(vi)return Lr;vi=1;var t=Tn()(),e=Ts(),r=e("Object.prototype.toString"),a=function(s){return t&&s&&typeof s=="object"&&Symbol.toStringTag in s?!1:r(s)==="[object Arguments]"},u=function(s){return a(s)?!0:s!==null&&typeof s=="object"&&typeof s.length=="number"&&s.length>=0&&r(s)!=="[object Array]"&&r(s.callee)==="[object Function]"},l=function(){return a(arguments)}();return a.isLegacyArguments=u,Lr=l?a:u,Lr}var Mr,bi;function ja(){if(bi)return Mr;bi=1;var t=Object.prototype.toString,e=Function.prototype.toString,r=/^\s*(?:function)?\*/,a=Tn()(),u=Object.getPrototypeOf,l=function(){if(!a)return!1;try{return Function("return function*() {}")()}catch{}},o;return Mr=function(c){if(typeof c!="function")return!1;if(r.test(e.call(c)))return!0;if(!a){var y=t.call(c);return y==="[object GeneratorFunction]"}if(!u)return!1;if(typeof o>"u"){var b=l();o=b?u(b):!1}return u(c)===o},Mr}var Ur,xi;function za(){if(xi)return Ur;xi=1;var t=Function.prototype.toString,e=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,r,a;if(typeof e=="function"&&typeof Object.defineProperty=="function")try{r=Object.defineProperty({},"length",{get:function(){throw a}}),a={},e(function(){throw 42},null,r)}catch(S){S!==a&&(e=null)}else e=null;var u=/^\s*class\b/,l=function(k){try{var F=t.call(k);return u.test(F)}catch{return!1}},o=function(k){try{return l(k)?!1:(t.call(k),!0)}catch{return!1}},s=Object.prototype.toString,c="[object Object]",y="[object Function]",b="[object GeneratorFunction]",T="[object HTMLAllCollection]",x="[object HTML document.all class]",w="[object HTMLCollection]",E=typeof Symbol=="function"&&!!Symbol.toStringTag,v=!(0 in[,]),A=function(){return!1};if(typeof document=="object"){var p=document.all;s.call(p)===s.call(document.all)&&(A=function(k){if((v||!k)&&(typeof k>"u"||typeof k=="object"))try{var F=s.call(k);return(F===T||F===x||F===w||F===c)&&k("")==null}catch{}return!1})}return Ur=e?function(k){if(A(k))return!0;if(!k||typeof k!="function"&&typeof k!="object")return!1;try{e(k,null,r)}catch(F){if(F!==a)return!1}return!l(k)&&o(k)}:function(k){if(A(k))return!0;if(!k||typeof k!="function"&&typeof k!="object")return!1;if(E)return o(k);if(l(k))return!1;var F=s.call(k);return F!==y&&F!==b&&!/^\[object HTML/.test(F)?!1:o(k)},Ur}var jr,_i;function Wa(){if(_i)return jr;_i=1;var t=za(),e=Object.prototype.toString,r=Object.prototype.hasOwnProperty,a=function(c,y,b){for(var T=0,x=c.length;T<x;T++)r.call(c,T)&&(b==null?y(c[T],T,c):y.call(b,c[T],T,c))},u=function(c,y,b){for(var T=0,x=c.length;T<x;T++)b==null?y(c.charAt(T),T,c):y.call(b,c.charAt(T),T,c)},l=function(c,y,b){for(var T in c)r.call(c,T)&&(b==null?y(c[T],T,c):y.call(b,c[T],T,c))},o=function(c,y,b){if(!t(y))throw new TypeError("iterator must be a function");var T;arguments.length>=3&&(T=b),e.call(c)==="[object Array]"?a(c,y,T):typeof c=="string"?u(c,y,T):l(c,y,T)};return jr=o,jr}var zr,Ei;function Ha(){if(Ei)return zr;Ei=1;var t=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],e=typeof globalThis>"u"?Ge:globalThis;return zr=function(){for(var a=[],u=0;u<t.length;u++)typeof e[t[u]]=="function"&&(a[a.length]=t[u]);return a},zr}var Wr,Si;function As(){if(Si)return Wr;Si=1;var t=Wa(),e=Ha(),r=Ss(),a=Ts(),u=kn(),l=a("Object.prototype.toString"),o=Tn()(),s=typeof globalThis>"u"?Ge:globalThis,c=e(),y=a("String.prototype.slice"),b=Object.getPrototypeOf,T=a("Array.prototype.indexOf",!0)||function(A,p){for(var S=0;S<A.length;S+=1)if(A[S]===p)return S;return-1},x={__proto__:null};o&&u&&b?t(c,function(v){var A=new s[v];if(Symbol.toStringTag in A){var p=b(A),S=u(p,Symbol.toStringTag);if(!S){var k=b(p);S=u(k,Symbol.toStringTag)}x["$"+v]=r(S.get)}}):t(c,function(v){var A=new s[v],p=A.slice||A.set;p&&(x["$"+v]=r(p))});var w=function(A){var p=!1;return t(x,function(S,k){if(!p)try{"$"+S(A)===k&&(p=y(k,1))}catch{}}),p},E=function(A){var p=!1;return t(x,function(S,k){if(!p)try{S(A),p=y(k,1)}catch{}}),p};return Wr=function(A){if(!A||typeof A!="object")return!1;if(!o){var p=y(l(A),8,-1);return T(c,p)>-1?p:p!=="Object"?!1:E(A)}return u?w(A):null},Wr}var Hr,Ti;function Ga(){if(Ti)return Hr;Ti=1;var t=As();return Hr=function(r){return!!t(r)},Hr}var Ai;function Ka(){return Ai||(Ai=1,function(t){var e=Ua(),r=ja(),a=As(),u=Ga();function l(f){return f.call.bind(f)}var o=typeof BigInt<"u",s=typeof Symbol<"u",c=l(Object.prototype.toString),y=l(Number.prototype.valueOf),b=l(String.prototype.valueOf),T=l(Boolean.prototype.valueOf);if(o)var x=l(BigInt.prototype.valueOf);if(s)var w=l(Symbol.prototype.valueOf);function E(f,O){if(typeof f!="object")return!1;try{return O(f),!0}catch{return!1}}t.isArgumentsObject=e,t.isGeneratorFunction=r,t.isTypedArray=u;function v(f){return typeof Promise<"u"&&f instanceof Promise||f!==null&&typeof f=="object"&&typeof f.then=="function"&&typeof f.catch=="function"}t.isPromise=v;function A(f){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(f):u(f)||z(f)}t.isArrayBufferView=A;function p(f){return a(f)==="Uint8Array"}t.isUint8Array=p;function S(f){return a(f)==="Uint8ClampedArray"}t.isUint8ClampedArray=S;function k(f){return a(f)==="Uint16Array"}t.isUint16Array=k;function F(f){return a(f)==="Uint32Array"}t.isUint32Array=F;function L(f){return a(f)==="Int8Array"}t.isInt8Array=L;function X(f){return a(f)==="Int16Array"}t.isInt16Array=X;function G(f){return a(f)==="Int32Array"}t.isInt32Array=G;function Z(f){return a(f)==="Float32Array"}t.isFloat32Array=Z;function R(f){return a(f)==="Float64Array"}t.isFloat64Array=R;function se(f){return a(f)==="BigInt64Array"}t.isBigInt64Array=se;function ce(f){return a(f)==="BigUint64Array"}t.isBigUint64Array=ce;function B(f){return c(f)==="[object Map]"}B.working=typeof Map<"u"&&B(new Map);function K(f){return typeof Map>"u"?!1:B.working?B(f):f instanceof Map}t.isMap=K;function _(f){return c(f)==="[object Set]"}_.working=typeof Set<"u"&&_(new Set);function $(f){return typeof Set>"u"?!1:_.working?_(f):f instanceof Set}t.isSet=$;function le(f){return c(f)==="[object WeakMap]"}le.working=typeof WeakMap<"u"&&le(new WeakMap);function V(f){return typeof WeakMap>"u"?!1:le.working?le(f):f instanceof WeakMap}t.isWeakMap=V;function de(f){return c(f)==="[object WeakSet]"}de.working=typeof WeakSet<"u"&&de(new WeakSet);function ee(f){return de(f)}t.isWeakSet=ee;function fe(f){return c(f)==="[object ArrayBuffer]"}fe.working=typeof ArrayBuffer<"u"&&fe(new ArrayBuffer);function W(f){return typeof ArrayBuffer>"u"?!1:fe.working?fe(f):f instanceof ArrayBuffer}t.isArrayBuffer=W;function C(f){return c(f)==="[object DataView]"}C.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&C(new DataView(new ArrayBuffer(1),0,1));function z(f){return typeof DataView>"u"?!1:C.working?C(f):f instanceof DataView}t.isDataView=z;var H=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function Q(f){return c(f)==="[object SharedArrayBuffer]"}function j(f){return typeof H>"u"?!1:(typeof Q.working>"u"&&(Q.working=Q(new H)),Q.working?Q(f):f instanceof H)}t.isSharedArrayBuffer=j;function m(f){return c(f)==="[object AsyncFunction]"}t.isAsyncFunction=m;function h(f){return c(f)==="[object Map Iterator]"}t.isMapIterator=h;function M(f){return c(f)==="[object Set Iterator]"}t.isSetIterator=M;function D(f){return c(f)==="[object Generator]"}t.isGeneratorObject=D;function I(f){return c(f)==="[object WebAssembly.Module]"}t.isWebAssemblyCompiledModule=I;function N(f){return E(f,y)}t.isNumberObject=N;function Y(f){return E(f,b)}t.isStringObject=Y;function d(f){return E(f,T)}t.isBooleanObject=d;function q(f){return o&&E(f,x)}t.isBigIntObject=q;function g(f){return s&&E(f,w)}t.isSymbolObject=g;function n(f){return N(f)||Y(f)||d(f)||q(f)||g(f)}t.isBoxedPrimitive=n;function i(f){return typeof Uint8Array<"u"&&(W(f)||j(f))}t.isAnyArrayBuffer=i,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(f){Object.defineProperty(t,f,{enumerable:!1,value:function(){throw new Error(f+" is not supported in userland")}})})}(_r)),_r}var Gr,ki;function qa(){return ki||(ki=1,Gr=function(e){return e&&typeof e=="object"&&typeof e.copy=="function"&&typeof e.fill=="function"&&typeof e.readUInt8=="function"}),Gr}var Ri;function ks(){return Ri||(Ri=1,function(t){var e=Object.getOwnPropertyDescriptors||function(z){for(var H=Object.keys(z),Q={},j=0;j<H.length;j++)Q[H[j]]=Object.getOwnPropertyDescriptor(z,H[j]);return Q},r=/%[sdj%]/g;t.format=function(C){if(!L(C)){for(var z=[],H=0;H<arguments.length;H++)z.push(o(arguments[H]));return z.join(" ")}for(var H=1,Q=arguments,j=Q.length,m=String(C).replace(r,function(M){if(M==="%%")return"%";if(H>=j)return M;switch(M){case"%s":return String(Q[H++]);case"%d":return Number(Q[H++]);case"%j":try{return JSON.stringify(Q[H++])}catch{return"[Circular]"}default:return M}}),h=Q[H];H<j;h=Q[++H])S(h)||!R(h)?m+=" "+h:m+=" "+o(h);return m},t.deprecate=function(C,z){if(typeof ge<"u"&&ge.noDeprecation===!0)return C;if(typeof ge>"u")return function(){return t.deprecate(C,z).apply(this,arguments)};var H=!1;function Q(){if(!H){if(ge.throwDeprecation)throw new Error(z);ge.traceDeprecation?console.trace(z):console.error(z),H=!0}return C.apply(this,arguments)}return Q};var a={},u=/^$/;if(ge.env.NODE_DEBUG){var l=ge.env.NODE_DEBUG;l=l.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),u=new RegExp("^"+l+"$","i")}t.debuglog=function(C){if(C=C.toUpperCase(),!a[C])if(u.test(C)){var z=ge.pid;a[C]=function(){var H=t.format.apply(t,arguments);console.error("%s %d: %s",C,z,H)}}else a[C]=function(){};return a[C]};function o(C,z){var H={seen:[],stylize:c};return arguments.length>=3&&(H.depth=arguments[2]),arguments.length>=4&&(H.colors=arguments[3]),p(z)?H.showHidden=z:z&&t._extend(H,z),G(H.showHidden)&&(H.showHidden=!1),G(H.depth)&&(H.depth=2),G(H.colors)&&(H.colors=!1),G(H.customInspect)&&(H.customInspect=!0),H.colors&&(H.stylize=s),b(H,C,H.depth)}t.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function s(C,z){var H=o.styles[z];return H?"\x1B["+o.colors[H][0]+"m"+C+"\x1B["+o.colors[H][1]+"m":C}function c(C,z){return C}function y(C){var z={};return C.forEach(function(H,Q){z[H]=!0}),z}function b(C,z,H){if(C.customInspect&&z&&B(z.inspect)&&z.inspect!==t.inspect&&!(z.constructor&&z.constructor.prototype===z)){var Q=z.inspect(H,C);return L(Q)||(Q=b(C,Q,H)),Q}var j=T(C,z);if(j)return j;var m=Object.keys(z),h=y(m);if(C.showHidden&&(m=Object.getOwnPropertyNames(z)),ce(z)&&(m.indexOf("message")>=0||m.indexOf("description")>=0))return x(z);if(m.length===0){if(B(z)){var M=z.name?": "+z.name:"";return C.stylize("[Function"+M+"]","special")}if(Z(z))return C.stylize(RegExp.prototype.toString.call(z),"regexp");if(se(z))return C.stylize(Date.prototype.toString.call(z),"date");if(ce(z))return x(z)}var D="",I=!1,N=["{","}"];if(A(z)&&(I=!0,N=["[","]"]),B(z)){var Y=z.name?": "+z.name:"";D=" [Function"+Y+"]"}if(Z(z)&&(D=" "+RegExp.prototype.toString.call(z)),se(z)&&(D=" "+Date.prototype.toUTCString.call(z)),ce(z)&&(D=" "+x(z)),m.length===0&&(!I||z.length==0))return N[0]+D+N[1];if(H<0)return Z(z)?C.stylize(RegExp.prototype.toString.call(z),"regexp"):C.stylize("[Object]","special");C.seen.push(z);var d;return I?d=w(C,z,H,h,m):d=m.map(function(q){return E(C,z,H,h,q,I)}),C.seen.pop(),v(d,D,N)}function T(C,z){if(G(z))return C.stylize("undefined","undefined");if(L(z)){var H="'"+JSON.stringify(z).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return C.stylize(H,"string")}if(F(z))return C.stylize(""+z,"number");if(p(z))return C.stylize(""+z,"boolean");if(S(z))return C.stylize("null","null")}function x(C){return"["+Error.prototype.toString.call(C)+"]"}function w(C,z,H,Q,j){for(var m=[],h=0,M=z.length;h<M;++h)de(z,String(h))?m.push(E(C,z,H,Q,String(h),!0)):m.push("");return j.forEach(function(D){D.match(/^\d+$/)||m.push(E(C,z,H,Q,D,!0))}),m}function E(C,z,H,Q,j,m){var h,M,D;if(D=Object.getOwnPropertyDescriptor(z,j)||{value:z[j]},D.get?D.set?M=C.stylize("[Getter/Setter]","special"):M=C.stylize("[Getter]","special"):D.set&&(M=C.stylize("[Setter]","special")),de(Q,j)||(h="["+j+"]"),M||(C.seen.indexOf(D.value)<0?(S(H)?M=b(C,D.value,null):M=b(C,D.value,H-1),M.indexOf(`
`)>-1&&(m?M=M.split(`
`).map(function(I){return"  "+I}).join(`
`).slice(2):M=`
`+M.split(`
`).map(function(I){return"   "+I}).join(`
`))):M=C.stylize("[Circular]","special")),G(h)){if(m&&j.match(/^\d+$/))return M;h=JSON.stringify(""+j),h.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(h=h.slice(1,-1),h=C.stylize(h,"name")):(h=h.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),h=C.stylize(h,"string"))}return h+": "+M}function v(C,z,H){var Q=C.reduce(function(j,m){return m.indexOf(`
`)>=0,j+m.replace(/\u001b\[\d\d?m/g,"").length+1},0);return Q>60?H[0]+(z===""?"":z+`
 `)+" "+C.join(`,
  `)+" "+H[1]:H[0]+z+" "+C.join(", ")+" "+H[1]}t.types=Ka();function A(C){return Array.isArray(C)}t.isArray=A;function p(C){return typeof C=="boolean"}t.isBoolean=p;function S(C){return C===null}t.isNull=S;function k(C){return C==null}t.isNullOrUndefined=k;function F(C){return typeof C=="number"}t.isNumber=F;function L(C){return typeof C=="string"}t.isString=L;function X(C){return typeof C=="symbol"}t.isSymbol=X;function G(C){return C===void 0}t.isUndefined=G;function Z(C){return R(C)&&_(C)==="[object RegExp]"}t.isRegExp=Z,t.types.isRegExp=Z;function R(C){return typeof C=="object"&&C!==null}t.isObject=R;function se(C){return R(C)&&_(C)==="[object Date]"}t.isDate=se,t.types.isDate=se;function ce(C){return R(C)&&(_(C)==="[object Error]"||C instanceof Error)}t.isError=ce,t.types.isNativeError=ce;function B(C){return typeof C=="function"}t.isFunction=B;function K(C){return C===null||typeof C=="boolean"||typeof C=="number"||typeof C=="string"||typeof C=="symbol"||typeof C>"u"}t.isPrimitive=K,t.isBuffer=qa();function _(C){return Object.prototype.toString.call(C)}function $(C){return C<10?"0"+C.toString(10):C.toString(10)}var le=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function V(){var C=new Date,z=[$(C.getHours()),$(C.getMinutes()),$(C.getSeconds())].join(":");return[C.getDate(),le[C.getMonth()],z].join(" ")}t.log=function(){console.log("%s - %s",V(),t.format.apply(t,arguments))},t.inherits=ut,t._extend=function(C,z){if(!z||!R(z))return C;for(var H=Object.keys(z),Q=H.length;Q--;)C[H[Q]]=z[H[Q]];return C};function de(C,z){return Object.prototype.hasOwnProperty.call(C,z)}var ee=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;t.promisify=function(z){if(typeof z!="function")throw new TypeError('The "original" argument must be of type Function');if(ee&&z[ee]){var H=z[ee];if(typeof H!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(H,ee,{value:H,enumerable:!1,writable:!1,configurable:!0}),H}function H(){for(var Q,j,m=new Promise(function(D,I){Q=D,j=I}),h=[],M=0;M<arguments.length;M++)h.push(arguments[M]);h.push(function(D,I){D?j(D):Q(I)});try{z.apply(this,h)}catch(D){j(D)}return m}return Object.setPrototypeOf(H,Object.getPrototypeOf(z)),ee&&Object.defineProperty(H,ee,{value:H,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(H,e(z))},t.promisify.custom=ee;function fe(C,z){if(!C){var H=new Error("Promise was rejected with a falsy value");H.reason=C,C=H}return z(C)}function W(C){if(typeof C!="function")throw new TypeError('The "original" argument must be of type Function');function z(){for(var H=[],Q=0;Q<arguments.length;Q++)H.push(arguments[Q]);var j=H.pop();if(typeof j!="function")throw new TypeError("The last argument must be of type Function");var m=this,h=function(){return j.apply(m,arguments)};C.apply(this,H).then(function(M){ge.nextTick(h.bind(null,null,M))},function(M){ge.nextTick(fe.bind(null,M,h))})}return Object.setPrototypeOf(z,Object.getPrototypeOf(C)),Object.defineProperties(z,e(C)),z}t.callbackify=W}(xr)),xr}var Kr,Ii;function $a(){if(Ii)return Kr;Ii=1;function t(x,w){var E=Object.keys(x);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(x);w&&(v=v.filter(function(A){return Object.getOwnPropertyDescriptor(x,A).enumerable})),E.push.apply(E,v)}return E}function e(x){for(var w=1;w<arguments.length;w++){var E=arguments[w]!=null?arguments[w]:{};w%2?t(Object(E),!0).forEach(function(v){r(x,v,E[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(x,Object.getOwnPropertyDescriptors(E)):t(Object(E)).forEach(function(v){Object.defineProperty(x,v,Object.getOwnPropertyDescriptor(E,v))})}return x}function r(x,w,E){return w in x?Object.defineProperty(x,w,{value:E,enumerable:!0,configurable:!0,writable:!0}):x[w]=E,x}function a(x,w){if(!(x instanceof w))throw new TypeError("Cannot call a class as a function")}function u(x,w){for(var E=0;E<w.length;E++){var v=w[E];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(x,v.key,v)}}function l(x,w,E){return w&&u(x.prototype,w),x}var o=lr(),s=o.Buffer,c=ks(),y=c.inspect,b=y&&y.custom||"inspect";function T(x,w,E){s.prototype.copy.call(x,w,E)}return Kr=function(){function x(){a(this,x),this.head=null,this.tail=null,this.length=0}return l(x,[{key:"push",value:function(E){var v={data:E,next:null};this.length>0?this.tail.next=v:this.head=v,this.tail=v,++this.length}},{key:"unshift",value:function(E){var v={data:E,next:this.head};this.length===0&&(this.tail=v),this.head=v,++this.length}},{key:"shift",value:function(){if(this.length!==0){var E=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,E}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(E){if(this.length===0)return"";for(var v=this.head,A=""+v.data;v=v.next;)A+=E+v.data;return A}},{key:"concat",value:function(E){if(this.length===0)return s.alloc(0);for(var v=s.allocUnsafe(E>>>0),A=this.head,p=0;A;)T(A.data,v,p),p+=A.data.length,A=A.next;return v}},{key:"consume",value:function(E,v){var A;return E<this.head.data.length?(A=this.head.data.slice(0,E),this.head.data=this.head.data.slice(E)):E===this.head.data.length?A=this.shift():A=v?this._getString(E):this._getBuffer(E),A}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(E){var v=this.head,A=1,p=v.data;for(E-=p.length;v=v.next;){var S=v.data,k=E>S.length?S.length:E;if(k===S.length?p+=S:p+=S.slice(0,E),E-=k,E===0){k===S.length?(++A,v.next?this.head=v.next:this.head=this.tail=null):(this.head=v,v.data=S.slice(k));break}++A}return this.length-=A,p}},{key:"_getBuffer",value:function(E){var v=s.allocUnsafe(E),A=this.head,p=1;for(A.data.copy(v),E-=A.data.length;A=A.next;){var S=A.data,k=E>S.length?S.length:E;if(S.copy(v,v.length-E,0,k),E-=k,E===0){k===S.length?(++p,A.next?this.head=A.next:this.head=this.tail=null):(this.head=A,A.data=S.slice(k));break}++p}return this.length-=p,v}},{key:b,value:function(E,v){return y(this,e({},v,{depth:0,customInspect:!1}))}}]),x}(),Kr}var qr,Ci;function Rs(){if(Ci)return qr;Ci=1;function t(o,s){var c=this,y=this._readableState&&this._readableState.destroyed,b=this._writableState&&this._writableState.destroyed;return y||b?(s?s(o):o&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,ge.nextTick(u,this,o)):ge.nextTick(u,this,o)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(o||null,function(T){!s&&T?c._writableState?c._writableState.errorEmitted?ge.nextTick(r,c):(c._writableState.errorEmitted=!0,ge.nextTick(e,c,T)):ge.nextTick(e,c,T):s?(ge.nextTick(r,c),s(T)):ge.nextTick(r,c)}),this)}function e(o,s){u(o,s),r(o)}function r(o){o._writableState&&!o._writableState.emitClose||o._readableState&&!o._readableState.emitClose||o.emit("close")}function a(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function u(o,s){o.emit("error",s)}function l(o,s){var c=o._readableState,y=o._writableState;c&&c.autoDestroy||y&&y.autoDestroy?o.destroy(s):o.emit("error",s)}return qr={destroy:t,undestroy:a,errorOrDestroy:l},qr}var $r={},Ni;function St(){if(Ni)return $r;Ni=1;function t(s,c){s.prototype=Object.create(c.prototype),s.prototype.constructor=s,s.__proto__=c}var e={};function r(s,c,y){y||(y=Error);function b(x,w,E){return typeof c=="string"?c:c(x,w,E)}var T=function(x){t(w,x);function w(E,v,A){return x.call(this,b(E,v,A))||this}return w}(y);T.prototype.name=y.name,T.prototype.code=s,e[s]=T}function a(s,c){if(Array.isArray(s)){var y=s.length;return s=s.map(function(b){return String(b)}),y>2?"one of ".concat(c," ").concat(s.slice(0,y-1).join(", "),", or ")+s[y-1]:y===2?"one of ".concat(c," ").concat(s[0]," or ").concat(s[1]):"of ".concat(c," ").concat(s[0])}else return"of ".concat(c," ").concat(String(s))}function u(s,c,y){return s.substr(0,c.length)===c}function l(s,c,y){return(y===void 0||y>s.length)&&(y=s.length),s.substring(y-c.length,y)===c}function o(s,c,y){return typeof y!="number"&&(y=0),y+c.length>s.length?!1:s.indexOf(c,y)!==-1}return r("ERR_INVALID_OPT_VALUE",function(s,c){return'The value "'+c+'" is invalid for option "'+s+'"'},TypeError),r("ERR_INVALID_ARG_TYPE",function(s,c,y){var b;typeof c=="string"&&u(c,"not ")?(b="must not be",c=c.replace(/^not /,"")):b="must be";var T;if(l(s," argument"))T="The ".concat(s," ").concat(b," ").concat(a(c,"type"));else{var x=o(s,".")?"property":"argument";T='The "'.concat(s,'" ').concat(x," ").concat(b," ").concat(a(c,"type"))}return T+=". Received type ".concat(typeof y),T},TypeError),r("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),r("ERR_METHOD_NOT_IMPLEMENTED",function(s){return"The "+s+" method is not implemented"}),r("ERR_STREAM_PREMATURE_CLOSE","Premature close"),r("ERR_STREAM_DESTROYED",function(s){return"Cannot call "+s+" after a stream was destroyed"}),r("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),r("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),r("ERR_STREAM_WRITE_AFTER_END","write after end"),r("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),r("ERR_UNKNOWN_ENCODING",function(s){return"Unknown encoding: "+s},TypeError),r("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),$r.codes=e,$r}var Vr,Oi;function Is(){if(Oi)return Vr;Oi=1;var t=St().codes.ERR_INVALID_OPT_VALUE;function e(a,u,l){return a.highWaterMark!=null?a.highWaterMark:u?a[l]:null}function r(a,u,l,o){var s=e(u,o,l);if(s!=null){if(!(isFinite(s)&&Math.floor(s)===s)||s<0){var c=o?l:"highWaterMark";throw new t(c,s)}return Math.floor(s)}return a.objectMode?16:16*1024}return Vr={getHighWaterMark:r},Vr}var Xr,Fi;function Va(){if(Fi)return Xr;Fi=1,Xr=t;function t(r,a){if(e("noDeprecation"))return r;var u=!1;function l(){if(!u){if(e("throwDeprecation"))throw new Error(a);e("traceDeprecation")?console.trace(a):console.warn(a),u=!0}return r.apply(this,arguments)}return l}function e(r){try{if(!Ge.localStorage)return!1}catch{return!1}var a=Ge.localStorage[r];return a==null?!1:String(a).toLowerCase()==="true"}return Xr}var Yr,Bi;function Cs(){if(Bi)return Yr;Bi=1,Yr=Z;function t(j){var m=this;this.next=null,this.entry=null,this.finish=function(){Q(m,j)}}var e;Z.WritableState=X;var r={deprecate:Va()},a=xs(),u=lr().Buffer,l=Ge.Uint8Array||function(){};function o(j){return u.from(j)}function s(j){return u.isBuffer(j)||j instanceof l}var c=Rs(),y=Is(),b=y.getHighWaterMark,T=St().codes,x=T.ERR_INVALID_ARG_TYPE,w=T.ERR_METHOD_NOT_IMPLEMENTED,E=T.ERR_MULTIPLE_CALLBACK,v=T.ERR_STREAM_CANNOT_PIPE,A=T.ERR_STREAM_DESTROYED,p=T.ERR_STREAM_NULL_VALUES,S=T.ERR_STREAM_WRITE_AFTER_END,k=T.ERR_UNKNOWN_ENCODING,F=c.errorOrDestroy;ut(Z,a);function L(){}function X(j,m,h){e=e||yt(),j=j||{},typeof h!="boolean"&&(h=m instanceof e),this.objectMode=!!j.objectMode,h&&(this.objectMode=this.objectMode||!!j.writableObjectMode),this.highWaterMark=b(this,j,"writableHighWaterMark",h),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var M=j.decodeStrings===!1;this.decodeStrings=!M,this.defaultEncoding=j.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(D){le(m,D)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=j.emitClose!==!1,this.autoDestroy=!!j.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new t(this)}X.prototype.getBuffer=function(){for(var m=this.bufferedRequest,h=[];m;)h.push(m),m=m.next;return h},function(){try{Object.defineProperty(X.prototype,"buffer",{get:r.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var G;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(G=Function.prototype[Symbol.hasInstance],Object.defineProperty(Z,Symbol.hasInstance,{value:function(m){return G.call(this,m)?!0:this!==Z?!1:m&&m._writableState instanceof X}})):G=function(m){return m instanceof this};function Z(j){e=e||yt();var m=this instanceof e;if(!m&&!G.call(Z,this))return new Z(j);this._writableState=new X(j,this,m),this.writable=!0,j&&(typeof j.write=="function"&&(this._write=j.write),typeof j.writev=="function"&&(this._writev=j.writev),typeof j.destroy=="function"&&(this._destroy=j.destroy),typeof j.final=="function"&&(this._final=j.final)),a.call(this)}Z.prototype.pipe=function(){F(this,new v)};function R(j,m){var h=new S;F(j,h),ge.nextTick(m,h)}function se(j,m,h,M){var D;return h===null?D=new p:typeof h!="string"&&!m.objectMode&&(D=new x("chunk",["string","Buffer"],h)),D?(F(j,D),ge.nextTick(M,D),!1):!0}Z.prototype.write=function(j,m,h){var M=this._writableState,D=!1,I=!M.objectMode&&s(j);return I&&!u.isBuffer(j)&&(j=o(j)),typeof m=="function"&&(h=m,m=null),I?m="buffer":m||(m=M.defaultEncoding),typeof h!="function"&&(h=L),M.ending?R(this,h):(I||se(this,M,j,h))&&(M.pendingcb++,D=B(this,M,I,j,m,h)),D},Z.prototype.cork=function(){this._writableState.corked++},Z.prototype.uncork=function(){var j=this._writableState;j.corked&&(j.corked--,!j.writing&&!j.corked&&!j.bufferProcessing&&j.bufferedRequest&&ee(this,j))},Z.prototype.setDefaultEncoding=function(m){if(typeof m=="string"&&(m=m.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((m+"").toLowerCase())>-1))throw new k(m);return this._writableState.defaultEncoding=m,this},Object.defineProperty(Z.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function ce(j,m,h){return!j.objectMode&&j.decodeStrings!==!1&&typeof m=="string"&&(m=u.from(m,h)),m}Object.defineProperty(Z.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function B(j,m,h,M,D,I){if(!h){var N=ce(m,M,D);M!==N&&(h=!0,D="buffer",M=N)}var Y=m.objectMode?1:M.length;m.length+=Y;var d=m.length<m.highWaterMark;if(d||(m.needDrain=!0),m.writing||m.corked){var q=m.lastBufferedRequest;m.lastBufferedRequest={chunk:M,encoding:D,isBuf:h,callback:I,next:null},q?q.next=m.lastBufferedRequest:m.bufferedRequest=m.lastBufferedRequest,m.bufferedRequestCount+=1}else K(j,m,!1,Y,M,D,I);return d}function K(j,m,h,M,D,I,N){m.writelen=M,m.writecb=N,m.writing=!0,m.sync=!0,m.destroyed?m.onwrite(new A("write")):h?j._writev(D,m.onwrite):j._write(D,I,m.onwrite),m.sync=!1}function _(j,m,h,M,D){--m.pendingcb,h?(ge.nextTick(D,M),ge.nextTick(z,j,m),j._writableState.errorEmitted=!0,F(j,M)):(D(M),j._writableState.errorEmitted=!0,F(j,M),z(j,m))}function $(j){j.writing=!1,j.writecb=null,j.length-=j.writelen,j.writelen=0}function le(j,m){var h=j._writableState,M=h.sync,D=h.writecb;if(typeof D!="function")throw new E;if($(h),m)_(j,h,M,m,D);else{var I=fe(h)||j.destroyed;!I&&!h.corked&&!h.bufferProcessing&&h.bufferedRequest&&ee(j,h),M?ge.nextTick(V,j,h,I,D):V(j,h,I,D)}}function V(j,m,h,M){h||de(j,m),m.pendingcb--,M(),z(j,m)}function de(j,m){m.length===0&&m.needDrain&&(m.needDrain=!1,j.emit("drain"))}function ee(j,m){m.bufferProcessing=!0;var h=m.bufferedRequest;if(j._writev&&h&&h.next){var M=m.bufferedRequestCount,D=new Array(M),I=m.corkedRequestsFree;I.entry=h;for(var N=0,Y=!0;h;)D[N]=h,h.isBuf||(Y=!1),h=h.next,N+=1;D.allBuffers=Y,K(j,m,!0,m.length,D,"",I.finish),m.pendingcb++,m.lastBufferedRequest=null,I.next?(m.corkedRequestsFree=I.next,I.next=null):m.corkedRequestsFree=new t(m),m.bufferedRequestCount=0}else{for(;h;){var d=h.chunk,q=h.encoding,g=h.callback,n=m.objectMode?1:d.length;if(K(j,m,!1,n,d,q,g),h=h.next,m.bufferedRequestCount--,m.writing)break}h===null&&(m.lastBufferedRequest=null)}m.bufferedRequest=h,m.bufferProcessing=!1}Z.prototype._write=function(j,m,h){h(new w("_write()"))},Z.prototype._writev=null,Z.prototype.end=function(j,m,h){var M=this._writableState;return typeof j=="function"?(h=j,j=null,m=null):typeof m=="function"&&(h=m,m=null),j!=null&&this.write(j,m),M.corked&&(M.corked=1,this.uncork()),M.ending||H(this,M,h),this},Object.defineProperty(Z.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function fe(j){return j.ending&&j.length===0&&j.bufferedRequest===null&&!j.finished&&!j.writing}function W(j,m){j._final(function(h){m.pendingcb--,h&&F(j,h),m.prefinished=!0,j.emit("prefinish"),z(j,m)})}function C(j,m){!m.prefinished&&!m.finalCalled&&(typeof j._final=="function"&&!m.destroyed?(m.pendingcb++,m.finalCalled=!0,ge.nextTick(W,j,m)):(m.prefinished=!0,j.emit("prefinish")))}function z(j,m){var h=fe(m);if(h&&(C(j,m),m.pendingcb===0&&(m.finished=!0,j.emit("finish"),m.autoDestroy))){var M=j._readableState;(!M||M.autoDestroy&&M.endEmitted)&&j.destroy()}return h}function H(j,m,h){m.ending=!0,z(j,m),h&&(m.finished?ge.nextTick(h):j.once("finish",h)),m.ended=!0,j.writable=!1}function Q(j,m,h){var M=j.entry;for(j.entry=null;M;){var D=M.callback;m.pendingcb--,D(h),M=M.next}m.corkedRequestsFree.next=j}return Object.defineProperty(Z.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(m){this._writableState&&(this._writableState.destroyed=m)}}),Z.prototype.destroy=c.destroy,Z.prototype._undestroy=c.undestroy,Z.prototype._destroy=function(j,m){m(j)},Yr}var Zr,Di;function yt(){if(Di)return Zr;Di=1;var t=Object.keys||function(y){var b=[];for(var T in y)b.push(T);return b};Zr=o;var e=Ns(),r=Cs();ut(o,e);for(var a=t(r.prototype),u=0;u<a.length;u++){var l=a[u];o.prototype[l]||(o.prototype[l]=r.prototype[l])}function o(y){if(!(this instanceof o))return new o(y);e.call(this,y),r.call(this,y),this.allowHalfOpen=!0,y&&(y.readable===!1&&(this.readable=!1),y.writable===!1&&(this.writable=!1),y.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",s)))}Object.defineProperty(o.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(o.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(o.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function s(){this._writableState.ended||ge.nextTick(c,this)}function c(y){y.end()}return Object.defineProperty(o.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(b){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=b,this._writableState.destroyed=b)}}),Zr}var Jr={},Ht={exports:{}},Pi;function Xa(){return Pi||(Pi=1,function(t,e){var r=lr(),a=r.Buffer;function u(o,s){for(var c in o)s[c]=o[c]}a.from&&a.alloc&&a.allocUnsafe&&a.allocUnsafeSlow?t.exports=r:(u(r,e),e.Buffer=l);function l(o,s,c){return a(o,s,c)}u(a,l),l.from=function(o,s,c){if(typeof o=="number")throw new TypeError("Argument must not be a number");return a(o,s,c)},l.alloc=function(o,s,c){if(typeof o!="number")throw new TypeError("Argument must be a number");var y=a(o);return s!==void 0?typeof c=="string"?y.fill(s,c):y.fill(s):y.fill(0),y},l.allocUnsafe=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return a(o)},l.allocUnsafeSlow=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(o)}}(Ht,Ht.exports)),Ht.exports}var Li;function yn(){if(Li)return Jr;Li=1;var t=Xa().Buffer,e=t.isEncoding||function(p){switch(p=""+p,p&&p.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function r(p){if(!p)return"utf8";for(var S;;)switch(p){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return p;default:if(S)return;p=(""+p).toLowerCase(),S=!0}}function a(p){var S=r(p);if(typeof S!="string"&&(t.isEncoding===e||!e(p)))throw new Error("Unknown encoding: "+p);return S||p}Jr.StringDecoder=u;function u(p){this.encoding=a(p);var S;switch(this.encoding){case"utf16le":this.text=T,this.end=x,S=4;break;case"utf8":this.fillLast=c,S=4;break;case"base64":this.text=w,this.end=E,S=3;break;default:this.write=v,this.end=A;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=t.allocUnsafe(S)}u.prototype.write=function(p){if(p.length===0)return"";var S,k;if(this.lastNeed){if(S=this.fillLast(p),S===void 0)return"";k=this.lastNeed,this.lastNeed=0}else k=0;return k<p.length?S?S+this.text(p,k):this.text(p,k):S||""},u.prototype.end=b,u.prototype.text=y,u.prototype.fillLast=function(p){if(this.lastNeed<=p.length)return p.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);p.copy(this.lastChar,this.lastTotal-this.lastNeed,0,p.length),this.lastNeed-=p.length};function l(p){return p<=127?0:p>>5===6?2:p>>4===14?3:p>>3===30?4:p>>6===2?-1:-2}function o(p,S,k){var F=S.length-1;if(F<k)return 0;var L=l(S[F]);return L>=0?(L>0&&(p.lastNeed=L-1),L):--F<k||L===-2?0:(L=l(S[F]),L>=0?(L>0&&(p.lastNeed=L-2),L):--F<k||L===-2?0:(L=l(S[F]),L>=0?(L>0&&(L===2?L=0:p.lastNeed=L-3),L):0))}function s(p,S,k){if((S[0]&192)!==128)return p.lastNeed=0,"ï¿½";if(p.lastNeed>1&&S.length>1){if((S[1]&192)!==128)return p.lastNeed=1,"ï¿½";if(p.lastNeed>2&&S.length>2&&(S[2]&192)!==128)return p.lastNeed=2,"ï¿½"}}function c(p){var S=this.lastTotal-this.lastNeed,k=s(this,p);if(k!==void 0)return k;if(this.lastNeed<=p.length)return p.copy(this.lastChar,S,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);p.copy(this.lastChar,S,0,p.length),this.lastNeed-=p.length}function y(p,S){var k=o(this,p,S);if(!this.lastNeed)return p.toString("utf8",S);this.lastTotal=k;var F=p.length-(k-this.lastNeed);return p.copy(this.lastChar,0,F),p.toString("utf8",S,F)}function b(p){var S=p&&p.length?this.write(p):"";return this.lastNeed?S+"ï¿½":S}function T(p,S){if((p.length-S)%2===0){var k=p.toString("utf16le",S);if(k){var F=k.charCodeAt(k.length-1);if(F>=55296&&F<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=p[p.length-2],this.lastChar[1]=p[p.length-1],k.slice(0,-1)}return k}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=p[p.length-1],p.toString("utf16le",S,p.length-1)}function x(p){var S=p&&p.length?this.write(p):"";if(this.lastNeed){var k=this.lastTotal-this.lastNeed;return S+this.lastChar.toString("utf16le",0,k)}return S}function w(p,S){var k=(p.length-S)%3;return k===0?p.toString("base64",S):(this.lastNeed=3-k,this.lastTotal=3,k===1?this.lastChar[0]=p[p.length-1]:(this.lastChar[0]=p[p.length-2],this.lastChar[1]=p[p.length-1]),p.toString("base64",S,p.length-k))}function E(p){var S=p&&p.length?this.write(p):"";return this.lastNeed?S+this.lastChar.toString("base64",0,3-this.lastNeed):S}function v(p){return p.toString(this.encoding)}function A(p){return p&&p.length?this.write(p):""}return Jr}var Qr,Mi;function Rn(){if(Mi)return Qr;Mi=1;var t=St().codes.ERR_STREAM_PREMATURE_CLOSE;function e(l){var o=!1;return function(){if(!o){o=!0;for(var s=arguments.length,c=new Array(s),y=0;y<s;y++)c[y]=arguments[y];l.apply(this,c)}}}function r(){}function a(l){return l.setHeader&&typeof l.abort=="function"}function u(l,o,s){if(typeof o=="function")return u(l,null,o);o||(o={}),s=e(s||r);var c=o.readable||o.readable!==!1&&l.readable,y=o.writable||o.writable!==!1&&l.writable,b=function(){l.writable||x()},T=l._writableState&&l._writableState.finished,x=function(){y=!1,T=!0,c||s.call(l)},w=l._readableState&&l._readableState.endEmitted,E=function(){c=!1,w=!0,y||s.call(l)},v=function(k){s.call(l,k)},A=function(){var k;if(c&&!w)return(!l._readableState||!l._readableState.ended)&&(k=new t),s.call(l,k);if(y&&!T)return(!l._writableState||!l._writableState.ended)&&(k=new t),s.call(l,k)},p=function(){l.req.on("finish",x)};return a(l)?(l.on("complete",x),l.on("abort",A),l.req?p():l.on("request",p)):y&&!l._writableState&&(l.on("end",b),l.on("close",b)),l.on("end",E),l.on("finish",x),o.error!==!1&&l.on("error",v),l.on("close",A),function(){l.removeListener("complete",x),l.removeListener("abort",A),l.removeListener("request",p),l.req&&l.req.removeListener("finish",x),l.removeListener("end",b),l.removeListener("close",b),l.removeListener("finish",x),l.removeListener("end",E),l.removeListener("error",v),l.removeListener("close",A)}}return Qr=u,Qr}var en,Ui;function Ya(){if(Ui)return en;Ui=1;var t;function e(p,S,k){return S in p?Object.defineProperty(p,S,{value:k,enumerable:!0,configurable:!0,writable:!0}):p[S]=k,p}var r=Rn(),a=Symbol("lastResolve"),u=Symbol("lastReject"),l=Symbol("error"),o=Symbol("ended"),s=Symbol("lastPromise"),c=Symbol("handlePromise"),y=Symbol("stream");function b(p,S){return{value:p,done:S}}function T(p){var S=p[a];if(S!==null){var k=p[y].read();k!==null&&(p[s]=null,p[a]=null,p[u]=null,S(b(k,!1)))}}function x(p){ge.nextTick(T,p)}function w(p,S){return function(k,F){p.then(function(){if(S[o]){k(b(void 0,!0));return}S[c](k,F)},F)}}var E=Object.getPrototypeOf(function(){}),v=Object.setPrototypeOf((t={get stream(){return this[y]},next:function(){var S=this,k=this[l];if(k!==null)return Promise.reject(k);if(this[o])return Promise.resolve(b(void 0,!0));if(this[y].destroyed)return new Promise(function(G,Z){ge.nextTick(function(){S[l]?Z(S[l]):G(b(void 0,!0))})});var F=this[s],L;if(F)L=new Promise(w(F,this));else{var X=this[y].read();if(X!==null)return Promise.resolve(b(X,!1));L=new Promise(this[c])}return this[s]=L,L}},e(t,Symbol.asyncIterator,function(){return this}),e(t,"return",function(){var S=this;return new Promise(function(k,F){S[y].destroy(null,function(L){if(L){F(L);return}k(b(void 0,!0))})})}),t),E),A=function(S){var k,F=Object.create(v,(k={},e(k,y,{value:S,writable:!0}),e(k,a,{value:null,writable:!0}),e(k,u,{value:null,writable:!0}),e(k,l,{value:null,writable:!0}),e(k,o,{value:S._readableState.endEmitted,writable:!0}),e(k,c,{value:function(X,G){var Z=F[y].read();Z?(F[s]=null,F[a]=null,F[u]=null,X(b(Z,!1))):(F[a]=X,F[u]=G)},writable:!0}),k));return F[s]=null,r(S,function(L){if(L&&L.code!=="ERR_STREAM_PREMATURE_CLOSE"){var X=F[u];X!==null&&(F[s]=null,F[a]=null,F[u]=null,X(L)),F[l]=L;return}var G=F[a];G!==null&&(F[s]=null,F[a]=null,F[u]=null,G(b(void 0,!0))),F[o]=!0}),S.on("readable",x.bind(null,F)),F};return en=A,en}var tn,ji;function Za(){return ji||(ji=1,tn=function(){throw new Error("Readable.from is not available in the browser")}),tn}var rn,zi;function Ns(){if(zi)return rn;zi=1,rn=R;var t;R.ReadableState=Z,Sn.EventEmitter;var e=function(N,Y){return N.listeners(Y).length},r=xs(),a=lr().Buffer,u=Ge.Uint8Array||function(){};function l(I){return a.from(I)}function o(I){return a.isBuffer(I)||I instanceof u}var s=ks(),c;s&&s.debuglog?c=s.debuglog("stream"):c=function(){};var y=$a(),b=Rs(),T=Is(),x=T.getHighWaterMark,w=St().codes,E=w.ERR_INVALID_ARG_TYPE,v=w.ERR_STREAM_PUSH_AFTER_EOF,A=w.ERR_METHOD_NOT_IMPLEMENTED,p=w.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,S,k,F;ut(R,r);var L=b.errorOrDestroy,X=["error","close","destroy","pause","resume"];function G(I,N,Y){if(typeof I.prependListener=="function")return I.prependListener(N,Y);!I._events||!I._events[N]?I.on(N,Y):Array.isArray(I._events[N])?I._events[N].unshift(Y):I._events[N]=[Y,I._events[N]]}function Z(I,N,Y){t=t||yt(),I=I||{},typeof Y!="boolean"&&(Y=N instanceof t),this.objectMode=!!I.objectMode,Y&&(this.objectMode=this.objectMode||!!I.readableObjectMode),this.highWaterMark=x(this,I,"readableHighWaterMark",Y),this.buffer=new y,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=I.emitClose!==!1,this.autoDestroy=!!I.autoDestroy,this.destroyed=!1,this.defaultEncoding=I.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,I.encoding&&(S||(S=yn().StringDecoder),this.decoder=new S(I.encoding),this.encoding=I.encoding)}function R(I){if(t=t||yt(),!(this instanceof R))return new R(I);var N=this instanceof t;this._readableState=new Z(I,this,N),this.readable=!0,I&&(typeof I.read=="function"&&(this._read=I.read),typeof I.destroy=="function"&&(this._destroy=I.destroy)),r.call(this)}Object.defineProperty(R.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(N){this._readableState&&(this._readableState.destroyed=N)}}),R.prototype.destroy=b.destroy,R.prototype._undestroy=b.undestroy,R.prototype._destroy=function(I,N){N(I)},R.prototype.push=function(I,N){var Y=this._readableState,d;return Y.objectMode?d=!0:typeof I=="string"&&(N=N||Y.defaultEncoding,N!==Y.encoding&&(I=a.from(I,N),N=""),d=!0),se(this,I,N,!1,d)},R.prototype.unshift=function(I){return se(this,I,null,!0,!1)};function se(I,N,Y,d,q){c("readableAddChunk",N);var g=I._readableState;if(N===null)g.reading=!1,le(I,g);else{var n;if(q||(n=B(g,N)),n)L(I,n);else if(g.objectMode||N&&N.length>0)if(typeof N!="string"&&!g.objectMode&&Object.getPrototypeOf(N)!==a.prototype&&(N=l(N)),d)g.endEmitted?L(I,new p):ce(I,g,N,!0);else if(g.ended)L(I,new v);else{if(g.destroyed)return!1;g.reading=!1,g.decoder&&!Y?(N=g.decoder.write(N),g.objectMode||N.length!==0?ce(I,g,N,!1):ee(I,g)):ce(I,g,N,!1)}else d||(g.reading=!1,ee(I,g))}return!g.ended&&(g.length<g.highWaterMark||g.length===0)}function ce(I,N,Y,d){N.flowing&&N.length===0&&!N.sync?(N.awaitDrain=0,I.emit("data",Y)):(N.length+=N.objectMode?1:Y.length,d?N.buffer.unshift(Y):N.buffer.push(Y),N.needReadable&&V(I)),ee(I,N)}function B(I,N){var Y;return!o(N)&&typeof N!="string"&&N!==void 0&&!I.objectMode&&(Y=new E("chunk",["string","Buffer","Uint8Array"],N)),Y}R.prototype.isPaused=function(){return this._readableState.flowing===!1},R.prototype.setEncoding=function(I){S||(S=yn().StringDecoder);var N=new S(I);this._readableState.decoder=N,this._readableState.encoding=this._readableState.decoder.encoding;for(var Y=this._readableState.buffer.head,d="";Y!==null;)d+=N.write(Y.data),Y=Y.next;return this._readableState.buffer.clear(),d!==""&&this._readableState.buffer.push(d),this._readableState.length=d.length,this};var K=1073741824;function _(I){return I>=K?I=K:(I--,I|=I>>>1,I|=I>>>2,I|=I>>>4,I|=I>>>8,I|=I>>>16,I++),I}function $(I,N){return I<=0||N.length===0&&N.ended?0:N.objectMode?1:I!==I?N.flowing&&N.length?N.buffer.head.data.length:N.length:(I>N.highWaterMark&&(N.highWaterMark=_(I)),I<=N.length?I:N.ended?N.length:(N.needReadable=!0,0))}R.prototype.read=function(I){c("read",I),I=parseInt(I,10);var N=this._readableState,Y=I;if(I!==0&&(N.emittedReadable=!1),I===0&&N.needReadable&&((N.highWaterMark!==0?N.length>=N.highWaterMark:N.length>0)||N.ended))return c("read: emitReadable",N.length,N.ended),N.length===0&&N.ended?h(this):V(this),null;if(I=$(I,N),I===0&&N.ended)return N.length===0&&h(this),null;var d=N.needReadable;c("need readable",d),(N.length===0||N.length-I<N.highWaterMark)&&(d=!0,c("length less than watermark",d)),N.ended||N.reading?(d=!1,c("reading or ended",d)):d&&(c("do read"),N.reading=!0,N.sync=!0,N.length===0&&(N.needReadable=!0),this._read(N.highWaterMark),N.sync=!1,N.reading||(I=$(Y,N)));var q;return I>0?q=m(I,N):q=null,q===null?(N.needReadable=N.length<=N.highWaterMark,I=0):(N.length-=I,N.awaitDrain=0),N.length===0&&(N.ended||(N.needReadable=!0),Y!==I&&N.ended&&h(this)),q!==null&&this.emit("data",q),q};function le(I,N){if(c("onEofChunk"),!N.ended){if(N.decoder){var Y=N.decoder.end();Y&&Y.length&&(N.buffer.push(Y),N.length+=N.objectMode?1:Y.length)}N.ended=!0,N.sync?V(I):(N.needReadable=!1,N.emittedReadable||(N.emittedReadable=!0,de(I)))}}function V(I){var N=I._readableState;c("emitReadable",N.needReadable,N.emittedReadable),N.needReadable=!1,N.emittedReadable||(c("emitReadable",N.flowing),N.emittedReadable=!0,ge.nextTick(de,I))}function de(I){var N=I._readableState;c("emitReadable_",N.destroyed,N.length,N.ended),!N.destroyed&&(N.length||N.ended)&&(I.emit("readable"),N.emittedReadable=!1),N.needReadable=!N.flowing&&!N.ended&&N.length<=N.highWaterMark,j(I)}function ee(I,N){N.readingMore||(N.readingMore=!0,ge.nextTick(fe,I,N))}function fe(I,N){for(;!N.reading&&!N.ended&&(N.length<N.highWaterMark||N.flowing&&N.length===0);){var Y=N.length;if(c("maybeReadMore read 0"),I.read(0),Y===N.length)break}N.readingMore=!1}R.prototype._read=function(I){L(this,new A("_read()"))},R.prototype.pipe=function(I,N){var Y=this,d=this._readableState;switch(d.pipesCount){case 0:d.pipes=I;break;case 1:d.pipes=[d.pipes,I];break;default:d.pipes.push(I);break}d.pipesCount+=1,c("pipe count=%d opts=%j",d.pipesCount,N);var q=(!N||N.end!==!1)&&I!==ge.stdout&&I!==ge.stderr,g=q?i:ue;d.endEmitted?ge.nextTick(g):Y.once("end",g),I.on("unpipe",n);function n(he,me){c("onunpipe"),he===Y&&me&&me.hasUnpiped===!1&&(me.hasUnpiped=!0,U())}function i(){c("onend"),I.end()}var f=W(Y);I.on("drain",f);var O=!1;function U(){c("cleanup"),I.removeListener("close",oe),I.removeListener("finish",ie),I.removeListener("drain",f),I.removeListener("error",te),I.removeListener("unpipe",n),Y.removeListener("end",i),Y.removeListener("end",ue),Y.removeListener("data",P),O=!0,d.awaitDrain&&(!I._writableState||I._writableState.needDrain)&&f()}Y.on("data",P);function P(he){c("ondata");var me=I.write(he);c("dest.write",me),me===!1&&((d.pipesCount===1&&d.pipes===I||d.pipesCount>1&&D(d.pipes,I)!==-1)&&!O&&(c("false write response, pause",d.awaitDrain),d.awaitDrain++),Y.pause())}function te(he){c("onerror",he),ue(),I.removeListener("error",te),e(I,"error")===0&&L(I,he)}G(I,"error",te);function oe(){I.removeListener("finish",ie),ue()}I.once("close",oe);function ie(){c("onfinish"),I.removeListener("close",oe),ue()}I.once("finish",ie);function ue(){c("unpipe"),Y.unpipe(I)}return I.emit("pipe",Y),d.flowing||(c("pipe resume"),Y.resume()),I};function W(I){return function(){var Y=I._readableState;c("pipeOnDrain",Y.awaitDrain),Y.awaitDrain&&Y.awaitDrain--,Y.awaitDrain===0&&e(I,"data")&&(Y.flowing=!0,j(I))}}R.prototype.unpipe=function(I){var N=this._readableState,Y={hasUnpiped:!1};if(N.pipesCount===0)return this;if(N.pipesCount===1)return I&&I!==N.pipes?this:(I||(I=N.pipes),N.pipes=null,N.pipesCount=0,N.flowing=!1,I&&I.emit("unpipe",this,Y),this);if(!I){var d=N.pipes,q=N.pipesCount;N.pipes=null,N.pipesCount=0,N.flowing=!1;for(var g=0;g<q;g++)d[g].emit("unpipe",this,{hasUnpiped:!1});return this}var n=D(N.pipes,I);return n===-1?this:(N.pipes.splice(n,1),N.pipesCount-=1,N.pipesCount===1&&(N.pipes=N.pipes[0]),I.emit("unpipe",this,Y),this)},R.prototype.on=function(I,N){var Y=r.prototype.on.call(this,I,N),d=this._readableState;return I==="data"?(d.readableListening=this.listenerCount("readable")>0,d.flowing!==!1&&this.resume()):I==="readable"&&!d.endEmitted&&!d.readableListening&&(d.readableListening=d.needReadable=!0,d.flowing=!1,d.emittedReadable=!1,c("on readable",d.length,d.reading),d.length?V(this):d.reading||ge.nextTick(z,this)),Y},R.prototype.addListener=R.prototype.on,R.prototype.removeListener=function(I,N){var Y=r.prototype.removeListener.call(this,I,N);return I==="readable"&&ge.nextTick(C,this),Y},R.prototype.removeAllListeners=function(I){var N=r.prototype.removeAllListeners.apply(this,arguments);return(I==="readable"||I===void 0)&&ge.nextTick(C,this),N};function C(I){var N=I._readableState;N.readableListening=I.listenerCount("readable")>0,N.resumeScheduled&&!N.paused?N.flowing=!0:I.listenerCount("data")>0&&I.resume()}function z(I){c("readable nexttick read 0"),I.read(0)}R.prototype.resume=function(){var I=this._readableState;return I.flowing||(c("resume"),I.flowing=!I.readableListening,H(this,I)),I.paused=!1,this};function H(I,N){N.resumeScheduled||(N.resumeScheduled=!0,ge.nextTick(Q,I,N))}function Q(I,N){c("resume",N.reading),N.reading||I.read(0),N.resumeScheduled=!1,I.emit("resume"),j(I),N.flowing&&!N.reading&&I.read(0)}R.prototype.pause=function(){return c("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(c("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function j(I){var N=I._readableState;for(c("flow",N.flowing);N.flowing&&I.read()!==null;);}R.prototype.wrap=function(I){var N=this,Y=this._readableState,d=!1;I.on("end",function(){if(c("wrapped end"),Y.decoder&&!Y.ended){var n=Y.decoder.end();n&&n.length&&N.push(n)}N.push(null)}),I.on("data",function(n){if(c("wrapped data"),Y.decoder&&(n=Y.decoder.write(n)),!(Y.objectMode&&n==null)&&!(!Y.objectMode&&(!n||!n.length))){var i=N.push(n);i||(d=!0,I.pause())}});for(var q in I)this[q]===void 0&&typeof I[q]=="function"&&(this[q]=function(i){return function(){return I[i].apply(I,arguments)}}(q));for(var g=0;g<X.length;g++)I.on(X[g],this.emit.bind(this,X[g]));return this._read=function(n){c("wrapped _read",n),d&&(d=!1,I.resume())},this},typeof Symbol=="function"&&(R.prototype[Symbol.asyncIterator]=function(){return k===void 0&&(k=Ya()),k(this)}),Object.defineProperty(R.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(R.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(R.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(N){this._readableState&&(this._readableState.flowing=N)}}),R._fromList=m,Object.defineProperty(R.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function m(I,N){if(N.length===0)return null;var Y;return N.objectMode?Y=N.buffer.shift():!I||I>=N.length?(N.decoder?Y=N.buffer.join(""):N.buffer.length===1?Y=N.buffer.first():Y=N.buffer.concat(N.length),N.buffer.clear()):Y=N.buffer.consume(I,N.decoder),Y}function h(I){var N=I._readableState;c("endReadable",N.endEmitted),N.endEmitted||(N.ended=!0,ge.nextTick(M,N,I))}function M(I,N){if(c("endReadableNT",I.endEmitted,I.length),!I.endEmitted&&I.length===0&&(I.endEmitted=!0,N.readable=!1,N.emit("end"),I.autoDestroy)){var Y=N._writableState;(!Y||Y.autoDestroy&&Y.finished)&&N.destroy()}}typeof Symbol=="function"&&(R.from=function(I,N){return F===void 0&&(F=Za()),F(R,I,N)});function D(I,N){for(var Y=0,d=I.length;Y<d;Y++)if(I[Y]===N)return Y;return-1}return rn}var nn,Wi;function Os(){if(Wi)return nn;Wi=1,nn=s;var t=St().codes,e=t.ERR_METHOD_NOT_IMPLEMENTED,r=t.ERR_MULTIPLE_CALLBACK,a=t.ERR_TRANSFORM_ALREADY_TRANSFORMING,u=t.ERR_TRANSFORM_WITH_LENGTH_0,l=yt();ut(s,l);function o(b,T){var x=this._transformState;x.transforming=!1;var w=x.writecb;if(w===null)return this.emit("error",new r);x.writechunk=null,x.writecb=null,T!=null&&this.push(T),w(b);var E=this._readableState;E.reading=!1,(E.needReadable||E.length<E.highWaterMark)&&this._read(E.highWaterMark)}function s(b){if(!(this instanceof s))return new s(b);l.call(this,b),this._transformState={afterTransform:o.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,b&&(typeof b.transform=="function"&&(this._transform=b.transform),typeof b.flush=="function"&&(this._flush=b.flush)),this.on("prefinish",c)}function c(){var b=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(T,x){y(b,T,x)}):y(this,null,null)}s.prototype.push=function(b,T){return this._transformState.needTransform=!1,l.prototype.push.call(this,b,T)},s.prototype._transform=function(b,T,x){x(new e("_transform()"))},s.prototype._write=function(b,T,x){var w=this._transformState;if(w.writecb=x,w.writechunk=b,w.writeencoding=T,!w.transforming){var E=this._readableState;(w.needTransform||E.needReadable||E.length<E.highWaterMark)&&this._read(E.highWaterMark)}},s.prototype._read=function(b){var T=this._transformState;T.writechunk!==null&&!T.transforming?(T.transforming=!0,this._transform(T.writechunk,T.writeencoding,T.afterTransform)):T.needTransform=!0},s.prototype._destroy=function(b,T){l.prototype._destroy.call(this,b,function(x){T(x)})};function y(b,T,x){if(T)return b.emit("error",T);if(x!=null&&b.push(x),b._writableState.length)throw new u;if(b._transformState.transforming)throw new a;return b.push(null)}return nn}var sn,Hi;function Ja(){if(Hi)return sn;Hi=1,sn=e;var t=Os();ut(e,t);function e(r){if(!(this instanceof e))return new e(r);t.call(this,r)}return e.prototype._transform=function(r,a,u){u(null,r)},sn}var an,Gi;function Qa(){if(Gi)return an;Gi=1;var t;function e(x){var w=!1;return function(){w||(w=!0,x.apply(void 0,arguments))}}var r=St().codes,a=r.ERR_MISSING_ARGS,u=r.ERR_STREAM_DESTROYED;function l(x){if(x)throw x}function o(x){return x.setHeader&&typeof x.abort=="function"}function s(x,w,E,v){v=e(v);var A=!1;x.on("close",function(){A=!0}),t===void 0&&(t=Rn()),t(x,{readable:w,writable:E},function(S){if(S)return v(S);A=!0,v()});var p=!1;return function(S){if(!A&&!p){if(p=!0,o(x))return x.abort();if(typeof x.destroy=="function")return x.destroy();v(S||new u("pipe"))}}}function c(x){x()}function y(x,w){return x.pipe(w)}function b(x){return!x.length||typeof x[x.length-1]!="function"?l:x.pop()}function T(){for(var x=arguments.length,w=new Array(x),E=0;E<x;E++)w[E]=arguments[E];var v=b(w);if(Array.isArray(w[0])&&(w=w[0]),w.length<2)throw new a("streams");var A,p=w.map(function(S,k){var F=k<w.length-1,L=k>0;return s(S,F,L,function(X){A||(A=X),X&&p.forEach(c),!F&&(p.forEach(c),v(A))})});return w.reduce(y)}return an=T,an}var In=Me,Cn=Sn.EventEmitter,eo=ut;eo(Me,Cn);Me.Readable=Ns();Me.Writable=Cs();Me.Duplex=yt();Me.Transform=Os();Me.PassThrough=Ja();Me.finished=Rn();Me.pipeline=Qa();Me.Stream=Me;function Me(){Cn.call(this)}Me.prototype.pipe=function(t,e){var r=this;function a(b){t.writable&&t.write(b)===!1&&r.pause&&r.pause()}r.on("data",a);function u(){r.readable&&r.resume&&r.resume()}t.on("drain",u),!t._isStdio&&(!e||e.end!==!1)&&(r.on("end",o),r.on("close",s));var l=!1;function o(){l||(l=!0,t.end())}function s(){l||(l=!0,typeof t.destroy=="function"&&t.destroy())}function c(b){if(y(),Cn.listenerCount(this,"error")===0)throw b}r.on("error",c),t.on("error",c);function y(){r.removeListener("data",a),t.removeListener("drain",u),r.removeListener("end",o),r.removeListener("close",s),r.removeListener("error",c),t.removeListener("error",c),r.removeListener("end",y),r.removeListener("close",y),t.removeListener("close",y)}return r.on("end",y),r.on("close",y),t.on("close",y),t.emit("pipe",r),t};(function(t){(function(e){e.parser=function(m,h){return new a(m,h)},e.SAXParser=a,e.SAXStream=b,e.createStream=y,e.MAX_BUFFER_LENGTH=64*1024;var r=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function a(m,h){if(!(this instanceof a))return new a(m,h);var M=this;l(M),M.q=M.c="",M.bufferCheckPosition=e.MAX_BUFFER_LENGTH,M.opt=h||{},M.opt.lowercase=M.opt.lowercase||M.opt.lowercasetags,M.looseCase=M.opt.lowercase?"toLowerCase":"toUpperCase",M.tags=[],M.closed=M.closedRoot=M.sawRoot=!1,M.tag=M.error=null,M.strict=!!m,M.noscript=!!(m||M.opt.noscript),M.state=R.BEGIN,M.strictEntities=M.opt.strictEntities,M.ENTITIES=M.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),M.attribList=[],M.opt.xmlns&&(M.ns=Object.create(v)),M.trackPosition=M.opt.position!==!1,M.trackPosition&&(M.position=M.line=M.column=0),ce(M,"onready")}Object.create||(Object.create=function(m){function h(){}h.prototype=m;var M=new h;return M}),Object.keys||(Object.keys=function(m){var h=[];for(var M in m)m.hasOwnProperty(M)&&h.push(M);return h});function u(m){for(var h=Math.max(e.MAX_BUFFER_LENGTH,10),M=0,D=0,I=r.length;D<I;D++){var N=m[r[D]].length;if(N>h)switch(r[D]){case"textNode":K(m);break;case"cdata":B(m,"oncdata",m.cdata),m.cdata="";break;case"script":B(m,"onscript",m.script),m.script="";break;default:$(m,"Max buffer length exceeded: "+r[D])}M=Math.max(M,N)}var Y=e.MAX_BUFFER_LENGTH-M;m.bufferCheckPosition=Y+m.position}function l(m){for(var h=0,M=r.length;h<M;h++)m[r[h]]=""}function o(m){K(m),m.cdata!==""&&(B(m,"oncdata",m.cdata),m.cdata=""),m.script!==""&&(B(m,"onscript",m.script),m.script="")}a.prototype={end:function(){le(this)},write:j,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){o(this)}};var s;try{s=In.Stream}catch{s=function(){}}var c=e.EVENTS.filter(function(m){return m!=="error"&&m!=="end"});function y(m,h){return new b(m,h)}function b(m,h){if(!(this instanceof b))return new b(m,h);s.apply(this),this._parser=new a(m,h),this.writable=!0,this.readable=!0;var M=this;this._parser.onend=function(){M.emit("end")},this._parser.onerror=function(D){M.emit("error",D),M._parser.error=null},this._decoder=null,c.forEach(function(D){Object.defineProperty(M,"on"+D,{get:function(){return M._parser["on"+D]},set:function(I){if(!I)return M.removeAllListeners(D),M._parser["on"+D]=I,I;M.on(D,I)},enumerable:!0,configurable:!1})})}b.prototype=Object.create(s.prototype,{constructor:{value:b}}),b.prototype.write=function(m){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(m)){if(!this._decoder){var h=yn().StringDecoder;this._decoder=new h("utf8")}m=this._decoder.write(m)}return this._parser.write(m.toString()),this.emit("data",m),!0},b.prototype.end=function(m){return m&&m.length&&this.write(m),this._parser.end(),!0},b.prototype.on=function(m,h){var M=this;return!M._parser["on"+m]&&c.indexOf(m)!==-1&&(M._parser["on"+m]=function(){var D=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);D.splice(0,0,m),M.emit.apply(M,D)}),s.prototype.on.call(M,m,h)};var T="[CDATA[",x="DOCTYPE",w="http://www.w3.org/XML/1998/namespace",E="http://www.w3.org/2000/xmlns/",v={xml:w,xmlns:E},A=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,p=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,S=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,k=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function F(m){return m===" "||m===`
`||m==="\r"||m==="	"}function L(m){return m==='"'||m==="'"}function X(m){return m===">"||F(m)}function G(m,h){return m.test(h)}function Z(m,h){return!G(m,h)}var R=0;e.STATE={BEGIN:R++,BEGIN_WHITESPACE:R++,TEXT:R++,TEXT_ENTITY:R++,OPEN_WAKA:R++,SGML_DECL:R++,SGML_DECL_QUOTED:R++,DOCTYPE:R++,DOCTYPE_QUOTED:R++,DOCTYPE_DTD:R++,DOCTYPE_DTD_QUOTED:R++,COMMENT_STARTING:R++,COMMENT:R++,COMMENT_ENDING:R++,COMMENT_ENDED:R++,CDATA:R++,CDATA_ENDING:R++,CDATA_ENDING_2:R++,PROC_INST:R++,PROC_INST_BODY:R++,PROC_INST_ENDING:R++,OPEN_TAG:R++,OPEN_TAG_SLASH:R++,ATTRIB:R++,ATTRIB_NAME:R++,ATTRIB_NAME_SAW_WHITE:R++,ATTRIB_VALUE:R++,ATTRIB_VALUE_QUOTED:R++,ATTRIB_VALUE_CLOSED:R++,ATTRIB_VALUE_UNQUOTED:R++,ATTRIB_VALUE_ENTITY_Q:R++,ATTRIB_VALUE_ENTITY_U:R++,CLOSE_TAG:R++,CLOSE_TAG_SAW_WHITE:R++,SCRIPT:R++,SCRIPT_ENDING:R++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach(function(m){var h=e.ENTITIES[m],M=typeof h=="number"?String.fromCharCode(h):h;e.ENTITIES[m]=M});for(var se in e.STATE)e.STATE[e.STATE[se]]=se;R=e.STATE;function ce(m,h,M){m[h]&&m[h](M)}function B(m,h,M){m.textNode&&K(m),ce(m,h,M)}function K(m){m.textNode=_(m.opt,m.textNode),m.textNode&&ce(m,"ontext",m.textNode),m.textNode=""}function _(m,h){return m.trim&&(h=h.trim()),m.normalize&&(h=h.replace(/\s+/g," ")),h}function $(m,h){return K(m),m.trackPosition&&(h+=`
Line: `+m.line+`
Column: `+m.column+`
Char: `+m.c),h=new Error(h),m.error=h,ce(m,"onerror",h),m}function le(m){return m.sawRoot&&!m.closedRoot&&V(m,"Unclosed root tag"),m.state!==R.BEGIN&&m.state!==R.BEGIN_WHITESPACE&&m.state!==R.TEXT&&$(m,"Unexpected end"),K(m),m.c="",m.closed=!0,ce(m,"onend"),a.call(m,m.strict,m.opt),m}function V(m,h){if(typeof m!="object"||!(m instanceof a))throw new Error("bad call to strictFail");m.strict&&$(m,h)}function de(m){m.strict||(m.tagName=m.tagName[m.looseCase]());var h=m.tags[m.tags.length-1]||m,M=m.tag={name:m.tagName,attributes:{}};m.opt.xmlns&&(M.ns=h.ns),m.attribList.length=0,B(m,"onopentagstart",M)}function ee(m,h){var M=m.indexOf(":"),D=M<0?["",m]:m.split(":"),I=D[0],N=D[1];return h&&m==="xmlns"&&(I="xmlns",N=""),{prefix:I,local:N}}function fe(m){if(m.strict||(m.attribName=m.attribName[m.looseCase]()),m.attribList.indexOf(m.attribName)!==-1||m.tag.attributes.hasOwnProperty(m.attribName)){m.attribName=m.attribValue="";return}if(m.opt.xmlns){var h=ee(m.attribName,!0),M=h.prefix,D=h.local;if(M==="xmlns")if(D==="xml"&&m.attribValue!==w)V(m,"xml: prefix must be bound to "+w+`
Actual: `+m.attribValue);else if(D==="xmlns"&&m.attribValue!==E)V(m,"xmlns: prefix must be bound to "+E+`
Actual: `+m.attribValue);else{var I=m.tag,N=m.tags[m.tags.length-1]||m;I.ns===N.ns&&(I.ns=Object.create(N.ns)),I.ns[D]=m.attribValue}m.attribList.push([m.attribName,m.attribValue])}else m.tag.attributes[m.attribName]=m.attribValue,B(m,"onattribute",{name:m.attribName,value:m.attribValue});m.attribName=m.attribValue=""}function W(m,h){if(m.opt.xmlns){var M=m.tag,D=ee(m.tagName);M.prefix=D.prefix,M.local=D.local,M.uri=M.ns[D.prefix]||"",M.prefix&&!M.uri&&(V(m,"Unbound namespace prefix: "+JSON.stringify(m.tagName)),M.uri=D.prefix);var I=m.tags[m.tags.length-1]||m;M.ns&&I.ns!==M.ns&&Object.keys(M.ns).forEach(function(P){B(m,"onopennamespace",{prefix:P,uri:M.ns[P]})});for(var N=0,Y=m.attribList.length;N<Y;N++){var d=m.attribList[N],q=d[0],g=d[1],n=ee(q,!0),i=n.prefix,f=n.local,O=i===""?"":M.ns[i]||"",U={name:q,value:g,prefix:i,local:f,uri:O};i&&i!=="xmlns"&&!O&&(V(m,"Unbound namespace prefix: "+JSON.stringify(i)),U.uri=i),m.tag.attributes[q]=U,B(m,"onattribute",U)}m.attribList.length=0}m.tag.isSelfClosing=!!h,m.sawRoot=!0,m.tags.push(m.tag),B(m,"onopentag",m.tag),h||(!m.noscript&&m.tagName.toLowerCase()==="script"?m.state=R.SCRIPT:m.state=R.TEXT,m.tag=null,m.tagName=""),m.attribName=m.attribValue="",m.attribList.length=0}function C(m){if(!m.tagName){V(m,"Weird empty close tag."),m.textNode+="</>",m.state=R.TEXT;return}if(m.script){if(m.tagName!=="script"){m.script+="</"+m.tagName+">",m.tagName="",m.state=R.SCRIPT;return}B(m,"onscript",m.script),m.script=""}var h=m.tags.length,M=m.tagName;m.strict||(M=M[m.looseCase]());for(var D=M;h--;){var I=m.tags[h];if(I.name!==D)V(m,"Unexpected close tag");else break}if(h<0){V(m,"Unmatched closing tag: "+m.tagName),m.textNode+="</"+m.tagName+">",m.state=R.TEXT;return}m.tagName=M;for(var N=m.tags.length;N-- >h;){var Y=m.tag=m.tags.pop();m.tagName=m.tag.name,B(m,"onclosetag",m.tagName);var d={};for(var q in Y.ns)d[q]=Y.ns[q];var g=m.tags[m.tags.length-1]||m;m.opt.xmlns&&Y.ns!==g.ns&&Object.keys(Y.ns).forEach(function(n){var i=Y.ns[n];B(m,"onclosenamespace",{prefix:n,uri:i})})}h===0&&(m.closedRoot=!0),m.tagName=m.attribValue=m.attribName="",m.attribList.length=0,m.state=R.TEXT}function z(m){var h=m.entity,M=h.toLowerCase(),D,I="";return m.ENTITIES[h]?m.ENTITIES[h]:m.ENTITIES[M]?m.ENTITIES[M]:(h=M,h.charAt(0)==="#"&&(h.charAt(1)==="x"?(h=h.slice(2),D=parseInt(h,16),I=D.toString(16)):(h=h.slice(1),D=parseInt(h,10),I=D.toString(10))),h=h.replace(/^0+/,""),isNaN(D)||I.toLowerCase()!==h?(V(m,"Invalid character entity"),"&"+m.entity+";"):String.fromCodePoint(D))}function H(m,h){h==="<"?(m.state=R.OPEN_WAKA,m.startTagPosition=m.position):F(h)||(V(m,"Non-whitespace before first tag."),m.textNode=h,m.state=R.TEXT)}function Q(m,h){var M="";return h<m.length&&(M=m.charAt(h)),M}function j(m){var h=this;if(this.error)throw this.error;if(h.closed)return $(h,"Cannot write after close. Assign an onready handler.");if(m===null)return le(h);typeof m=="object"&&(m=m.toString());for(var M=0,D="";D=Q(m,M++),h.c=D,!!D;)switch(h.trackPosition&&(h.position++,D===`
`?(h.line++,h.column=0):h.column++),h.state){case R.BEGIN:if(h.state=R.BEGIN_WHITESPACE,D==="\uFEFF")continue;H(h,D);continue;case R.BEGIN_WHITESPACE:H(h,D);continue;case R.TEXT:if(h.sawRoot&&!h.closedRoot){for(var I=M-1;D&&D!=="<"&&D!=="&";)D=Q(m,M++),D&&h.trackPosition&&(h.position++,D===`
`?(h.line++,h.column=0):h.column++);h.textNode+=m.substring(I,M-1)}D==="<"&&!(h.sawRoot&&h.closedRoot&&!h.strict)?(h.state=R.OPEN_WAKA,h.startTagPosition=h.position):(!F(D)&&(!h.sawRoot||h.closedRoot)&&V(h,"Text data outside of root node."),D==="&"?h.state=R.TEXT_ENTITY:h.textNode+=D);continue;case R.SCRIPT:D==="<"?h.state=R.SCRIPT_ENDING:h.script+=D;continue;case R.SCRIPT_ENDING:D==="/"?h.state=R.CLOSE_TAG:(h.script+="<"+D,h.state=R.SCRIPT);continue;case R.OPEN_WAKA:if(D==="!")h.state=R.SGML_DECL,h.sgmlDecl="";else if(!F(D))if(G(A,D))h.state=R.OPEN_TAG,h.tagName=D;else if(D==="/")h.state=R.CLOSE_TAG,h.tagName="";else if(D==="?")h.state=R.PROC_INST,h.procInstName=h.procInstBody="";else{if(V(h,"Unencoded <"),h.startTagPosition+1<h.position){var N=h.position-h.startTagPosition;D=new Array(N).join(" ")+D}h.textNode+="<"+D,h.state=R.TEXT}continue;case R.SGML_DECL:(h.sgmlDecl+D).toUpperCase()===T?(B(h,"onopencdata"),h.state=R.CDATA,h.sgmlDecl="",h.cdata=""):h.sgmlDecl+D==="--"?(h.state=R.COMMENT,h.comment="",h.sgmlDecl=""):(h.sgmlDecl+D).toUpperCase()===x?(h.state=R.DOCTYPE,(h.doctype||h.sawRoot)&&V(h,"Inappropriately located doctype declaration"),h.doctype="",h.sgmlDecl=""):D===">"?(B(h,"onsgmldeclaration",h.sgmlDecl),h.sgmlDecl="",h.state=R.TEXT):(L(D)&&(h.state=R.SGML_DECL_QUOTED),h.sgmlDecl+=D);continue;case R.SGML_DECL_QUOTED:D===h.q&&(h.state=R.SGML_DECL,h.q=""),h.sgmlDecl+=D;continue;case R.DOCTYPE:D===">"?(h.state=R.TEXT,B(h,"ondoctype",h.doctype),h.doctype=!0):(h.doctype+=D,D==="["?h.state=R.DOCTYPE_DTD:L(D)&&(h.state=R.DOCTYPE_QUOTED,h.q=D));continue;case R.DOCTYPE_QUOTED:h.doctype+=D,D===h.q&&(h.q="",h.state=R.DOCTYPE);continue;case R.DOCTYPE_DTD:h.doctype+=D,D==="]"?h.state=R.DOCTYPE:L(D)&&(h.state=R.DOCTYPE_DTD_QUOTED,h.q=D);continue;case R.DOCTYPE_DTD_QUOTED:h.doctype+=D,D===h.q&&(h.state=R.DOCTYPE_DTD,h.q="");continue;case R.COMMENT:D==="-"?h.state=R.COMMENT_ENDING:h.comment+=D;continue;case R.COMMENT_ENDING:D==="-"?(h.state=R.COMMENT_ENDED,h.comment=_(h.opt,h.comment),h.comment&&B(h,"oncomment",h.comment),h.comment=""):(h.comment+="-"+D,h.state=R.COMMENT);continue;case R.COMMENT_ENDED:D!==">"?(V(h,"Malformed comment"),h.comment+="--"+D,h.state=R.COMMENT):h.state=R.TEXT;continue;case R.CDATA:D==="]"?h.state=R.CDATA_ENDING:h.cdata+=D;continue;case R.CDATA_ENDING:D==="]"?h.state=R.CDATA_ENDING_2:(h.cdata+="]"+D,h.state=R.CDATA);continue;case R.CDATA_ENDING_2:D===">"?(h.cdata&&B(h,"oncdata",h.cdata),B(h,"onclosecdata"),h.cdata="",h.state=R.TEXT):D==="]"?h.cdata+="]":(h.cdata+="]]"+D,h.state=R.CDATA);continue;case R.PROC_INST:D==="?"?h.state=R.PROC_INST_ENDING:F(D)?h.state=R.PROC_INST_BODY:h.procInstName+=D;continue;case R.PROC_INST_BODY:if(!h.procInstBody&&F(D))continue;D==="?"?h.state=R.PROC_INST_ENDING:h.procInstBody+=D;continue;case R.PROC_INST_ENDING:D===">"?(B(h,"onprocessinginstruction",{name:h.procInstName,body:h.procInstBody}),h.procInstName=h.procInstBody="",h.state=R.TEXT):(h.procInstBody+="?"+D,h.state=R.PROC_INST_BODY);continue;case R.OPEN_TAG:G(p,D)?h.tagName+=D:(de(h),D===">"?W(h):D==="/"?h.state=R.OPEN_TAG_SLASH:(F(D)||V(h,"Invalid character in tag name"),h.state=R.ATTRIB));continue;case R.OPEN_TAG_SLASH:D===">"?(W(h,!0),C(h)):(V(h,"Forward-slash in opening tag not followed by >"),h.state=R.ATTRIB);continue;case R.ATTRIB:if(F(D))continue;D===">"?W(h):D==="/"?h.state=R.OPEN_TAG_SLASH:G(A,D)?(h.attribName=D,h.attribValue="",h.state=R.ATTRIB_NAME):V(h,"Invalid attribute name");continue;case R.ATTRIB_NAME:D==="="?h.state=R.ATTRIB_VALUE:D===">"?(V(h,"Attribute without value"),h.attribValue=h.attribName,fe(h),W(h)):F(D)?h.state=R.ATTRIB_NAME_SAW_WHITE:G(p,D)?h.attribName+=D:V(h,"Invalid attribute name");continue;case R.ATTRIB_NAME_SAW_WHITE:if(D==="=")h.state=R.ATTRIB_VALUE;else{if(F(D))continue;V(h,"Attribute without value"),h.tag.attributes[h.attribName]="",h.attribValue="",B(h,"onattribute",{name:h.attribName,value:""}),h.attribName="",D===">"?W(h):G(A,D)?(h.attribName=D,h.state=R.ATTRIB_NAME):(V(h,"Invalid attribute name"),h.state=R.ATTRIB)}continue;case R.ATTRIB_VALUE:if(F(D))continue;L(D)?(h.q=D,h.state=R.ATTRIB_VALUE_QUOTED):(V(h,"Unquoted attribute value"),h.state=R.ATTRIB_VALUE_UNQUOTED,h.attribValue=D);continue;case R.ATTRIB_VALUE_QUOTED:if(D!==h.q){D==="&"?h.state=R.ATTRIB_VALUE_ENTITY_Q:h.attribValue+=D;continue}fe(h),h.q="",h.state=R.ATTRIB_VALUE_CLOSED;continue;case R.ATTRIB_VALUE_CLOSED:F(D)?h.state=R.ATTRIB:D===">"?W(h):D==="/"?h.state=R.OPEN_TAG_SLASH:G(A,D)?(V(h,"No whitespace between attributes"),h.attribName=D,h.attribValue="",h.state=R.ATTRIB_NAME):V(h,"Invalid attribute name");continue;case R.ATTRIB_VALUE_UNQUOTED:if(!X(D)){D==="&"?h.state=R.ATTRIB_VALUE_ENTITY_U:h.attribValue+=D;continue}fe(h),D===">"?W(h):h.state=R.ATTRIB;continue;case R.CLOSE_TAG:if(h.tagName)D===">"?C(h):G(p,D)?h.tagName+=D:h.script?(h.script+="</"+h.tagName,h.tagName="",h.state=R.SCRIPT):(F(D)||V(h,"Invalid tagname in closing tag"),h.state=R.CLOSE_TAG_SAW_WHITE);else{if(F(D))continue;Z(A,D)?h.script?(h.script+="</"+D,h.state=R.SCRIPT):V(h,"Invalid tagname in closing tag."):h.tagName=D}continue;case R.CLOSE_TAG_SAW_WHITE:if(F(D))continue;D===">"?C(h):V(h,"Invalid characters in closing tag");continue;case R.TEXT_ENTITY:case R.ATTRIB_VALUE_ENTITY_Q:case R.ATTRIB_VALUE_ENTITY_U:var Y,d;switch(h.state){case R.TEXT_ENTITY:Y=R.TEXT,d="textNode";break;case R.ATTRIB_VALUE_ENTITY_Q:Y=R.ATTRIB_VALUE_QUOTED,d="attribValue";break;case R.ATTRIB_VALUE_ENTITY_U:Y=R.ATTRIB_VALUE_UNQUOTED,d="attribValue";break}D===";"?(h[d]+=z(h),h.entity="",h.state=Y):G(h.entity.length?k:S,D)?h.entity+=D:(V(h,"Invalid character in entity name"),h[d]+="&"+h.entity+D,h.entity="",h.state=Y);continue;default:throw new Error(h,"Unknown state: "+h.state)}return h.position>=h.bufferCheckPosition&&u(h),h}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||function(){var m=String.fromCharCode,h=Math.floor,M=function(){var D=16384,I=[],N,Y,d=-1,q=arguments.length;if(!q)return"";for(var g="";++d<q;){var n=Number(arguments[d]);if(!isFinite(n)||n<0||n>1114111||h(n)!==n)throw RangeError("Invalid code point: "+n);n<=65535?I.push(n):(n-=65536,N=(n>>10)+55296,Y=n%1024+56320,I.push(N,Y)),(d+1===q||I.length>D)&&(g+=m.apply(null,I),I.length=0)}return g};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:M,configurable:!0,writable:!0}):String.fromCodePoint=M}()})(t)})(ls);var Nn={isArray:function(t){return Array.isArray?Array.isArray(t):Object.prototype.toString.call(t)==="[object Array]"}},to=Nn.isArray,On={copyOptions:function(t){var e,r={};for(e in t)t.hasOwnProperty(e)&&(r[e]=t[e]);return r},ensureFlagExists:function(t,e){(!(t in e)||typeof e[t]!="boolean")&&(e[t]=!1)},ensureSpacesExists:function(t){(!("spaces"in t)||typeof t.spaces!="number"&&typeof t.spaces!="string")&&(t.spaces=0)},ensureAlwaysArrayExists:function(t){(!("alwaysArray"in t)||typeof t.alwaysArray!="boolean"&&!to(t.alwaysArray))&&(t.alwaysArray=!1)},ensureKeyExists:function(t,e){(!(t+"Key"in e)||typeof e[t+"Key"]!="string")&&(e[t+"Key"]=e.compact?"_"+t:t)},checkFnExists:function(t,e){return t+"Fn"in e}},ro=ls,be=On,mt=Nn.isArray,J,we;function no(t){return J=be.copyOptions(t),be.ensureFlagExists("ignoreDeclaration",J),be.ensureFlagExists("ignoreInstruction",J),be.ensureFlagExists("ignoreAttributes",J),be.ensureFlagExists("ignoreText",J),be.ensureFlagExists("ignoreComment",J),be.ensureFlagExists("ignoreCdata",J),be.ensureFlagExists("ignoreDoctype",J),be.ensureFlagExists("compact",J),be.ensureFlagExists("alwaysChildren",J),be.ensureFlagExists("addParent",J),be.ensureFlagExists("trim",J),be.ensureFlagExists("nativeType",J),be.ensureFlagExists("nativeTypeAttributes",J),be.ensureFlagExists("sanitize",J),be.ensureFlagExists("instructionHasAttributes",J),be.ensureFlagExists("captureSpacesBetweenElements",J),be.ensureAlwaysArrayExists(J),be.ensureKeyExists("declaration",J),be.ensureKeyExists("instruction",J),be.ensureKeyExists("attributes",J),be.ensureKeyExists("text",J),be.ensureKeyExists("comment",J),be.ensureKeyExists("cdata",J),be.ensureKeyExists("doctype",J),be.ensureKeyExists("type",J),be.ensureKeyExists("name",J),be.ensureKeyExists("elements",J),be.ensureKeyExists("parent",J),J}function Fs(t){var e=Number(t);if(!isNaN(e))return e;var r=t.toLowerCase();return r==="true"?!0:r==="false"?!1:t}function Pt(t,e){var r;if(J.compact){if(!we[J[t+"Key"]]&&(mt(J.alwaysArray)?J.alwaysArray.indexOf(J[t+"Key"])!==-1:J.alwaysArray)&&(we[J[t+"Key"]]=[]),we[J[t+"Key"]]&&!mt(we[J[t+"Key"]])&&(we[J[t+"Key"]]=[we[J[t+"Key"]]]),t+"Fn"in J&&typeof e=="string"&&(e=J[t+"Fn"](e,we)),t==="instruction"&&("instructionFn"in J||"instructionNameFn"in J)){for(r in e)if(e.hasOwnProperty(r))if("instructionFn"in J)e[r]=J.instructionFn(e[r],r,we);else{var a=e[r];delete e[r],e[J.instructionNameFn(r,a,we)]=a}}mt(we[J[t+"Key"]])?we[J[t+"Key"]].push(e):we[J[t+"Key"]]=e}else{we[J.elementsKey]||(we[J.elementsKey]=[]);var u={};if(u[J.typeKey]=t,t==="instruction"){for(r in e)if(e.hasOwnProperty(r))break;u[J.nameKey]="instructionNameFn"in J?J.instructionNameFn(r,e,we):r,J.instructionHasAttributes?(u[J.attributesKey]=e[r][J.attributesKey],"instructionFn"in J&&(u[J.attributesKey]=J.instructionFn(u[J.attributesKey],r,we))):("instructionFn"in J&&(e[r]=J.instructionFn(e[r],r,we)),u[J.instructionKey]=e[r])}else t+"Fn"in J&&(e=J[t+"Fn"](e,we)),u[J[t+"Key"]]=e;J.addParent&&(u[J.parentKey]=we),we[J.elementsKey].push(u)}}function Bs(t){if("attributesFn"in J&&t&&(t=J.attributesFn(t,we)),(J.trim||"attributeValueFn"in J||"attributeNameFn"in J||J.nativeTypeAttributes)&&t){var e;for(e in t)if(t.hasOwnProperty(e)&&(J.trim&&(t[e]=t[e].trim()),J.nativeTypeAttributes&&(t[e]=Fs(t[e])),"attributeValueFn"in J&&(t[e]=J.attributeValueFn(t[e],e,we)),"attributeNameFn"in J)){var r=t[e];delete t[e],t[J.attributeNameFn(e,t[e],we)]=r}}return t}function io(t){var e={};if(t.body&&(t.name.toLowerCase()==="xml"||J.instructionHasAttributes)){for(var r=/([\w:-]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|(\w+))\s*/g,a;(a=r.exec(t.body))!==null;)e[a[1]]=a[2]||a[3]||a[4];e=Bs(e)}if(t.name.toLowerCase()==="xml"){if(J.ignoreDeclaration)return;we[J.declarationKey]={},Object.keys(e).length&&(we[J.declarationKey][J.attributesKey]=e),J.addParent&&(we[J.declarationKey][J.parentKey]=we)}else{if(J.ignoreInstruction)return;J.trim&&(t.body=t.body.trim());var u={};J.instructionHasAttributes&&Object.keys(e).length?(u[t.name]={},u[t.name][J.attributesKey]=e):u[t.name]=t.body,Pt("instruction",u)}}function so(t,e){var r;if(typeof t=="object"&&(e=t.attributes,t=t.name),e=Bs(e),"elementNameFn"in J&&(t=J.elementNameFn(t,we)),J.compact){if(r={},!J.ignoreAttributes&&e&&Object.keys(e).length){r[J.attributesKey]={};var a;for(a in e)e.hasOwnProperty(a)&&(r[J.attributesKey][a]=e[a])}!(t in we)&&(mt(J.alwaysArray)?J.alwaysArray.indexOf(t)!==-1:J.alwaysArray)&&(we[t]=[]),we[t]&&!mt(we[t])&&(we[t]=[we[t]]),mt(we[t])?we[t].push(r):we[t]=r}else we[J.elementsKey]||(we[J.elementsKey]=[]),r={},r[J.typeKey]="element",r[J.nameKey]=t,!J.ignoreAttributes&&e&&Object.keys(e).length&&(r[J.attributesKey]=e),J.alwaysChildren&&(r[J.elementsKey]=[]),we[J.elementsKey].push(r);r[J.parentKey]=we,we=r}function ao(t){J.ignoreText||!t.trim()&&!J.captureSpacesBetweenElements||(J.trim&&(t=t.trim()),J.nativeType&&(t=Fs(t)),J.sanitize&&(t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),Pt("text",t))}function oo(t){J.ignoreComment||(J.trim&&(t=t.trim()),Pt("comment",t))}function lo(t){var e=we[J.parentKey];J.addParent||delete we[J.parentKey],we=e}function uo(t){J.ignoreCdata||(J.trim&&(t=t.trim()),Pt("cdata",t))}function co(t){J.ignoreDoctype||(t=t.replace(/^ /,""),J.trim&&(t=t.trim()),Pt("doctype",t))}function fo(t){t.note=t}var Ds=function(t,e){var r=ro.parser(!0,{}),a={};if(we=a,J=no(e),r.opt={strictEntities:!0},r.onopentag=so,r.ontext=ao,r.oncomment=oo,r.onclosetag=lo,r.onerror=fo,r.oncdata=uo,r.ondoctype=co,r.onprocessinginstruction=io,r.write(t).close(),a[J.elementsKey]){var u=a[J.elementsKey];delete a[J.elementsKey],a[J.elementsKey]=u,delete a.text}return a},Ki=On,ho=Ds;function po(t){var e=Ki.copyOptions(t);return Ki.ensureSpacesExists(e),e}var mo=function(t,e){var r,a,u,l;return r=po(e),a=ho(t,r),l="compact"in r&&r.compact?"_parent":"parent","addParent"in r&&r.addParent?u=JSON.stringify(a,function(o,s){return o===l?"_":s},r.spaces):u=JSON.stringify(a,null,r.spaces),u.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")},Se=On,wo=Nn.isArray,Oe,Fe;function go(t){var e=Se.copyOptions(t);return Se.ensureFlagExists("ignoreDeclaration",e),Se.ensureFlagExists("ignoreInstruction",e),Se.ensureFlagExists("ignoreAttributes",e),Se.ensureFlagExists("ignoreText",e),Se.ensureFlagExists("ignoreComment",e),Se.ensureFlagExists("ignoreCdata",e),Se.ensureFlagExists("ignoreDoctype",e),Se.ensureFlagExists("compact",e),Se.ensureFlagExists("indentText",e),Se.ensureFlagExists("indentCdata",e),Se.ensureFlagExists("indentAttributes",e),Se.ensureFlagExists("indentInstruction",e),Se.ensureFlagExists("fullTagEmptyElement",e),Se.ensureFlagExists("noQuotesForNativeAttributes",e),Se.ensureSpacesExists(e),typeof e.spaces=="number"&&(e.spaces=Array(e.spaces+1).join(" ")),Se.ensureKeyExists("declaration",e),Se.ensureKeyExists("instruction",e),Se.ensureKeyExists("attributes",e),Se.ensureKeyExists("text",e),Se.ensureKeyExists("comment",e),Se.ensureKeyExists("cdata",e),Se.ensureKeyExists("doctype",e),Se.ensureKeyExists("type",e),Se.ensureKeyExists("name",e),Se.ensureKeyExists("elements",e),e}function He(t,e,r){return(!r&&t.spaces?`
`:"")+Array(e+1).join(t.spaces)}function ur(t,e,r){if(e.ignoreAttributes)return"";"attributesFn"in e&&(t=e.attributesFn(t,Fe,Oe));var a,u,l,o,s=[];for(a in t)t.hasOwnProperty(a)&&t[a]!==null&&t[a]!==void 0&&(o=e.noQuotesForNativeAttributes&&typeof t[a]!="string"?"":'"',u=""+t[a],u=u.replace(/"/g,"&quot;"),l="attributeNameFn"in e?e.attributeNameFn(a,u,Fe,Oe):a,s.push(e.spaces&&e.indentAttributes?He(e,r+1,!1):" "),s.push(l+"="+o+("attributeValueFn"in e?e.attributeValueFn(u,a,Fe,Oe):u)+o));return t&&Object.keys(t).length&&e.spaces&&e.indentAttributes&&s.push(He(e,r,!1)),s.join("")}function Ps(t,e,r){return Oe=t,Fe="xml",e.ignoreDeclaration?"":"<?xml"+ur(t[e.attributesKey],e,r)+"?>"}function Ls(t,e,r){if(e.ignoreInstruction)return"";var a;for(a in t)if(t.hasOwnProperty(a))break;var u="instructionNameFn"in e?e.instructionNameFn(a,t[a],Fe,Oe):a;if(typeof t[a]=="object")return Oe=t,Fe=u,"<?"+u+ur(t[a][e.attributesKey],e,r)+"?>";var l=t[a]?t[a]:"";return"instructionFn"in e&&(l=e.instructionFn(l,a,Fe,Oe)),"<?"+u+(l?" "+l:"")+"?>"}function Ms(t,e){return e.ignoreComment?"":"<!--"+("commentFn"in e?e.commentFn(t,Fe,Oe):t)+"-->"}function Us(t,e){return e.ignoreCdata?"":"<![CDATA["+("cdataFn"in e?e.cdataFn(t,Fe,Oe):t.replace("]]>","]]]]><![CDATA[>"))+"]]>"}function js(t,e){return e.ignoreDoctype?"":"<!DOCTYPE "+("doctypeFn"in e?e.doctypeFn(t,Fe,Oe):t)+">"}function Fn(t,e){return e.ignoreText?"":(t=""+t,t=t.replace(/&amp;/g,"&"),t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"textFn"in e?e.textFn(t,Fe,Oe):t)}function yo(t,e){var r;if(t.elements&&t.elements.length)for(r=0;r<t.elements.length;++r)switch(t.elements[r][e.typeKey]){case"text":if(e.indentText)return!0;break;case"cdata":if(e.indentCdata)return!0;break;case"instruction":if(e.indentInstruction)return!0;break;case"doctype":case"comment":case"element":return!0;default:return!0}return!1}function vo(t,e,r){Oe=t,Fe=t.name;var a=[],u="elementNameFn"in e?e.elementNameFn(t.name,t):t.name;a.push("<"+u),t[e.attributesKey]&&a.push(ur(t[e.attributesKey],e,r));var l=t[e.elementsKey]&&t[e.elementsKey].length||t[e.attributesKey]&&t[e.attributesKey]["xml:space"]==="preserve";return l||("fullTagEmptyElementFn"in e?l=e.fullTagEmptyElementFn(t.name,t):l=e.fullTagEmptyElement),l?(a.push(">"),t[e.elementsKey]&&t[e.elementsKey].length&&(a.push(zs(t[e.elementsKey],e,r+1)),Oe=t,Fe=t.name),a.push(e.spaces&&yo(t,e)?`
`+Array(r+1).join(e.spaces):""),a.push("</"+u+">")):a.push("/>"),a.join("")}function zs(t,e,r,a){return t.reduce(function(u,l){var o=He(e,r,a&&!u);switch(l.type){case"element":return u+o+vo(l,e,r);case"comment":return u+o+Ms(l[e.commentKey],e);case"doctype":return u+o+js(l[e.doctypeKey],e);case"cdata":return u+(e.indentCdata?o:"")+Us(l[e.cdataKey],e);case"text":return u+(e.indentText?o:"")+Fn(l[e.textKey],e);case"instruction":var s={};return s[l[e.nameKey]]=l[e.attributesKey]?l:l[e.instructionKey],u+(e.indentInstruction?o:"")+Ls(s,e,r)}},"")}function Ws(t,e,r){var a;for(a in t)if(t.hasOwnProperty(a))switch(a){case e.parentKey:case e.attributesKey:break;case e.textKey:if(e.indentText||r)return!0;break;case e.cdataKey:if(e.indentCdata||r)return!0;break;case e.instructionKey:if(e.indentInstruction||r)return!0;break;case e.doctypeKey:case e.commentKey:return!0;default:return!0}return!1}function bo(t,e,r,a,u){Oe=t,Fe=e;var l="elementNameFn"in r?r.elementNameFn(e,t):e;if(typeof t>"u"||t===null||t==="")return"fullTagEmptyElementFn"in r&&r.fullTagEmptyElementFn(e,t)||r.fullTagEmptyElement?"<"+l+"></"+l+">":"<"+l+"/>";var o=[];if(e){if(o.push("<"+l),typeof t!="object")return o.push(">"+Fn(t,r)+"</"+l+">"),o.join("");t[r.attributesKey]&&o.push(ur(t[r.attributesKey],r,a));var s=Ws(t,r,!0)||t[r.attributesKey]&&t[r.attributesKey]["xml:space"]==="preserve";if(s||("fullTagEmptyElementFn"in r?s=r.fullTagEmptyElementFn(e,t):s=r.fullTagEmptyElement),s)o.push(">");else return o.push("/>"),o.join("")}return o.push(Hs(t,r,a+1,!1)),Oe=t,Fe=e,e&&o.push((u?He(r,a,!1):"")+"</"+l+">"),o.join("")}function Hs(t,e,r,a){var u,l,o,s=[];for(l in t)if(t.hasOwnProperty(l))for(o=wo(t[l])?t[l]:[t[l]],u=0;u<o.length;++u){switch(l){case e.declarationKey:s.push(Ps(o[u],e,r));break;case e.instructionKey:s.push((e.indentInstruction?He(e,r,a):"")+Ls(o[u],e,r));break;case e.attributesKey:case e.parentKey:break;case e.textKey:s.push((e.indentText?He(e,r,a):"")+Fn(o[u],e));break;case e.cdataKey:s.push((e.indentCdata?He(e,r,a):"")+Us(o[u],e));break;case e.doctypeKey:s.push(He(e,r,a)+js(o[u],e));break;case e.commentKey:s.push(He(e,r,a)+Ms(o[u],e));break;default:s.push(He(e,r,a)+bo(o[u],l,e,r,Ws(o[u],e)))}a=a&&!s.length}return s.join("")}var Gs=function(t,e){e=go(e);var r=[];return Oe=t,Fe="_root_",e.compact?r.push(Hs(t,e,0,!0)):(t[e.declarationKey]&&r.push(Ps(t[e.declarationKey],e,0)),t[e.elementsKey]&&t[e.elementsKey].length&&r.push(zs(t[e.elementsKey],e,0,!r.length))),r.join("")},xo=Gs,_o=function(t,e){t instanceof Buffer&&(t=t.toString());var r=null;if(typeof t=="string")try{r=JSON.parse(t)}catch{throw new Error("The JSON structure is invalid")}else r=t;return xo(r,e)},Eo=Ds,So=mo,To=Gs,Ao=_o,Ks={xml2js:Eo,xml2json:So,js2xml:To,json2xml:Ao};const Bn=t=>{switch(t.type){case void 0:case"element":const e=new Ro(t.name,t.attributes),r=t.elements||[];for(const a of r){const u=Bn(a);u!==void 0&&e.push(u)}return e;case"text":return t.text;default:return}};class ko extends pe{}class Ro extends ne{static fromXmlString(e){const r=Ks.xml2js(e,{compact:!1});return Bn(r)}constructor(e,r){super(e),r&&this.root.push(new ko(r))}push(e){this.root.push(e)}}class Io extends ne{constructor(e){super(""),this._attr=e}prepForXml(e){return{_attr:this._attr}}}class qs extends ne{constructor(e,r){super(e),r&&(this.root=r.root)}}const Be=t=>{if(isNaN(t))throw new Error(`Invalid value '${t}' specified. Must be an integer.`);return Math.floor(t)},cr=t=>{const e=Be(t);if(e<0)throw new Error(`Invalid value '${t}' specified. Must be a positive integer.`);return e},$s=(t,e)=>{const r=e*2;if(t.length!==r||isNaN(+`0x${t}`))throw new Error(`Invalid hex value '${t}'. Expected ${r} digit hex value`);return t},qi=t=>$s(t,1),Dn=t=>{const e=t.slice(-2),r=t.substring(0,t.length-2);return`${Number(r)}${e}`},Vs=t=>{const e=Dn(t);if(parseFloat(e)<0)throw new Error(`Invalid value '${e}' specified. Expected a positive number.`);return e},vt=t=>{if(t==="auto")return t;const e=t.charAt(0)==="#"?t.substring(1):t;return $s(e,3)},Ve=t=>typeof t=="string"?Dn(t):Be(t),Co=t=>typeof t=="string"?Vs(t):cr(t),Ce=t=>typeof t=="string"?Vs(t):cr(t),No=t=>{const e=t.substring(0,t.length-1);return`${Number(e)}%`},Oo=t=>typeof t=="number"?Be(t):t.slice(-1)==="%"?No(t):Dn(t),Fo=cr,Bo=cr,Do=t=>t.toISOString();class ae extends ne{constructor(e,r=!0){super(e),r!==!0&&this.root.push(new Te({val:r}))}}class on extends ne{constructor(e,r){super(e),this.root.push(new Te({val:Co(r)}))}}class lt extends ne{constructor(e,r){super(e),this.root.push(new Te({val:r}))}}const It=(t,e)=>new tt({name:t,attributes:{value:{key:"w:val",value:e}}});class Pn extends ne{constructor(e,r){super(e),this.root.push(new Te({val:r}))}}class Po extends ne{constructor(e,r){super(e),this.root.push(new Te({val:r}))}}class it extends ne{constructor(e,r){super(e),this.root.push(r)}}class tt extends ne{constructor({name:e,attributes:r,children:a}){super(e),r&&this.root.push(new rt(r)),a&&this.root.push(...a)}}const Ne={START:"start",CENTER:"center",LEFT:"left"};class Lo extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{val:"w:val"})}}class Xs extends ne{constructor(e){super("w:jc"),this.root.push(new Lo({val:e}))}}class _e extends ne{constructor(e,{color:r,size:a,space:u,style:l}){super(e),this.root.push(new Mo({style:l,color:r===void 0?void 0:vt(r),size:a===void 0?void 0:Fo(a),space:u===void 0?void 0:Bo(u)}))}}class Mo extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{style:"w:val",color:"w:color",size:"w:sz",space:"w:space"})}}const Ie={SINGLE:"single",NONE:"none"};class Uo extends Xe{constructor(e){super("w:pBdr"),e.top&&this.root.push(new _e("w:top",e.top)),e.bottom&&this.root.push(new _e("w:bottom",e.bottom)),e.left&&this.root.push(new _e("w:left",e.left)),e.right&&this.root.push(new _e("w:right",e.right))}}class jo extends ne{constructor(){super("w:pBdr");const e=new _e("w:bottom",{color:"auto",space:1,style:Ie.SINGLE,size:6});this.root.push(e)}}class zo extends ne{constructor({start:e,end:r,left:a,right:u,hanging:l,firstLine:o}){super("w:ind"),this.root.push(new rt({start:{key:"w:start",value:e===void 0?void 0:Ve(e)},end:{key:"w:end",value:r===void 0?void 0:Ve(r)},left:{key:"w:left",value:a===void 0?void 0:Ve(a)},right:{key:"w:right",value:u===void 0?void 0:Ve(u)},hanging:{key:"w:hanging",value:l===void 0?void 0:Ce(l)},firstLine:{key:"w:firstLine",value:o===void 0?void 0:Ce(o)}}))}}let Wo=class extends ne{constructor(){super("w:br")}};const Ln={BEGIN:"begin",END:"end",SEPARATE:"separate"};class Mn extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{type:"w:fldCharType",dirty:"w:dirty"})}}class Gt extends ne{constructor(e){super("w:fldChar"),this.root.push(new Mn({type:Ln.BEGIN,dirty:e}))}}class Kt extends ne{constructor(e){super("w:fldChar"),this.root.push(new Mn({type:Ln.SEPARATE,dirty:e}))}}class qt extends ne{constructor(e){super("w:fldChar"),this.root.push(new Mn({type:Ln.END,dirty:e}))}}const bt={DEFAULT:"default",PRESERVE:"preserve"};class xt extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{space:"xml:space"})}}class Ho extends ne{constructor(){super("w:instrText"),this.root.push(new xt({space:bt.PRESERVE})),this.root.push("PAGE")}}class Go extends ne{constructor(){super("w:instrText"),this.root.push(new xt({space:bt.PRESERVE})),this.root.push("NUMPAGES")}}class Ko extends ne{constructor(){super("w:instrText"),this.root.push(new xt({space:bt.PRESERVE})),this.root.push("SECTIONPAGES")}}class qo extends ne{constructor(){super("w:instrText"),this.root.push(new xt({space:bt.PRESERVE})),this.root.push("SECTION")}}class $o extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{fill:"w:fill",color:"w:color",type:"w:val"})}}class fr extends ne{constructor({fill:e,color:r,type:a}){super("w:shd"),this.root.push(new $o({fill:e===void 0?void 0:vt(e),color:r===void 0?void 0:vt(r),type:a}))}}class Vo extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{id:"w:id",author:"w:author",date:"w:date"})}}const Xo={DOT:"dot"};class Yo extends ne{constructor(e){super("w:em"),this.root.push(new Te({val:e}))}}class Zo extends Yo{constructor(e=Xo.DOT){super(e)}}class Jo extends ne{constructor(e){super("w:spacing"),this.root.push(new Te({val:Ve(e)}))}}class Qo extends ne{constructor(e){super("w:color"),this.root.push(new Te({val:vt(e)}))}}class el extends ne{constructor(e){super("w:highlight"),this.root.push(new Te({val:e}))}}class tl extends ne{constructor(e){super("w:highlightCs"),this.root.push(new Te({val:e}))}}const rl=t=>new tt({name:"w:lang",attributes:{value:{key:"w:val",value:t.value},eastAsia:{key:"w:eastAsia",value:t.eastAsia},bidirectional:{key:"w:bidi",value:t.bidirectional}}});class $i extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{ascii:"w:ascii",cs:"w:cs",eastAsia:"w:eastAsia",hAnsi:"w:hAnsi",hint:"w:hint"})}}class ln extends ne{constructor(e,r){if(super("w:rFonts"),typeof e=="string"){const a=e;this.root.push(new $i({ascii:a,cs:a,eastAsia:a,hAnsi:a,hint:r}))}else{const a=e;this.root.push(new $i(a))}}}let Ys=class extends ne{constructor(e){super("w:vertAlign"),this.root.push(new Te({val:e}))}};class nl extends Ys{constructor(){super("superscript")}}class il extends Ys{constructor(){super("subscript")}}const Zs={SINGLE:"single"};class sl extends ne{constructor(e=Zs.SINGLE,r){super("w:u"),this.root.push(new Te({val:e,color:r===void 0?void 0:vt(r)}))}}class ct extends Xe{constructor(e){var r,a;if(super("w:rPr"),!e)return;e.noProof!==void 0&&this.push(new ae("w:noProof",e.noProof)),e.bold!==void 0&&this.push(new ae("w:b",e.bold)),(e.boldComplexScript===void 0&&e.bold!==void 0||e.boldComplexScript)&&this.push(new ae("w:bCs",(r=e.boldComplexScript)!=null?r:e.bold)),e.italics!==void 0&&this.push(new ae("w:i",e.italics)),(e.italicsComplexScript===void 0&&e.italics!==void 0||e.italicsComplexScript)&&this.push(new ae("w:iCs",(a=e.italicsComplexScript)!=null?a:e.italics)),e.underline&&this.push(new sl(e.underline.type,e.underline.color)),e.effect&&this.push(new lt("w:effect",e.effect)),e.emphasisMark&&this.push(new Zo(e.emphasisMark.type)),e.color&&this.push(new Qo(e.color)),e.kern&&this.push(new on("w:kern",e.kern)),e.position&&this.push(new lt("w:position",e.position)),e.size!==void 0&&this.push(new on("w:sz",e.size));const u=e.sizeComplexScript===void 0||e.sizeComplexScript===!0?e.size:e.sizeComplexScript;u&&this.push(new on("w:szCs",u)),e.rightToLeft!==void 0&&this.push(new ae("w:rtl",e.rightToLeft)),e.smallCaps!==void 0?this.push(new ae("w:smallCaps",e.smallCaps)):e.allCaps!==void 0&&this.push(new ae("w:caps",e.allCaps)),e.strike!==void 0&&this.push(new ae("w:strike",e.strike)),e.doubleStrike!==void 0&&this.push(new ae("w:dstrike",e.doubleStrike)),e.subScript&&this.push(new il),e.superScript&&this.push(new nl),e.style&&this.push(new lt("w:rStyle",e.style)),e.font&&(typeof e.font=="string"?this.push(new ln(e.font)):"name"in e.font?this.push(new ln(e.font.name,e.font.hint)):this.push(new ln(e.font))),e.highlight&&this.push(new el(e.highlight));const l=e.highlightComplexScript===void 0||e.highlightComplexScript===!0?e.highlight:e.highlightComplexScript;l&&this.push(new tl(l)),e.characterSpacing&&this.push(new Jo(e.characterSpacing)),e.emboss!==void 0&&this.push(new ae("w:emboss",e.emboss)),e.imprint!==void 0&&this.push(new ae("w:imprint",e.imprint)),e.shading&&this.push(new fr(e.shading)),e.revision&&this.push(new al(e.revision)),e.border&&this.push(new _e("w:bdr",e.border)),e.snapToGrid!==void 0&&this.push(new ae("w:snapToGrid",e.snapToGrid)),e.vanish&&this.push(new ae("w:vanish",e.vanish)),e.specVanish&&this.push(new ae("w:specVanish",e.vanish)),e.scale!==void 0&&this.push(new Pn("w:w",e.scale)),e.language&&this.push(rl(e.language)),e.math&&this.push(new ae("w:oMath",e.math))}push(e){this.root.push(e)}}class al extends ne{constructor(e){super("w:rPrChange"),this.root.push(new Vo({id:e.id,author:e.author,date:e.date})),this.addChildElement(new ct(e))}}class vn extends ne{constructor(e){var r;return super("w:t"),typeof e=="string"?(this.root.push(new xt({space:bt.PRESERVE})),this.root.push(e),this):(this.root.push(new xt({space:(r=e.space)!=null?r:bt.DEFAULT})),this.root.push(e.text),this)}}const $t={CURRENT:"CURRENT",TOTAL_PAGES:"TOTAL_PAGES",TOTAL_PAGES_IN_SECTION:"TOTAL_PAGES_IN_SECTION",CURRENT_SECTION:"SECTION"};class dr extends ne{constructor(e){if(super("w:r"),re(this,"properties"),this.properties=new ct(e),this.root.push(this.properties),e.break)for(let r=0;r<e.break;r++)this.root.push(new Wo);if(e.children)for(const r of e.children){if(typeof r=="string"){switch(r){case $t.CURRENT:this.root.push(new Gt),this.root.push(new Ho),this.root.push(new Kt),this.root.push(new qt);break;case $t.TOTAL_PAGES:this.root.push(new Gt),this.root.push(new Go),this.root.push(new Kt),this.root.push(new qt);break;case $t.TOTAL_PAGES_IN_SECTION:this.root.push(new Gt),this.root.push(new Ko),this.root.push(new Kt),this.root.push(new qt);break;case $t.CURRENT_SECTION:this.root.push(new Gt),this.root.push(new qo),this.root.push(new Kt),this.root.push(new qt);break;default:this.root.push(new vn(r));break}continue}this.root.push(r)}else e.text&&this.root.push(new vn(e.text))}}class Pe extends dr{constructor(e){if(typeof e=="string")return super({}),this.root.push(new vn(e)),this;super(e)}}let ol="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",ll=(t,e=21)=>(r=e)=>{let a="",u=r;for(;u--;)a+=t[Math.random()*t.length|0];return a},ul=(t=21)=>{let e="",r=t;for(;r--;)e+=ol[Math.random()*64|0];return e};const Ue=t=>Math.floor(t*72*20),Un=(t=0)=>{let e=t;return()=>++e},cl=()=>Un(),fl=()=>Un(1),dl=()=>Un(),hl=()=>ul().toLowerCase(),Ct=t=>ll("1234567890abcdef",t)(),pl=()=>`${Ct(8)}-${Ct(4)}-${Ct(4)}-${Ct(4)}-${Ct(12)}`;class ml extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{id:"w:id",initials:"w:initials",author:"w:author",date:"w:date"})}}class wl extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{"xmlns:cx":"xmlns:cx","xmlns:cx1":"xmlns:cx1","xmlns:cx2":"xmlns:cx2","xmlns:cx3":"xmlns:cx3","xmlns:cx4":"xmlns:cx4","xmlns:cx5":"xmlns:cx5","xmlns:cx6":"xmlns:cx6","xmlns:cx7":"xmlns:cx7","xmlns:cx8":"xmlns:cx8","xmlns:mc":"xmlns:mc","xmlns:aink":"xmlns:aink","xmlns:am3d":"xmlns:am3d","xmlns:o":"xmlns:o","xmlns:r":"xmlns:r","xmlns:m":"xmlns:m","xmlns:v":"xmlns:v","xmlns:wp14":"xmlns:wp14","xmlns:wp":"xmlns:wp","xmlns:w10":"xmlns:w10","xmlns:w":"xmlns:w","xmlns:w14":"xmlns:w14","xmlns:w15":"xmlns:w15","xmlns:w16cex":"xmlns:w16cex","xmlns:w16cid":"xmlns:w16cid","xmlns:w16":"xmlns:w16","xmlns:w16sdtdh":"xmlns:w16sdtdh","xmlns:w16se":"xmlns:w16se","xmlns:wpg":"xmlns:wpg","xmlns:wpi":"xmlns:wpi","xmlns:wne":"xmlns:wne","xmlns:wps":"xmlns:wps"})}}class gl extends ne{constructor({id:e,initials:r,author:a,date:u=new Date,children:l}){super("w:comment"),this.root.push(new ml({id:e,initials:r,author:a,date:u.toISOString()}));for(const o of l)this.root.push(o)}}class yl extends ne{constructor({children:e}){super("w:comments"),this.root.push(new wl({"xmlns:cx":"http://schemas.microsoft.com/office/drawing/2014/chartex","xmlns:cx1":"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex","xmlns:cx2":"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex","xmlns:cx3":"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex","xmlns:cx4":"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex","xmlns:cx5":"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex","xmlns:cx6":"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex","xmlns:cx7":"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex","xmlns:cx8":"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","xmlns:aink":"http://schemas.microsoft.com/office/drawing/2016/ink","xmlns:am3d":"http://schemas.microsoft.com/office/drawing/2017/model3d","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:m":"http://schemas.openxmlformats.org/officeDocument/2006/math","xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:wp14":"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing","xmlns:wp":"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing","xmlns:w10":"urn:schemas-microsoft-com:office:word","xmlns:w":"http://schemas.openxmlformats.org/wordprocessingml/2006/main","xmlns:w14":"http://schemas.microsoft.com/office/word/2010/wordml","xmlns:w15":"http://schemas.microsoft.com/office/word/2012/wordml","xmlns:w16cex":"http://schemas.microsoft.com/office/word/2018/wordml/cex","xmlns:w16cid":"http://schemas.microsoft.com/office/word/2016/wordml/cid","xmlns:w16":"http://schemas.microsoft.com/office/word/2018/wordml","xmlns:w16sdtdh":"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash","xmlns:w16se":"http://schemas.microsoft.com/office/word/2015/wordml/symex","xmlns:wpg":"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup","xmlns:wpi":"http://schemas.microsoft.com/office/word/2010/wordprocessingInk","xmlns:wne":"http://schemas.microsoft.com/office/word/2006/wordml","xmlns:wps":"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}));for(const r of e)this.root.push(new gl(r))}}class vl extends ne{constructor(){super("w:pageBreakBefore")}}const bn={AUTO:"auto"};class bl extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{after:"w:after",before:"w:before",line:"w:line",lineRule:"w:lineRule"})}}class xl extends ne{constructor(e){super("w:spacing"),this.root.push(new bl(e))}}const _l={TITLE:"Title"};let Vt=class extends ne{constructor(e){super("w:pStyle"),this.root.push(new Te({val:e}))}};class El extends ne{constructor(e){super("w:tabs");for(const r of e)this.root.push(new Tl(r))}}const tr={LEFT:"left",RIGHT:"right"};class Sl extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{val:"w:val",pos:"w:pos",leader:"w:leader"})}}class Tl extends ne{constructor({type:e,position:r,leader:a}){super("w:tab"),this.root.push(new Sl({val:e,pos:r,leader:a}))}}class Vi extends ne{constructor(e,r){super("w:numPr"),this.root.push(new Al(r)),this.root.push(new kl(e))}}class Al extends ne{constructor(e){if(super("w:ilvl"),e>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new Te({val:e}))}}class kl extends ne{constructor(e){super("w:numId"),this.root.push(new Te({val:typeof e=="string"?`{${e}}`:e}))}}class Js extends ne{constructor(){super(...arguments),re(this,"fileChild",Symbol())}}class Rl extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{id:"Id",type:"Type",target:"Target",targetMode:"TargetMode"})}}const Il={EXTERNAL:"External"};class Cl extends ne{constructor(e,r,a,u){super("Relationship"),this.root.push(new Rl({id:e,type:r,target:a,targetMode:u}))}}class Nl extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{id:"r:id",history:"w:history",anchor:"w:anchor"})}}class Ol extends ne{constructor(e,r,a){super("w:hyperlink"),re(this,"linkId"),this.linkId=r;const u={history:1,anchor:a||void 0,id:a?void 0:`rId${this.linkId}`},l=new Nl(u);this.root.push(l),e.forEach(o=>{this.root.push(o)})}}class Fl extends ne{constructor(e){super("w:externalHyperlink"),this.options=e}}class Bl extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{id:"w:id",name:"w:name"})}}class Dl extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{id:"w:id"})}}class Pl{constructor(e){re(this,"bookmarkUniqueNumericId",dl()),re(this,"start"),re(this,"children"),re(this,"end");const r=this.bookmarkUniqueNumericId();this.start=new Ll(e.id,r),this.children=e.children,this.end=new Ml(r)}}class Ll extends ne{constructor(e,r){super("w:bookmarkStart");const a=new Bl({name:e,id:r});this.root.push(a)}}class Ml extends ne{constructor(e){super("w:bookmarkEnd");const r=new Dl({id:e});this.root.push(r)}}class Ul extends ne{constructor(e){super("w:outlineLvl"),this.level=e,this.root.push(new Te({val:e}))}}class jl extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{verticalAlign:"w:val"})}}class Qs extends ne{constructor(e){super("w:vAlign"),this.root.push(new jl({verticalAlign:e}))}}const wt={DEFAULT:"default",FIRST:"first",EVEN:"even"};class zl extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{type:"w:type",id:"r:id"})}}const Xi={HEADER:"w:headerReference",FOOTER:"w:footerReference"};class un extends ne{constructor(e,r){super(e),this.root.push(new zl({type:r.type||wt.DEFAULT,id:`rId${r.id}`}))}}class Wl extends ne{constructor({space:e,count:r,separate:a,equalWidth:u,children:l}){super("w:cols"),this.root.push(new rt({space:{key:"w:space",value:e===void 0?void 0:Ce(e)},count:{key:"w:num",value:r===void 0?void 0:Be(r)},separate:{key:"w:sep",value:a},equalWidth:{key:"w:equalWidth",value:u}})),!u&&l&&l.forEach(o=>this.addChildElement(o))}}class Hl extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{type:"w:type",linePitch:"w:linePitch",charSpace:"w:charSpace"})}}class Gl extends ne{constructor(e,r,a){super("w:docGrid"),this.root.push(new Hl({type:a,linePitch:Be(e),charSpace:r?Be(r):void 0}))}}const Kl=({countBy:t,start:e,restart:r,distance:a})=>new tt({name:"w:lnNumType",attributes:{countBy:{key:"w:countBy",value:t===void 0?void 0:Be(t)},start:{key:"w:start",value:e===void 0?void 0:Be(e)},restart:{key:"w:restart",value:r},distance:{key:"w:distance",value:a===void 0?void 0:Ce(a)}}});class Yi extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{display:"w:display",offsetFrom:"w:offsetFrom",zOrder:"w:zOrder"})}}class ql extends Xe{constructor(e){if(super("w:pgBorders"),!e)return this;e.pageBorders?this.root.push(new Yi({display:e.pageBorders.display,offsetFrom:e.pageBorders.offsetFrom,zOrder:e.pageBorders.zOrder})):this.root.push(new Yi({})),e.pageBorderTop&&this.root.push(new _e("w:top",e.pageBorderTop)),e.pageBorderLeft&&this.root.push(new _e("w:left",e.pageBorderLeft)),e.pageBorderBottom&&this.root.push(new _e("w:bottom",e.pageBorderBottom)),e.pageBorderRight&&this.root.push(new _e("w:right",e.pageBorderRight))}}class $l extends ne{constructor(e,r,a,u,l,o,s){super("w:pgMar"),this.root.push(new rt({top:{key:"w:top",value:Ve(e)},right:{key:"w:right",value:Ce(r)},bottom:{key:"w:bottom",value:Ve(a)},left:{key:"w:left",value:Ce(u)},header:{key:"w:header",value:Ce(l)},footer:{key:"w:footer",value:Ce(o)},gutter:{key:"w:gutter",value:Ce(s)}}))}}class Vl extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{start:"w:start",formatType:"w:fmt",separator:"w:chapSep"})}}class Xl extends ne{constructor({start:e,formatType:r,separator:a}){super("w:pgNumType"),this.root.push(new Vl({start:e===void 0?void 0:Be(e),formatType:r,separator:a}))}}const ea={PORTRAIT:"portrait",LANDSCAPE:"landscape"};class Yl extends ne{constructor(e,r,a){super("w:pgSz");const u=a===ea.LANDSCAPE,l=Ce(e),o=Ce(r);this.root.push(new rt({width:{key:"w:w",value:u?o:l},height:{key:"w:h",value:u?l:o},orientation:{key:"w:orient",value:a}}))}}class Zl extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{val:"w:val"})}}class Jl extends ne{constructor(e){super("w:textDirection"),this.root.push(new Zl({val:e}))}}class Ql extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{val:"w:val"})}}class eu extends ne{constructor(e){super("w:type"),this.root.push(new Ql({val:e}))}}const st={TOP:1440,RIGHT:1440,BOTTOM:1440,LEFT:1440,HEADER:708,FOOTER:708,GUTTER:0},cn={WIDTH:11906,HEIGHT:16838,ORIENTATION:ea.PORTRAIT};class tu extends ne{constructor({page:{size:{width:e=cn.WIDTH,height:r=cn.HEIGHT,orientation:a=cn.ORIENTATION}={},margin:{top:u=st.TOP,right:l=st.RIGHT,bottom:o=st.BOTTOM,left:s=st.LEFT,header:c=st.HEADER,footer:y=st.FOOTER,gutter:b=st.GUTTER}={},pageNumbers:T={},borders:x,textDirection:w}={},grid:{linePitch:E=360,charSpace:v,type:A}={},headerWrapperGroup:p={},footerWrapperGroup:S={},lineNumbers:k,titlePage:F,verticalAlign:L,column:X,type:G}={}){super("w:sectPr"),this.addHeaderFooterGroup(Xi.HEADER,p),this.addHeaderFooterGroup(Xi.FOOTER,S),G&&this.root.push(new eu(G)),this.root.push(new Yl(e,r,a)),this.root.push(new $l(u,l,o,s,c,y,b)),x&&this.root.push(new ql(x)),k&&this.root.push(Kl(k)),this.root.push(new Xl(T)),X&&this.root.push(new Wl(X)),L&&this.root.push(new Qs(L)),F!==void 0&&this.root.push(new ae("w:titlePg",F)),w&&this.root.push(new Jl(w)),this.root.push(new Gl(E,v,A))}addHeaderFooterGroup(e,r){r.default&&this.root.push(new un(e,{type:wt.DEFAULT,id:r.default.View.ReferenceId})),r.first&&this.root.push(new un(e,{type:wt.FIRST,id:r.first.View.ReferenceId})),r.even&&this.root.push(new un(e,{type:wt.EVEN,id:r.even.View.ReferenceId}))}}class ru extends ne{constructor(){super("w:body"),re(this,"sections",[])}addSection(e){const r=this.sections.pop();this.root.push(this.createSectionParagraph(r)),this.sections.push(new tu(e))}prepForXml(e){return this.sections.length===1&&(this.root.splice(0,1),this.root.push(this.sections.pop())),super.prepForXml(e)}push(e){this.root.push(e)}createSectionParagraph(e){const r=new xe({}),a=new _t({});return a.push(e),r.addChildElement(a),r}}class Lt extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type",cx:"xmlns:cx",cx1:"xmlns:cx1",cx2:"xmlns:cx2",cx3:"xmlns:cx3",cx4:"xmlns:cx4",cx5:"xmlns:cx5",cx6:"xmlns:cx6",cx7:"xmlns:cx7",cx8:"xmlns:cx8",aink:"xmlns:aink",am3d:"xmlns:am3d",w16cex:"xmlns:w16cex",w16cid:"xmlns:w16cid",w16:"xmlns:w16",w16sdtdh:"xmlns:w16sdtdh",w16se:"xmlns:w16se"})}}class nu extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{color:"w:color",themeColor:"w:themeColor",themeShade:"w:themeShade",themeTint:"w:themeTint"})}}class iu extends ne{constructor(e){super("w:background"),this.root.push(new nu({color:e.color===void 0?void 0:vt(e.color),themeColor:e.themeColor,themeShade:e.themeShade===void 0?void 0:qi(e.themeShade),themeTint:e.themeTint===void 0?void 0:qi(e.themeTint)}))}}class su extends ne{constructor(e){super("w:document"),re(this,"body"),this.root.push(new Lt({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",aink:"http://schemas.microsoft.com/office/drawing/2016/ink",am3d:"http://schemas.microsoft.com/office/drawing/2017/model3d",w16cex:"http://schemas.microsoft.com/office/word/2018/wordml/cex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16:"http://schemas.microsoft.com/office/word/2018/wordml",w16sdtdh:"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex",Ignorable:"w14 w15 wp14"})),this.body=new ru,e.background&&this.root.push(new iu(e.background)),this.root.push(this.body)}add(e){return this.body.push(e),this}get Body(){return this.body}}class au extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{xmlns:"xmlns"})}}class Tt extends ne{constructor(){super("Relationships"),this.root.push(new au({xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"}))}createRelationship(e,r,a,u){const l=new Cl(`rId${e}`,r,a,u);return this.root.push(l),l}get RelationshipCount(){return this.root.length-1}}class ta{constructor(e){re(this,"document"),re(this,"relationships"),this.document=new su(e),this.relationships=new Tt}get View(){return this.document}get Relationships(){return this.relationships}}class ou extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{val:"w:val"})}}class lu extends ne{constructor(){super("w:wordWrap"),this.root.push(new ou({val:0}))}}const uu=t=>{var e,r;return new tt({name:"w:framePr",attributes:{anchorLock:{key:"w:anchorLock",value:t.anchorLock},dropCap:{key:"w:dropCap",value:t.dropCap},width:{key:"w:w",value:t.width},height:{key:"w:h",value:t.height},x:{key:"w:x",value:t.position?t.position.x:void 0},y:{key:"w:y",value:t.position?t.position.y:void 0},anchorHorizontal:{key:"w:hAnchor",value:t.anchor.horizontal},anchorVertical:{key:"w:vAnchor",value:t.anchor.vertical},spaceHorizontal:{key:"w:hSpace",value:(e=t.space)==null?void 0:e.horizontal},spaceVertical:{key:"w:vSpace",value:(r=t.space)==null?void 0:r.vertical},rule:{key:"w:hRule",value:t.rule},alignmentX:{key:"w:xAlign",value:t.alignment?t.alignment.x:void 0},alignmentY:{key:"w:yAlign",value:t.alignment?t.alignment.y:void 0},lines:{key:"w:lines",value:t.lines},wrap:{key:"w:wrap",value:t.wrap}}})};class _t extends Xe{constructor(e){var r,a;if(super("w:pPr"),re(this,"numberingReferences",[]),!e)return this;e.heading&&this.push(new Vt(e.heading)),e.bullet&&this.push(new Vt("ListParagraph")),e.numbering&&!e.style&&!e.heading&&(e.numbering.custom||this.push(new Vt("ListParagraph"))),e.style&&this.push(new Vt(e.style)),e.keepNext!==void 0&&this.push(new ae("w:keepNext",e.keepNext)),e.keepLines!==void 0&&this.push(new ae("w:keepLines",e.keepLines)),e.pageBreakBefore&&this.push(new vl),e.frame&&this.push(uu(e.frame)),e.widowControl!==void 0&&this.push(new ae("w:widowControl",e.widowControl)),e.bullet&&this.push(new Vi(1,e.bullet.level)),e.numbering&&(this.numberingReferences.push({reference:e.numbering.reference,instance:(r=e.numbering.instance)!=null?r:0}),this.push(new Vi(`${e.numbering.reference}-${(a=e.numbering.instance)!=null?a:0}`,e.numbering.level))),e.border&&this.push(new Uo(e.border)),e.thematicBreak&&this.push(new jo),e.shading&&this.push(new fr(e.shading)),e.wordWrap&&this.push(new lu),e.overflowPunctuation&&this.push(new ae("w:overflowPunct",e.overflowPunctuation));const u=[...e.rightTabStop!==void 0?[{type:tr.RIGHT,position:e.rightTabStop}]:[],...e.tabStops?e.tabStops:[],...e.leftTabStop!==void 0?[{type:tr.LEFT,position:e.leftTabStop}]:[]];u.length>0&&this.push(new El(u)),e.bidirectional!==void 0&&this.push(new ae("w:bidi",e.bidirectional)),e.spacing&&this.push(new xl(e.spacing)),e.indent&&this.push(new zo(e.indent)),e.contextualSpacing!==void 0&&this.push(new ae("w:contextualSpacing",e.contextualSpacing)),e.alignment&&this.push(new Xs(e.alignment)),e.outlineLevel!==void 0&&this.push(new Ul(e.outlineLevel)),e.suppressLineNumbers!==void 0&&this.push(new ae("w:suppressLineNumbers",e.suppressLineNumbers)),e.autoSpaceEastAsianText!==void 0&&this.push(new ae("w:autoSpaceDN",e.autoSpaceEastAsianText)),e.run&&this.push(new ct(e.run))}push(e){this.root.push(e)}prepForXml(e){if(e.viewWrapper instanceof ta)for(const r of this.numberingReferences)e.file.Numbering.createConcreteNumberingInstance(r.reference,r.instance);return super.prepForXml(e)}}class xe extends Js{constructor(e){if(super("w:p"),re(this,"properties"),typeof e=="string")return this.properties=new _t({}),this.root.push(this.properties),this.root.push(new Pe(e)),this;if(this.properties=new _t(e),this.root.push(this.properties),e.text&&this.root.push(new Pe(e.text)),e.children)for(const r of e.children){if(r instanceof Pl){this.root.push(r.start);for(const a of r.children)this.root.push(a);this.root.push(r.end);continue}this.root.push(r)}}prepForXml(e){for(const r of this.root)if(r instanceof Fl){const a=this.root.indexOf(r),u=new Ol(r.options.children,hl());e.viewWrapper.Relationships.createRelationship(u.linkId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",r.options.link,Il.EXTERNAL),this.root[a]=u}return super.prepForXml(e)}addRunToFront(e){return this.root.splice(1,0,e),this}}class cu extends ne{constructor(e){super("w:tblGrid");for(const r of e)this.root.push(new fu(r))}}class fu extends ne{constructor(e){super("w:gridCol"),e!==void 0&&this.root.push(new rt({width:{key:"w:w",value:Ce(e)}}))}}const ra={TABLE:"w:tblCellMar",TABLE_CELL:"w:tcMar"};class na extends Xe{constructor(e,{marginUnitType:r=rr.DXA,top:a,left:u,bottom:l,right:o}){super(e),a!==void 0&&this.root.push(new ot("w:top",{type:r,size:a})),u!==void 0&&this.root.push(new ot("w:left",{type:r,size:u})),l!==void 0&&this.root.push(new ot("w:bottom",{type:r,size:l})),o!==void 0&&this.root.push(new ot("w:right",{type:r,size:o}))}}const rr={AUTO:"auto",DXA:"dxa",PERCENTAGE:"pct"};class ot extends ne{constructor(e,{type:r=rr.AUTO,size:a}){super(e);let u=a;r===rr.PERCENTAGE&&typeof a=="number"&&(u=`${a}%`),this.root.push(new rt({type:{key:"w:type",value:r},size:{key:"w:w",value:Oo(u)}}))}}class du extends Xe{constructor(e){super("w:tcBorders"),e.top&&this.root.push(new _e("w:top",e.top)),e.start&&this.root.push(new _e("w:start",e.start)),e.left&&this.root.push(new _e("w:left",e.left)),e.bottom&&this.root.push(new _e("w:bottom",e.bottom)),e.end&&this.root.push(new _e("w:end",e.end)),e.right&&this.root.push(new _e("w:right",e.right))}}class hu extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{val:"w:val"})}}class pu extends ne{constructor(e){super("w:gridSpan"),this.root.push(new hu({val:Be(e)}))}}const ia={CONTINUE:"continue",RESTART:"restart"};class mu extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{val:"w:val"})}}class Zi extends ne{constructor(e){super("w:vMerge"),this.root.push(new mu({val:e}))}}class wu extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{val:"w:val"})}}class gu extends ne{constructor(e){super("w:textDirection"),this.root.push(new wu({val:e}))}}class yu extends Xe{constructor(e){super("w:tcPr"),e.width&&this.root.push(new ot("w:tcW",e.width)),e.columnSpan&&this.root.push(new pu(e.columnSpan)),e.verticalMerge?this.root.push(new Zi(e.verticalMerge)):e.rowSpan&&e.rowSpan>1&&this.root.push(new Zi(ia.RESTART)),e.borders&&this.root.push(new du(e.borders)),e.shading&&this.root.push(new fr(e.shading)),e.margins&&this.root.push(new na(ra.TABLE_CELL,e.margins)),e.textDirection&&this.root.push(new gu(e.textDirection)),e.verticalAlign&&this.root.push(new Qs(e.verticalAlign))}}class nr extends ne{constructor(e){super("w:tc"),this.options=e,this.root.push(new yu(e));for(const r of e.children)this.root.push(r)}prepForXml(e){return this.root[this.root.length-1]instanceof xe||this.root.push(new xe({})),super.prepForXml(e)}}const ft={style:Ie.NONE,size:0,color:"auto"},dt={style:Ie.SINGLE,size:4,color:"auto"};class sa extends ne{constructor(e){super("w:tblBorders"),e.top?this.root.push(new _e("w:top",e.top)):this.root.push(new _e("w:top",dt)),e.left?this.root.push(new _e("w:left",e.left)):this.root.push(new _e("w:left",dt)),e.bottom?this.root.push(new _e("w:bottom",e.bottom)):this.root.push(new _e("w:bottom",dt)),e.right?this.root.push(new _e("w:right",e.right)):this.root.push(new _e("w:right",dt)),e.insideHorizontal?this.root.push(new _e("w:insideH",e.insideHorizontal)):this.root.push(new _e("w:insideH",dt)),e.insideVertical?this.root.push(new _e("w:insideV",e.insideVertical)):this.root.push(new _e("w:insideV",dt))}}re(sa,"NONE",{top:ft,bottom:ft,left:ft,right:ft,insideHorizontal:ft,insideVertical:ft});class vu extends ne{constructor({horizontalAnchor:e,verticalAnchor:r,absoluteHorizontalPosition:a,relativeHorizontalPosition:u,absoluteVerticalPosition:l,relativeVerticalPosition:o,bottomFromText:s,topFromText:c,leftFromText:y,rightFromText:b,overlap:T}){super("w:tblpPr"),this.root.push(new rt({leftFromText:{key:"w:leftFromText",value:y===void 0?void 0:Ce(y)},rightFromText:{key:"w:rightFromText",value:b===void 0?void 0:Ce(b)},topFromText:{key:"w:topFromText",value:c===void 0?void 0:Ce(c)},bottomFromText:{key:"w:bottomFromText",value:s===void 0?void 0:Ce(s)},absoluteHorizontalPosition:{key:"w:tblpX",value:a===void 0?void 0:Ve(a)},absoluteVerticalPosition:{key:"w:tblpY",value:l===void 0?void 0:Ve(l)},horizontalAnchor:{key:"w:horzAnchor",value:e===void 0?void 0:e},relativeHorizontalPosition:{key:"w:tblpXSpec",value:u},relativeVerticalPosition:{key:"w:tblpYSpec",value:o},verticalAnchor:{key:"w:vertAnchor",value:r}})),T&&this.root.push(new Po("w:tblOverlap",T))}}class bu extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{type:"w:type"})}}class xu extends ne{constructor(e){super("w:tblLayout"),this.root.push(new bu({type:e}))}}class _u extends Xe{constructor(e){super("w:tblPr"),e.style&&this.root.push(new lt("w:tblStyle",e.style)),e.float&&this.root.push(new vu(e.float)),e.visuallyRightToLeft!==void 0&&this.root.push(new ae("w:bidiVisual",e.visuallyRightToLeft)),e.width&&this.root.push(new ot("w:tblW",e.width)),e.alignment&&this.root.push(new Xs(e.alignment)),e.indent&&this.root.push(new ot("w:tblInd",e.indent)),e.borders&&this.root.push(new sa(e.borders)),e.shading&&this.root.push(new fr(e.shading)),e.layout&&this.root.push(new xu(e.layout)),e.cellMargin&&this.root.push(new na(ra.TABLE,e.cellMargin))}}class Eu extends Js{constructor({rows:e,width:r,columnWidths:a=Array(Math.max(...e.map(x=>x.CellCount))).fill(100),margins:u,indent:l,float:o,layout:s,style:c,borders:y,alignment:b,visuallyRightToLeft:T}){super("w:tbl"),this.root.push(new _u({borders:y??{},width:r??{size:100},indent:l,float:o,layout:s,style:c,alignment:b,cellMargin:u,visuallyRightToLeft:T})),this.root.push(new cu(a));for(const x of e)this.root.push(x);e.forEach((x,w)=>{if(w===e.length-1)return;let E=0;x.cells.forEach(v=>{if(v.options.rowSpan&&v.options.rowSpan>1){const A=new nr({rowSpan:v.options.rowSpan-1,columnSpan:v.options.columnSpan,borders:v.options.borders,children:[],verticalMerge:ia.CONTINUE});e[w+1].addCellToColumnIndex(A,E)}E+=v.options.columnSpan||1})})}}class Su extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{value:"w:val",rule:"w:hRule"})}}class Tu extends ne{constructor(e,r){super("w:trHeight"),this.root.push(new Su({value:Ce(e),rule:r}))}}class Au extends Xe{constructor(e){super("w:trPr"),e.cantSplit!==void 0&&this.root.push(new ae("w:cantSplit",e.cantSplit)),e.tableHeader!==void 0&&this.root.push(new ae("w:tblHeader",e.tableHeader)),e.height&&this.root.push(new Tu(e.height.value,e.height.rule))}}class ku extends ne{constructor(e){super("w:tr"),this.options=e,this.root.push(new Au(e));for(const r of e.children)this.root.push(r)}get CellCount(){return this.options.children.length}get cells(){return this.root.filter(e=>e instanceof nr)}addCellToIndex(e,r){this.root.splice(r+1,0,e)}addCellToColumnIndex(e,r){const a=this.columnIndexToRootIndex(r,!0);this.addCellToIndex(e,a-1)}rootIndexToColumnIndex(e){if(e<1||e>=this.root.length)throw new Error(`cell 'rootIndex' should between 1 to ${this.root.length-1}`);let r=0;for(let a=1;a<e;a++){const u=this.root[a];r+=u.options.columnSpan||1}return r}columnIndexToRootIndex(e,r=!1){if(e<0)throw new Error("cell 'columnIndex' should not less than zero");let a=0,u=1;for(;a<=e;){if(u>=this.root.length){if(r)return this.root.length;throw new Error(`cell 'columnIndex' should not great than ${a-1}`)}const l=this.root[u];u+=1,a+=l&&l.options.columnSpan||1}return u-1}}class Ru extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{xmlns:"xmlns",vt:"xmlns:vt"})}}class Iu extends ne{constructor(){super("Properties"),this.root.push(new Ru({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"}))}}class Cu extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{xmlns:"xmlns"})}}class Nu extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{contentType:"ContentType",extension:"Extension"})}}class Je extends ne{constructor(e,r){super("Default"),this.root.push(new Nu({contentType:e,extension:r}))}}class Ou extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{contentType:"ContentType",partName:"PartName"})}}class Le extends ne{constructor(e,r){super("Override"),this.root.push(new Ou({contentType:e,partName:r}))}}class Fu extends ne{constructor(){super("Types"),this.root.push(new Cu({xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"})),this.root.push(new Je("image/png","png")),this.root.push(new Je("image/jpeg","jpeg")),this.root.push(new Je("image/jpeg","jpg")),this.root.push(new Je("image/bmp","bmp")),this.root.push(new Je("image/gif","gif")),this.root.push(new Je("application/vnd.openxmlformats-package.relationships+xml","rels")),this.root.push(new Je("application/xml","xml")),this.root.push(new Je("application/vnd.openxmlformats-officedocument.obfuscatedFont","odttf")),this.root.push(new Le("application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml","/word/document.xml")),this.root.push(new Le("application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml","/word/styles.xml")),this.root.push(new Le("application/vnd.openxmlformats-package.core-properties+xml","/docProps/core.xml")),this.root.push(new Le("application/vnd.openxmlformats-officedocument.custom-properties+xml","/docProps/custom.xml")),this.root.push(new Le("application/vnd.openxmlformats-officedocument.extended-properties+xml","/docProps/app.xml")),this.root.push(new Le("application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml","/word/numbering.xml")),this.root.push(new Le("application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml","/word/footnotes.xml")),this.root.push(new Le("application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml","/word/settings.xml")),this.root.push(new Le("application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml","/word/comments.xml")),this.root.push(new Le("application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml","/word/fontTable.xml"))}addFooter(e){this.root.push(new Le("application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml",`/word/footer${e}.xml`))}addHeader(e){this.root.push(new Le("application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml",`/word/header${e}.xml`))}}class Bu extends ne{constructor(e){super("cp:coreProperties"),this.root.push(new Lt({cp:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",xsi:"http://www.w3.org/2001/XMLSchema-instance"})),e.title&&this.root.push(new it("dc:title",e.title)),e.subject&&this.root.push(new it("dc:subject",e.subject)),e.creator&&this.root.push(new it("dc:creator",e.creator)),e.keywords&&this.root.push(new it("cp:keywords",e.keywords)),e.description&&this.root.push(new it("dc:description",e.description)),e.lastModifiedBy&&this.root.push(new it("cp:lastModifiedBy",e.lastModifiedBy)),e.revision&&this.root.push(new it("cp:revision",String(e.revision))),this.root.push(new Ji("dcterms:created")),this.root.push(new Ji("dcterms:modified"))}}class Ji extends ne{constructor(e){super(e),this.root.push(new Lt({type:"dcterms:W3CDTF"})),this.root.push(Do(new Date))}}class Du extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{xmlns:"xmlns",vt:"xmlns:vt"})}}class Pu extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{fmtid:"fmtid",pid:"pid",name:"name"})}}class Lu extends ne{constructor(e,r){super("property"),this.root.push(new Pu({fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e.toString(),name:r.name})),this.root.push(new Mu(r.value))}}class Mu extends ne{constructor(e){super("vt:lpwstr"),this.root.push(e)}}class Uu extends ne{constructor(e){super("Properties"),re(this,"nextId"),re(this,"properties",[]),this.root.push(new Du({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"})),this.nextId=2;for(const r of e)this.addCustomProperty(r)}prepForXml(e){return this.properties.forEach(r=>this.root.push(r)),super.prepForXml(e)}addCustomProperty(e){this.properties.push(new Lu(this.nextId++,e))}}class ju extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type"})}}let zu=class extends qs{constructor(e,r){super("w:ftr",r),re(this,"refId"),this.refId=e,r||this.root.push(new ju({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}))}get ReferenceId(){return this.refId}add(e){this.root.push(e)}};class Wu{constructor(e,r,a){re(this,"footer"),re(this,"relationships"),this.media=e,this.footer=new zu(r,a),this.relationships=new Tt}add(e){this.footer.add(e)}addChildElement(e){this.footer.addChildElement(e)}get View(){return this.footer}get Relationships(){return this.relationships}get Media(){return this.media}}class Hu extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{type:"w:type",id:"w:id"})}}class Gu extends ne{constructor(){super("w:footnoteRef")}}class Ku extends dr{constructor(){super({style:"FootnoteReference"}),this.root.push(new Gu)}}const Qi={SEPERATOR:"separator",CONTINUATION_SEPERATOR:"continuationSeparator"};class fn extends ne{constructor(e){super("w:footnote"),this.root.push(new Hu({type:e.type,id:e.id}));for(let r=0;r<e.children.length;r++){const a=e.children[r];r===0&&a.addRunToFront(new Ku),this.root.push(a)}}}class qu extends ne{constructor(){super("w:continuationSeparator")}}class $u extends dr{constructor(){super({}),this.root.push(new qu)}}class Vu extends ne{constructor(){super("w:separator")}}class Xu extends dr{constructor(){super({}),this.root.push(new Vu)}}class Yu extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"})}}class Zu extends ne{constructor(){super("w:footnotes"),this.root.push(new Yu({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"}));const e=new fn({id:-1,type:Qi.SEPERATOR,children:[new xe({spacing:{after:0,line:240,lineRule:bn.AUTO},children:[new Xu]})]});this.root.push(e);const r=new fn({id:0,type:Qi.CONTINUATION_SEPERATOR,children:[new xe({spacing:{after:0,line:240,lineRule:bn.AUTO},children:[new $u]})]});this.root.push(r)}createFootNote(e,r){const a=new fn({id:e,children:r});this.root.push(a)}}class Ju{constructor(){re(this,"footnotess"),re(this,"relationships"),this.footnotess=new Zu,this.relationships=new Tt}get View(){return this.footnotess}get Relationships(){return this.relationships}}class Qu extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type",cx:"xmlns:cx",cx1:"xmlns:cx1",cx2:"xmlns:cx2",cx3:"xmlns:cx3",cx4:"xmlns:cx4",cx5:"xmlns:cx5",cx6:"xmlns:cx6",cx7:"xmlns:cx7",cx8:"xmlns:cx8",w16cid:"xmlns:w16cid",w16se:"xmlns:w16se"})}}let ec=class extends qs{constructor(e,r){super("w:hdr",r),re(this,"refId"),this.refId=e,r||this.root.push(new Qu({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex"}))}get ReferenceId(){return this.refId}add(e){this.root.push(e)}};class tc{constructor(e,r,a){re(this,"header"),re(this,"relationships"),this.media=e,this.header=new ec(r,a),this.relationships=new Tt}add(e){return this.header.add(e),this}addChildElement(e){this.header.addChildElement(e)}get View(){return this.header}get Relationships(){return this.relationships}get Media(){return this.media}}class rc{constructor(){re(this,"map"),this.map=new Map}addImage(e,r){this.map.set(e,r)}get Array(){return Array.from(this.map.values())}}const qe={BULLET:"bullet"};class nc extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{ilvl:"w:ilvl",tentative:"w15:tentative"})}}class ic extends ne{constructor(e){super("w:numFmt"),this.root.push(new Te({val:e}))}}class sc extends ne{constructor(e){super("w:lvlText"),this.root.push(new Te({val:e}))}}class ac extends ne{constructor(e){super("w:lvlJc"),this.root.push(new Te({val:e}))}}class oc extends ne{constructor(e){super("w:suff"),this.root.push(new Te({val:e}))}}class lc extends ne{constructor(){super("w:isLgl")}}class uc extends ne{constructor({level:e,format:r,text:a,alignment:u=Ne.START,start:l=1,style:o,suffix:s,isLegalNumberingStyle:c}){if(super("w:lvl"),re(this,"paragraphProperties"),re(this,"runProperties"),this.root.push(new Pn("w:start",Be(l))),r&&this.root.push(new ic(r)),s&&this.root.push(new oc(s)),c&&this.root.push(new lc),a&&this.root.push(new sc(a)),this.root.push(new ac(u)),this.paragraphProperties=new _t(o&&o.paragraph),this.runProperties=new ct(o&&o.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties),e>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new nc({ilvl:Be(e),tentative:1}))}}class cc extends uc{}class fc extends ne{constructor(e){super("w:multiLevelType"),this.root.push(new Te({val:e}))}}class dc extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{abstractNumId:"w:abstractNumId",restartNumberingAfterBreak:"w15:restartNumberingAfterBreak"})}}class es extends ne{constructor(e,r){super("w:abstractNum"),re(this,"id"),this.root.push(new dc({abstractNumId:Be(e),restartNumberingAfterBreak:0})),this.root.push(new fc("hybridMultilevel")),this.id=e;for(const a of r)this.root.push(new cc(a))}}class hc extends ne{constructor(e){super("w:abstractNumId"),this.root.push(new Te({val:e}))}}class pc extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{numId:"w:numId"})}}class ts extends ne{constructor(e){if(super("w:num"),re(this,"numId"),re(this,"reference"),re(this,"instance"),this.numId=e.numId,this.reference=e.reference,this.instance=e.instance,this.root.push(new pc({numId:Be(e.numId)})),this.root.push(new hc(Be(e.abstractNumId))),e.overrideLevels&&e.overrideLevels.length)for(const r of e.overrideLevels)this.root.push(new wc(r.num,r.start))}}class mc extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{ilvl:"w:ilvl"})}}class wc extends ne{constructor(e,r){super("w:lvlOverride"),this.root.push(new mc({ilvl:e})),r!==void 0&&this.root.push(new yc(r))}}class gc extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{val:"w:val"})}}class yc extends ne{constructor(e){super("w:startOverride"),this.root.push(new gc({val:e}))}}class vc extends ne{constructor(e){super("w:numbering"),re(this,"abstractNumberingMap",new Map),re(this,"concreteNumberingMap",new Map),re(this,"referenceConfigMap",new Map),re(this,"abstractNumUniqueNumericId",cl()),re(this,"concreteNumUniqueNumericId",fl()),this.root.push(new Lt({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"}));const r=new es(this.abstractNumUniqueNumericId(),[{level:0,format:qe.BULLET,text:"â—",alignment:Ne.LEFT,style:{paragraph:{indent:{left:Ue(.5),hanging:Ue(.25)}}}},{level:1,format:qe.BULLET,text:"â—‹",alignment:Ne.LEFT,style:{paragraph:{indent:{left:Ue(1),hanging:Ue(.25)}}}},{level:2,format:qe.BULLET,text:"â– ",alignment:Ne.LEFT,style:{paragraph:{indent:{left:2160,hanging:Ue(.25)}}}},{level:3,format:qe.BULLET,text:"â—",alignment:Ne.LEFT,style:{paragraph:{indent:{left:2880,hanging:Ue(.25)}}}},{level:4,format:qe.BULLET,text:"â—‹",alignment:Ne.LEFT,style:{paragraph:{indent:{left:3600,hanging:Ue(.25)}}}},{level:5,format:qe.BULLET,text:"â– ",alignment:Ne.LEFT,style:{paragraph:{indent:{left:4320,hanging:Ue(.25)}}}},{level:6,format:qe.BULLET,text:"â—",alignment:Ne.LEFT,style:{paragraph:{indent:{left:5040,hanging:Ue(.25)}}}},{level:7,format:qe.BULLET,text:"â—",alignment:Ne.LEFT,style:{paragraph:{indent:{left:5760,hanging:Ue(.25)}}}},{level:8,format:qe.BULLET,text:"â—",alignment:Ne.LEFT,style:{paragraph:{indent:{left:6480,hanging:Ue(.25)}}}}]);this.concreteNumberingMap.set("default-bullet-numbering",new ts({numId:1,abstractNumId:r.id,reference:"default-bullet-numbering",instance:0,overrideLevels:[{num:0,start:1}]})),this.abstractNumberingMap.set("default-bullet-numbering",r);for(const a of e.config)this.abstractNumberingMap.set(a.reference,new es(this.abstractNumUniqueNumericId(),a.levels)),this.referenceConfigMap.set(a.reference,a.levels)}prepForXml(e){for(const r of this.abstractNumberingMap.values())this.root.push(r);for(const r of this.concreteNumberingMap.values())this.root.push(r);return super.prepForXml(e)}createConcreteNumberingInstance(e,r){const a=this.abstractNumberingMap.get(e);if(!a)return;const u=`${e}-${r}`;if(this.concreteNumberingMap.has(u))return;const l=this.referenceConfigMap.get(e),o=l&&l[0].start,s={numId:this.concreteNumUniqueNumericId(),abstractNumId:a.id,reference:e,instance:r,overrideLevels:[o&&Number.isInteger(o)?{num:0,start:o}:{num:0,start:1}]};this.concreteNumberingMap.set(u,new ts(s))}get ConcreteNumbering(){return Array.from(this.concreteNumberingMap.values())}get ReferenceConfig(){return Array.from(this.referenceConfigMap.values())}}class bc extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{version:"w:val",name:"w:name",uri:"w:uri"})}}class xc extends ne{constructor(e){super("w:compatSetting"),this.root.push(new bc({version:e,uri:"http://schemas.microsoft.com/office/word",name:"compatibilityMode"}))}}class _c extends ne{constructor(e){super("w:compat"),e.version&&this.root.push(new xc(e.version)),e.useSingleBorderforContiguousCells&&this.root.push(new ae("w:useSingleBorderforContiguousCells",e.useSingleBorderforContiguousCells)),e.wordPerfectJustification&&this.root.push(new ae("w:wpJustification",e.wordPerfectJustification)),e.noTabStopForHangingIndent&&this.root.push(new ae("w:noTabHangInd",e.noTabStopForHangingIndent)),e.noLeading&&this.root.push(new ae("w:noLeading",e.noLeading)),e.spaceForUnderline&&this.root.push(new ae("w:spaceForUL",e.spaceForUnderline)),e.noColumnBalance&&this.root.push(new ae("w:noColumnBalance",e.noColumnBalance)),e.balanceSingleByteDoubleByteWidth&&this.root.push(new ae("w:balanceSingleByteDoubleByteWidth",e.balanceSingleByteDoubleByteWidth)),e.noExtraLineSpacing&&this.root.push(new ae("w:noExtraLineSpacing",e.noExtraLineSpacing)),e.doNotLeaveBackslashAlone&&this.root.push(new ae("w:doNotLeaveBackslashAlone",e.doNotLeaveBackslashAlone)),e.underlineTrailingSpaces&&this.root.push(new ae("w:ulTrailSpace",e.underlineTrailingSpaces)),e.doNotExpandShiftReturn&&this.root.push(new ae("w:doNotExpandShiftReturn",e.doNotExpandShiftReturn)),e.spacingInWholePoints&&this.root.push(new ae("w:spacingInWholePoints",e.spacingInWholePoints)),e.lineWrapLikeWord6&&this.root.push(new ae("w:lineWrapLikeWord6",e.lineWrapLikeWord6)),e.printBodyTextBeforeHeader&&this.root.push(new ae("w:printBodyTextBeforeHeader",e.printBodyTextBeforeHeader)),e.printColorsBlack&&this.root.push(new ae("w:printColBlack",e.printColorsBlack)),e.spaceWidth&&this.root.push(new ae("w:wpSpaceWidth",e.spaceWidth)),e.showBreaksInFrames&&this.root.push(new ae("w:showBreaksInFrames",e.showBreaksInFrames)),e.subFontBySize&&this.root.push(new ae("w:subFontBySize",e.subFontBySize)),e.suppressBottomSpacing&&this.root.push(new ae("w:suppressBottomSpacing",e.suppressBottomSpacing)),e.suppressTopSpacing&&this.root.push(new ae("w:suppressTopSpacing",e.suppressTopSpacing)),e.suppressSpacingAtTopOfPage&&this.root.push(new ae("w:suppressSpacingAtTopOfPage",e.suppressSpacingAtTopOfPage)),e.suppressTopSpacingWP&&this.root.push(new ae("w:suppressTopSpacingWP",e.suppressTopSpacingWP)),e.suppressSpBfAfterPgBrk&&this.root.push(new ae("w:suppressSpBfAfterPgBrk",e.suppressSpBfAfterPgBrk)),e.swapBordersFacingPages&&this.root.push(new ae("w:swapBordersFacingPages",e.swapBordersFacingPages)),e.convertMailMergeEsc&&this.root.push(new ae("w:convMailMergeEsc",e.convertMailMergeEsc)),e.truncateFontHeightsLikeWP6&&this.root.push(new ae("w:truncateFontHeightsLikeWP6",e.truncateFontHeightsLikeWP6)),e.macWordSmallCaps&&this.root.push(new ae("w:mwSmallCaps",e.macWordSmallCaps)),e.usePrinterMetrics&&this.root.push(new ae("w:usePrinterMetrics",e.usePrinterMetrics)),e.doNotSuppressParagraphBorders&&this.root.push(new ae("w:doNotSuppressParagraphBorders",e.doNotSuppressParagraphBorders)),e.wrapTrailSpaces&&this.root.push(new ae("w:wrapTrailSpaces",e.wrapTrailSpaces)),e.footnoteLayoutLikeWW8&&this.root.push(new ae("w:footnoteLayoutLikeWW8",e.footnoteLayoutLikeWW8)),e.shapeLayoutLikeWW8&&this.root.push(new ae("w:shapeLayoutLikeWW8",e.shapeLayoutLikeWW8)),e.alignTablesRowByRow&&this.root.push(new ae("w:alignTablesRowByRow",e.alignTablesRowByRow)),e.forgetLastTabAlignment&&this.root.push(new ae("w:forgetLastTabAlignment",e.forgetLastTabAlignment)),e.adjustLineHeightInTable&&this.root.push(new ae("w:adjustLineHeightInTable",e.adjustLineHeightInTable)),e.autoSpaceLikeWord95&&this.root.push(new ae("w:autoSpaceLikeWord95",e.autoSpaceLikeWord95)),e.noSpaceRaiseLower&&this.root.push(new ae("w:noSpaceRaiseLower",e.noSpaceRaiseLower)),e.doNotUseHTMLParagraphAutoSpacing&&this.root.push(new ae("w:doNotUseHTMLParagraphAutoSpacing",e.doNotUseHTMLParagraphAutoSpacing)),e.layoutRawTableWidth&&this.root.push(new ae("w:layoutRawTableWidth",e.layoutRawTableWidth)),e.layoutTableRowsApart&&this.root.push(new ae("w:layoutTableRowsApart",e.layoutTableRowsApart)),e.useWord97LineBreakRules&&this.root.push(new ae("w:useWord97LineBreakRules",e.useWord97LineBreakRules)),e.doNotBreakWrappedTables&&this.root.push(new ae("w:doNotBreakWrappedTables",e.doNotBreakWrappedTables)),e.doNotSnapToGridInCell&&this.root.push(new ae("w:doNotSnapToGridInCell",e.doNotSnapToGridInCell)),e.selectFieldWithFirstOrLastCharacter&&this.root.push(new ae("w:selectFldWithFirstOrLastChar",e.selectFieldWithFirstOrLastCharacter)),e.applyBreakingRules&&this.root.push(new ae("w:applyBreakingRules",e.applyBreakingRules)),e.doNotWrapTextWithPunctuation&&this.root.push(new ae("w:doNotWrapTextWithPunct",e.doNotWrapTextWithPunctuation)),e.doNotUseEastAsianBreakRules&&this.root.push(new ae("w:doNotUseEastAsianBreakRules",e.doNotUseEastAsianBreakRules)),e.useWord2002TableStyleRules&&this.root.push(new ae("w:useWord2002TableStyleRules",e.useWord2002TableStyleRules)),e.growAutofit&&this.root.push(new ae("w:growAutofit",e.growAutofit)),e.useFELayout&&this.root.push(new ae("w:useFELayout",e.useFELayout)),e.useNormalStyleForList&&this.root.push(new ae("w:useNormalStyleForList",e.useNormalStyleForList)),e.doNotUseIndentAsNumberingTabStop&&this.root.push(new ae("w:doNotUseIndentAsNumberingTabStop",e.doNotUseIndentAsNumberingTabStop)),e.useAlternateEastAsianLineBreakRules&&this.root.push(new ae("w:useAltKinsokuLineBreakRules",e.useAlternateEastAsianLineBreakRules)),e.allowSpaceOfSameStyleInTable&&this.root.push(new ae("w:allowSpaceOfSameStyleInTable",e.allowSpaceOfSameStyleInTable)),e.doNotSuppressIndentation&&this.root.push(new ae("w:doNotSuppressIndentation",e.doNotSuppressIndentation)),e.doNotAutofitConstrainedTables&&this.root.push(new ae("w:doNotAutofitConstrainedTables",e.doNotAutofitConstrainedTables)),e.autofitToFirstFixedWidthCell&&this.root.push(new ae("w:autofitToFirstFixedWidthCell",e.autofitToFirstFixedWidthCell)),e.underlineTabInNumberingList&&this.root.push(new ae("w:underlineTabInNumList",e.underlineTabInNumberingList)),e.displayHangulFixedWidth&&this.root.push(new ae("w:displayHangulFixedWidth",e.displayHangulFixedWidth)),e.splitPgBreakAndParaMark&&this.root.push(new ae("w:splitPgBreakAndParaMark",e.splitPgBreakAndParaMark)),e.doNotVerticallyAlignCellWithSp&&this.root.push(new ae("w:doNotVertAlignCellWithSp",e.doNotVerticallyAlignCellWithSp)),e.doNotBreakConstrainedForcedTable&&this.root.push(new ae("w:doNotBreakConstrainedForcedTable",e.doNotBreakConstrainedForcedTable)),e.ignoreVerticalAlignmentInTextboxes&&this.root.push(new ae("w:doNotVertAlignInTxbx",e.ignoreVerticalAlignmentInTextboxes)),e.useAnsiKerningPairs&&this.root.push(new ae("w:useAnsiKerningPairs",e.useAnsiKerningPairs)),e.cachedColumnBalance&&this.root.push(new ae("w:cachedColBalance",e.cachedColumnBalance))}}class Ec extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"})}}class Sc extends ne{constructor(e){var r,a,u,l;super("w:settings"),this.root.push(new Ec({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"})),this.root.push(new ae("w:displayBackgroundShape",!0)),e.trackRevisions!==void 0&&this.root.push(new ae("w:trackRevisions",e.trackRevisions)),e.evenAndOddHeaders!==void 0&&this.root.push(new ae("w:evenAndOddHeaders",e.evenAndOddHeaders)),e.updateFields!==void 0&&this.root.push(new ae("w:updateFields",e.updateFields)),e.defaultTabStop!==void 0&&this.root.push(new Pn("w:defaultTabStop",e.defaultTabStop)),this.root.push(new _c(Dt(ve({},(r=e.compatibility)!=null?r:{}),{version:(l=(u=(a=e.compatibility)==null?void 0:a.version)!=null?u:e.compatibilityModeVersion)!=null?l:15})))}}class aa extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{val:"w:val"})}}class Tc extends ne{constructor(e){super("w:name"),this.root.push(new aa({val:e}))}}class Ac extends ne{constructor(e){super("w:uiPriority"),this.root.push(new aa({val:Be(e)}))}}class kc extends pe{constructor(){super(...arguments),re(this,"xmlKeys",{type:"w:type",styleId:"w:styleId",default:"w:default",customStyle:"w:customStyle"})}}class oa extends ne{constructor(e,r){super("w:style"),this.root.push(new kc(e)),r.name&&this.root.push(new Tc(r.name)),r.basedOn&&this.root.push(new lt("w:basedOn",r.basedOn)),r.next&&this.root.push(new lt("w:next",r.next)),r.link&&this.root.push(new lt("w:link",r.link)),r.uiPriority!==void 0&&this.root.push(new Ac(r.uiPriority)),r.semiHidden!==void 0&&this.root.push(new ae("w:semiHidden",r.semiHidden)),r.unhideWhenUsed!==void 0&&this.root.push(new ae("w:unhideWhenUsed",r.unhideWhenUsed)),r.quickFormat!==void 0&&this.root.push(new ae("w:qFormat",r.quickFormat))}}class hr extends oa{constructor(e){super({type:"paragraph",styleId:e.id},e),re(this,"paragraphProperties"),re(this,"runProperties"),this.paragraphProperties=new _t(e.paragraph),this.runProperties=new ct(e.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties)}}class pr extends oa{constructor(e){super({type:"character",styleId:e.id},ve({uiPriority:99,unhideWhenUsed:!0},e)),re(this,"runProperties"),this.runProperties=new ct(e.run),this.root.push(this.runProperties)}}class nt extends hr{constructor(e){super(ve({basedOn:"Normal",next:"Normal",quickFormat:!0},e))}}class Rc extends nt{constructor(e){super(ve({id:"Title",name:"Title"},e))}}class Ic extends nt{constructor(e){super(ve({id:"Heading1",name:"Heading 1"},e))}}class Cc extends nt{constructor(e){super(ve({id:"Heading2",name:"Heading 2"},e))}}class Nc extends nt{constructor(e){super(ve({id:"Heading3",name:"Heading 3"},e))}}class Oc extends nt{constructor(e){super(ve({id:"Heading4",name:"Heading 4"},e))}}class Fc extends nt{constructor(e){super(ve({id:"Heading5",name:"Heading 5"},e))}}class Bc extends nt{constructor(e){super(ve({id:"Heading6",name:"Heading 6"},e))}}class Dc extends nt{constructor(e){super(ve({id:"Strong",name:"Strong"},e))}}class Pc extends hr{constructor(e){super(ve({id:"ListParagraph",name:"List Paragraph",basedOn:"Normal",quickFormat:!0},e))}}class Lc extends hr{constructor(e){super(ve({id:"FootnoteText",name:"footnote text",link:"FootnoteTextChar",basedOn:"Normal",uiPriority:99,semiHidden:!0,unhideWhenUsed:!0,paragraph:{spacing:{after:0,line:240,lineRule:bn.AUTO}},run:{size:20}},e))}}class Mc extends pr{constructor(e){super(ve({id:"FootnoteReference",name:"footnote reference",basedOn:"DefaultParagraphFont",semiHidden:!0,run:{superScript:!0}},e))}}class Uc extends pr{constructor(e){super(ve({id:"FootnoteTextChar",name:"Footnote Text Char",basedOn:"DefaultParagraphFont",link:"FootnoteText",semiHidden:!0,run:{size:20}},e))}}class jc extends pr{constructor(e){super(ve({id:"Hyperlink",name:"Hyperlink",basedOn:"DefaultParagraphFont",run:{color:"0563C1",underline:{type:Zs.SINGLE}}},e))}}class xn extends ne{constructor(e){if(super("w:styles"),e.initialStyles&&this.root.push(e.initialStyles),e.importedStyles)for(const r of e.importedStyles)this.root.push(r);if(e.paragraphStyles)for(const r of e.paragraphStyles)this.root.push(new hr(r));if(e.characterStyles)for(const r of e.characterStyles)this.root.push(new pr(r))}}class zc extends ne{constructor(e){super("w:pPrDefault"),this.root.push(new _t(e))}}class Wc extends ne{constructor(e){super("w:rPrDefault"),this.root.push(new ct(e))}}class Hc extends ne{constructor(e){super("w:docDefaults"),re(this,"runPropertiesDefaults"),re(this,"paragraphPropertiesDefaults"),this.runPropertiesDefaults=new Wc(e.run),this.paragraphPropertiesDefaults=new zc(e.paragraph),this.root.push(this.runPropertiesDefaults),this.root.push(this.paragraphPropertiesDefaults)}}class Gc{newInstance(e){const r=Ks.xml2js(e,{compact:!1});let a;for(const o of r.elements||[])o.name==="w:styles"&&(a=o);if(a===void 0)throw new Error("can not find styles element");const u=a.elements||[];return new xn({initialStyles:new Io(a.attributes),importedStyles:u.map(o=>Bn(o))})}}class rs{newInstance(e={}){var r;return{initialStyles:new Lt({mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",Ignorable:"w14 w15"}),importedStyles:[new Hc((r=e.document)!=null?r:{}),new Rc(ve({run:{size:56}},e.title)),new Ic(ve({run:{color:"2E74B5",size:32}},e.heading1)),new Cc(ve({run:{color:"2E74B5",size:26}},e.heading2)),new Nc(ve({run:{color:"1F4D78",size:24}},e.heading3)),new Oc(ve({run:{color:"2E74B5",italics:!0}},e.heading4)),new Fc(ve({run:{color:"2E74B5"}},e.heading5)),new Bc(ve({run:{color:"1F4D78"}},e.heading6)),new Dc(ve({run:{bold:!0}},e.strong)),new Pc(e.listParagraph||{}),new jc(e.hyperlink||{}),new Mc(e.footnoteReference||{}),new Lc(e.footnoteText||{}),new Uc(e.footnoteTextChar||{})]}}}const Xt=({id:t,fontKey:e,subsetted:r},a)=>new tt({name:a,attributes:ve({id:{key:"r:id",value:t}},e?{fontKey:{key:"w:fontKey",value:`{${e}}`}}:{}),children:[...r?[new ae("w:subsetted",r)]:[]]}),Kc=({name:t,altName:e,panose1:r,charset:a,family:u,notTrueType:l,pitch:o,sig:s,embedRegular:c,embedBold:y,embedItalic:b,embedBoldItalic:T})=>new tt({name:"w:font",attributes:{name:{key:"w:name",value:t}},children:[...e?[It("w:altName",e)]:[],...r?[It("w:panose1",r)]:[],...a?[It("w:charset",a)]:[],It("w:family",u),...l?[new ae("w:notTrueType",l)]:[],It("w:pitch",o),...s?[new tt({name:"w:sig",attributes:{usb0:{key:"w:usb0",value:s.usb0},usb1:{key:"w:usb1",value:s.usb1},usb2:{key:"w:usb2",value:s.usb2},usb3:{key:"w:usb3",value:s.usb3},csb0:{key:"w:csb0",value:s.csb0},csb1:{key:"w:csb1",value:s.csb1}}})]:[],...c?[Xt(c,"w:embedRegular")]:[],...y?[Xt(y,"w:embedBold")]:[],...b?[Xt(b,"w:embedItalic")]:[],...T?[Xt(T,"w:embedBoldItalic")]:[]]}),qc=({name:t,index:e,fontKey:r,characterSet:a})=>Kc({name:t,sig:{usb0:"E0002AFF",usb1:"C000247B",usb2:"00000009",usb3:"00000000",csb0:"000001FF",csb1:"00000000"},charset:a,family:"auto",pitch:"variable",embedRegular:{fontKey:r,id:`rId${e}`}}),$c=t=>new tt({name:"w:fonts",attributes:{mc:{key:"xmlns:mc",value:"http://schemas.openxmlformats.org/markup-compatibility/2006"},r:{key:"xmlns:r",value:"http://schemas.openxmlformats.org/officeDocument/2006/relationships"},w:{key:"xmlns:w",value:"http://schemas.openxmlformats.org/wordprocessingml/2006/main"},w14:{key:"xmlns:w14",value:"http://schemas.microsoft.com/office/word/2010/wordml"},w15:{key:"xmlns:w15",value:"http://schemas.microsoft.com/office/word/2012/wordml"},w16cex:{key:"xmlns:w16cex",value:"http://schemas.microsoft.com/office/word/2018/wordml/cex"},w16cid:{key:"xmlns:w16cid",value:"http://schemas.microsoft.com/office/word/2016/wordml/cid"},w16:{key:"xmlns:w16",value:"http://schemas.microsoft.com/office/word/2018/wordml"},w16sdtdh:{key:"xmlns:w16sdtdh",value:"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash"},w16se:{key:"xmlns:w16se",value:"http://schemas.microsoft.com/office/word/2015/wordml/symex"},Ignorable:{key:"mc:Ignorable",value:"w14 w15 w16se w16cid w16 w16cex w16sdtdh"}},children:t.map((e,r)=>qc({name:e.name,index:r+1,fontKey:e.fontKey}))});class Vc{constructor(e){re(this,"fontTable"),re(this,"relationships"),re(this,"fontOptionsWithKey",[]),this.options=e,this.fontOptionsWithKey=e.map(r=>Dt(ve({},r),{fontKey:pl()})),this.fontTable=$c(this.fontOptionsWithKey),this.relationships=new Tt;for(let r=0;r<e.length;r++)this.relationships.createRelationship(r+1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/font",`fonts/${e[r].name}.odttf`)}get View(){return this.fontTable}get Relationships(){return this.relationships}}class Xc{constructor(e){re(this,"currentRelationshipId",1),re(this,"documentWrapper"),re(this,"headers",[]),re(this,"footers",[]),re(this,"coreProperties"),re(this,"numbering"),re(this,"media"),re(this,"fileRelationships"),re(this,"footnotesWrapper"),re(this,"settings"),re(this,"contentTypes"),re(this,"customProperties"),re(this,"appProperties"),re(this,"styles"),re(this,"comments"),re(this,"fontWrapper");var r,a,u,l,o,s,c,y;if(this.coreProperties=new Bu(Dt(ve({},e),{creator:(r=e.creator)!=null?r:"Un-named",revision:(a=e.revision)!=null?a:1,lastModifiedBy:(u=e.lastModifiedBy)!=null?u:"Un-named"})),this.numbering=new vc(e.numbering?e.numbering:{config:[]}),this.comments=new yl((l=e.comments)!=null?l:{children:[]}),this.fileRelationships=new Tt,this.customProperties=new Uu((o=e.customProperties)!=null?o:[]),this.appProperties=new Iu,this.footnotesWrapper=new Ju,this.contentTypes=new Fu,this.documentWrapper=new ta({background:e.background}),this.settings=new Sc({compatibilityModeVersion:e.compatabilityModeVersion,compatibility:e.compatibility,evenAndOddHeaders:!!e.evenAndOddHeaderAndFooters,trackRevisions:(s=e.features)==null?void 0:s.trackRevisions,updateFields:(c=e.features)==null?void 0:c.updateFields,defaultTabStop:e.defaultTabStop}),this.media=new rc,e.externalStyles){const b=new Gc;this.styles=b.newInstance(e.externalStyles)}else if(e.styles){const T=new rs().newInstance(e.styles.default);this.styles=new xn(ve(ve({},T),e.styles))}else{const b=new rs;this.styles=new xn(b.newInstance())}this.addDefaultRelationships();for(const b of e.sections)this.addSection(b);if(e.footnotes)for(const b in e.footnotes)this.footnotesWrapper.View.createFootNote(parseFloat(b),e.footnotes[b].children);this.fontWrapper=new Vc((y=e.fonts)!=null?y:[])}addSection({headers:e={},footers:r={},children:a,properties:u}){this.documentWrapper.View.Body.addSection(Dt(ve({},u),{headerWrapperGroup:{default:e.default?this.createHeader(e.default):void 0,first:e.first?this.createHeader(e.first):void 0,even:e.even?this.createHeader(e.even):void 0},footerWrapperGroup:{default:r.default?this.createFooter(r.default):void 0,first:r.first?this.createFooter(r.first):void 0,even:r.even?this.createFooter(r.even):void 0}}));for(const l of a)this.documentWrapper.View.add(l)}createHeader(e){const r=new tc(this.media,this.currentRelationshipId++);for(const a of e.options.children)r.add(a);return this.addHeaderToDocument(r),r}createFooter(e){const r=new Wu(this.media,this.currentRelationshipId++);for(const a of e.options.children)r.add(a);return this.addFooterToDocument(r),r}addHeaderToDocument(e,r=wt.DEFAULT){this.headers.push({header:e,type:r}),this.documentWrapper.Relationships.createRelationship(e.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",`header${this.headers.length}.xml`),this.contentTypes.addHeader(this.headers.length)}addFooterToDocument(e,r=wt.DEFAULT){this.footers.push({footer:e,type:r}),this.documentWrapper.Relationships.createRelationship(e.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",`footer${this.footers.length}.xml`),this.contentTypes.addFooter(this.footers.length)}addDefaultRelationships(){this.fileRelationships.createRelationship(1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument","word/document.xml"),this.fileRelationships.createRelationship(2,"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties","docProps/core.xml"),this.fileRelationships.createRelationship(3,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties","docProps/app.xml"),this.fileRelationships.createRelationship(4,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties","docProps/custom.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles","styles.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering","numbering.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes","footnotes.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings","settings.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments","comments.xml")}get Document(){return this.documentWrapper}get Styles(){return this.styles}get CoreProperties(){return this.coreProperties}get Numbering(){return this.numbering}get Media(){return this.media}get FileRelationships(){return this.fileRelationships}get Headers(){return this.headers.map(e=>e.header)}get Footers(){return this.footers.map(e=>e.footer)}get ContentTypes(){return this.contentTypes}get CustomProperties(){return this.customProperties}get AppProperties(){return this.appProperties}get FootNotes(){return this.footnotesWrapper}get Settings(){return this.settings}get Comments(){return this.comments}get FontTable(){return this.fontWrapper}}function Yt(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var la={exports:{}};(function(t,e){(function(r){t.exports=r()})(function(){return function r(a,u,l){function o(y,b){if(!u[y]){if(!a[y]){var T=typeof Yt=="function"&&Yt;if(!b&&T)return T(y,!0);if(s)return s(y,!0);var x=new Error("Cannot find module '"+y+"'");throw x.code="MODULE_NOT_FOUND",x}var w=u[y]={exports:{}};a[y][0].call(w.exports,function(E){var v=a[y][1][E];return o(v||E)},w,w.exports,r,a,u,l)}return u[y].exports}for(var s=typeof Yt=="function"&&Yt,c=0;c<l.length;c++)o(l[c]);return o}({1:[function(r,a,u){var l=r("./utils"),o=r("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";u.encode=function(c){for(var y,b,T,x,w,E,v,A=[],p=0,S=c.length,k=S,F=l.getTypeOf(c)!=="string";p<c.length;)k=S-p,T=F?(y=c[p++],b=p<S?c[p++]:0,p<S?c[p++]:0):(y=c.charCodeAt(p++),b=p<S?c.charCodeAt(p++):0,p<S?c.charCodeAt(p++):0),x=y>>2,w=(3&y)<<4|b>>4,E=1<k?(15&b)<<2|T>>6:64,v=2<k?63&T:64,A.push(s.charAt(x)+s.charAt(w)+s.charAt(E)+s.charAt(v));return A.join("")},u.decode=function(c){var y,b,T,x,w,E,v=0,A=0,p="data:";if(c.substr(0,p.length)===p)throw new Error("Invalid base64 input, it looks like a data url.");var S,k=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===s.charAt(64)&&k--,c.charAt(c.length-2)===s.charAt(64)&&k--,k%1!=0)throw new Error("Invalid base64 input, bad content length.");for(S=o.uint8array?new Uint8Array(0|k):new Array(0|k);v<c.length;)y=s.indexOf(c.charAt(v++))<<2|(x=s.indexOf(c.charAt(v++)))>>4,b=(15&x)<<4|(w=s.indexOf(c.charAt(v++)))>>2,T=(3&w)<<6|(E=s.indexOf(c.charAt(v++))),S[A++]=y,w!==64&&(S[A++]=b),E!==64&&(S[A++]=T);return S}},{"./support":30,"./utils":32}],2:[function(r,a,u){var l=r("./external"),o=r("./stream/DataWorker"),s=r("./stream/Crc32Probe"),c=r("./stream/DataLengthProbe");function y(b,T,x,w,E){this.compressedSize=b,this.uncompressedSize=T,this.crc32=x,this.compression=w,this.compressedContent=E}y.prototype={getContentWorker:function(){var b=new o(l.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),T=this;return b.on("end",function(){if(this.streamInfo.data_length!==T.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),b},getCompressedWorker:function(){return new o(l.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},y.createWorkerFrom=function(b,T,x){return b.pipe(new s).pipe(new c("uncompressedSize")).pipe(T.compressWorker(x)).pipe(new c("compressedSize")).withStreamInfo("compression",T)},a.exports=y},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(r,a,u){var l=r("./stream/GenericWorker");u.STORE={magic:"\0\0",compressWorker:function(){return new l("STORE compression")},uncompressWorker:function(){return new l("STORE decompression")}},u.DEFLATE=r("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(r,a,u){var l=r("./utils"),o=function(){for(var s,c=[],y=0;y<256;y++){s=y;for(var b=0;b<8;b++)s=1&s?3988292384^s>>>1:s>>>1;c[y]=s}return c}();a.exports=function(s,c){return s!==void 0&&s.length?l.getTypeOf(s)!=="string"?function(y,b,T,x){var w=o,E=x+T;y^=-1;for(var v=x;v<E;v++)y=y>>>8^w[255&(y^b[v])];return-1^y}(0|c,s,s.length,0):function(y,b,T,x){var w=o,E=x+T;y^=-1;for(var v=x;v<E;v++)y=y>>>8^w[255&(y^b.charCodeAt(v))];return-1^y}(0|c,s,s.length,0):0}},{"./utils":32}],5:[function(r,a,u){u.base64=!1,u.binary=!1,u.dir=!1,u.createFolders=!0,u.date=null,u.compression=null,u.compressionOptions=null,u.comment=null,u.unixPermissions=null,u.dosPermissions=null},{}],6:[function(r,a,u){var l=null;l=typeof Promise<"u"?Promise:r("lie"),a.exports={Promise:l}},{lie:37}],7:[function(r,a,u){var l=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",o=r("pako"),s=r("./utils"),c=r("./stream/GenericWorker"),y=l?"uint8array":"array";function b(T,x){c.call(this,"FlateWorker/"+T),this._pako=null,this._pakoAction=T,this._pakoOptions=x,this.meta={}}u.magic="\b\0",s.inherits(b,c),b.prototype.processChunk=function(T){this.meta=T.meta,this._pako===null&&this._createPako(),this._pako.push(s.transformTo(y,T.data),!1)},b.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},b.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},b.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var T=this;this._pako.onData=function(x){T.push({data:x,meta:T.meta})}},u.compressWorker=function(T){return new b("Deflate",T)},u.uncompressWorker=function(){return new b("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(r,a,u){function l(w,E){var v,A="";for(v=0;v<E;v++)A+=String.fromCharCode(255&w),w>>>=8;return A}function o(w,E,v,A,p,S){var k,F,L=w.file,X=w.compression,G=S!==y.utf8encode,Z=s.transformTo("string",S(L.name)),R=s.transformTo("string",y.utf8encode(L.name)),se=L.comment,ce=s.transformTo("string",S(se)),B=s.transformTo("string",y.utf8encode(se)),K=R.length!==L.name.length,_=B.length!==se.length,$="",le="",V="",de=L.dir,ee=L.date,fe={crc32:0,compressedSize:0,uncompressedSize:0};E&&!v||(fe.crc32=w.crc32,fe.compressedSize=w.compressedSize,fe.uncompressedSize=w.uncompressedSize);var W=0;E&&(W|=8),G||!K&&!_||(W|=2048);var C=0,z=0;de&&(C|=16),p==="UNIX"?(z=798,C|=function(Q,j){var m=Q;return Q||(m=j?16893:33204),(65535&m)<<16}(L.unixPermissions,de)):(z=20,C|=function(Q){return 63&(Q||0)}(L.dosPermissions)),k=ee.getUTCHours(),k<<=6,k|=ee.getUTCMinutes(),k<<=5,k|=ee.getUTCSeconds()/2,F=ee.getUTCFullYear()-1980,F<<=4,F|=ee.getUTCMonth()+1,F<<=5,F|=ee.getUTCDate(),K&&(le=l(1,1)+l(b(Z),4)+R,$+="up"+l(le.length,2)+le),_&&(V=l(1,1)+l(b(ce),4)+B,$+="uc"+l(V.length,2)+V);var H="";return H+=`
\0`,H+=l(W,2),H+=X.magic,H+=l(k,2),H+=l(F,2),H+=l(fe.crc32,4),H+=l(fe.compressedSize,4),H+=l(fe.uncompressedSize,4),H+=l(Z.length,2),H+=l($.length,2),{fileRecord:T.LOCAL_FILE_HEADER+H+Z+$,dirRecord:T.CENTRAL_FILE_HEADER+l(z,2)+H+l(ce.length,2)+"\0\0\0\0"+l(C,4)+l(A,4)+Z+$+ce}}var s=r("../utils"),c=r("../stream/GenericWorker"),y=r("../utf8"),b=r("../crc32"),T=r("../signature");function x(w,E,v,A){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=E,this.zipPlatform=v,this.encodeFileName=A,this.streamFiles=w,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(x,c),x.prototype.push=function(w){var E=w.meta.percent||0,v=this.entriesCount,A=this._sources.length;this.accumulate?this.contentBuffer.push(w):(this.bytesWritten+=w.data.length,c.prototype.push.call(this,{data:w.data,meta:{currentFile:this.currentFile,percent:v?(E+100*(v-A-1))/v:100}}))},x.prototype.openedSource=function(w){this.currentSourceOffset=this.bytesWritten,this.currentFile=w.file.name;var E=this.streamFiles&&!w.file.dir;if(E){var v=o(w,E,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:v.fileRecord,meta:{percent:0}})}else this.accumulate=!0},x.prototype.closedSource=function(w){this.accumulate=!1;var E=this.streamFiles&&!w.file.dir,v=o(w,E,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(v.dirRecord),E)this.push({data:function(A){return T.DATA_DESCRIPTOR+l(A.crc32,4)+l(A.compressedSize,4)+l(A.uncompressedSize,4)}(w),meta:{percent:100}});else for(this.push({data:v.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},x.prototype.flush=function(){for(var w=this.bytesWritten,E=0;E<this.dirRecords.length;E++)this.push({data:this.dirRecords[E],meta:{percent:100}});var v=this.bytesWritten-w,A=function(p,S,k,F,L){var X=s.transformTo("string",L(F));return T.CENTRAL_DIRECTORY_END+"\0\0\0\0"+l(p,2)+l(p,2)+l(S,4)+l(k,4)+l(X.length,2)+X}(this.dirRecords.length,v,w,this.zipComment,this.encodeFileName);this.push({data:A,meta:{percent:100}})},x.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},x.prototype.registerPrevious=function(w){this._sources.push(w);var E=this;return w.on("data",function(v){E.processChunk(v)}),w.on("end",function(){E.closedSource(E.previous.streamInfo),E._sources.length?E.prepareNextSource():E.end()}),w.on("error",function(v){E.error(v)}),this},x.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},x.prototype.error=function(w){var E=this._sources;if(!c.prototype.error.call(this,w))return!1;for(var v=0;v<E.length;v++)try{E[v].error(w)}catch{}return!0},x.prototype.lock=function(){c.prototype.lock.call(this);for(var w=this._sources,E=0;E<w.length;E++)w[E].lock()},a.exports=x},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(r,a,u){var l=r("../compressions"),o=r("./ZipFileWorker");u.generateWorker=function(s,c,y){var b=new o(c.streamFiles,y,c.platform,c.encodeFileName),T=0;try{s.forEach(function(x,w){T++;var E=function(S,k){var F=S||k,L=l[F];if(!L)throw new Error(F+" is not a valid compression method !");return L}(w.options.compression,c.compression),v=w.options.compressionOptions||c.compressionOptions||{},A=w.dir,p=w.date;w._compressWorker(E,v).withStreamInfo("file",{name:x,dir:A,date:p,comment:w.comment||"",unixPermissions:w.unixPermissions,dosPermissions:w.dosPermissions}).pipe(b)}),b.entriesCount=T}catch(x){b.error(x)}return b}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(r,a,u){function l(){if(!(this instanceof l))return new l;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var o=new l;for(var s in this)typeof this[s]!="function"&&(o[s]=this[s]);return o}}(l.prototype=r("./object")).loadAsync=r("./load"),l.support=r("./support"),l.defaults=r("./defaults"),l.version="3.10.1",l.loadAsync=function(o,s){return new l().loadAsync(o,s)},l.external=r("./external"),a.exports=l},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(r,a,u){var l=r("./utils"),o=r("./external"),s=r("./utf8"),c=r("./zipEntries"),y=r("./stream/Crc32Probe"),b=r("./nodejsUtils");function T(x){return new o.Promise(function(w,E){var v=x.decompressed.getContentWorker().pipe(new y);v.on("error",function(A){E(A)}).on("end",function(){v.streamInfo.crc32!==x.decompressed.crc32?E(new Error("Corrupted zip : CRC32 mismatch")):w()}).resume()})}a.exports=function(x,w){var E=this;return w=l.extend(w||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),b.isNode&&b.isStream(x)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):l.prepareContent("the loaded zip file",x,!0,w.optimizedBinaryString,w.base64).then(function(v){var A=new c(w);return A.load(v),A}).then(function(v){var A=[o.Promise.resolve(v)],p=v.files;if(w.checkCRC32)for(var S=0;S<p.length;S++)A.push(T(p[S]));return o.Promise.all(A)}).then(function(v){for(var A=v.shift(),p=A.files,S=0;S<p.length;S++){var k=p[S],F=k.fileNameStr,L=l.resolve(k.fileNameStr);E.file(L,k.decompressed,{binary:!0,optimizedBinaryString:!0,date:k.date,dir:k.dir,comment:k.fileCommentStr.length?k.fileCommentStr:null,unixPermissions:k.unixPermissions,dosPermissions:k.dosPermissions,createFolders:w.createFolders}),k.dir||(E.file(L).unsafeOriginalName=F)}return A.zipComment.length&&(E.comment=A.zipComment),E})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(r,a,u){var l=r("../utils"),o=r("../stream/GenericWorker");function s(c,y){o.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(y)}l.inherits(s,o),s.prototype._bindStream=function(c){var y=this;(this._stream=c).pause(),c.on("data",function(b){y.push({data:b,meta:{percent:0}})}).on("error",function(b){y.isPaused?this.generatedError=b:y.error(b)}).on("end",function(){y.isPaused?y._upstreamEnded=!0:y.end()})},s.prototype.pause=function(){return!!o.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},a.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(r,a,u){var l=r("readable-stream").Readable;function o(s,c,y){l.call(this,c),this._helper=s;var b=this;s.on("data",function(T,x){b.push(T)||b._helper.pause(),y&&y(x)}).on("error",function(T){b.emit("error",T)}).on("end",function(){b.push(null)})}r("../utils").inherits(o,l),o.prototype._read=function(){this._helper.resume()},a.exports=o},{"../utils":32,"readable-stream":16}],14:[function(r,a,u){a.exports={isNode:typeof Buffer<"u",newBufferFrom:function(l,o){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(l,o);if(typeof l=="number")throw new Error('The "data" argument must not be a number');return new Buffer(l,o)},allocBuffer:function(l){if(Buffer.alloc)return Buffer.alloc(l);var o=new Buffer(l);return o.fill(0),o},isBuffer:function(l){return Buffer.isBuffer(l)},isStream:function(l){return l&&typeof l.on=="function"&&typeof l.pause=="function"&&typeof l.resume=="function"}}},{}],15:[function(r,a,u){function l(L,X,G){var Z,R=s.getTypeOf(X),se=s.extend(G||{},b);se.date=se.date||new Date,se.compression!==null&&(se.compression=se.compression.toUpperCase()),typeof se.unixPermissions=="string"&&(se.unixPermissions=parseInt(se.unixPermissions,8)),se.unixPermissions&&16384&se.unixPermissions&&(se.dir=!0),se.dosPermissions&&16&se.dosPermissions&&(se.dir=!0),se.dir&&(L=p(L)),se.createFolders&&(Z=A(L))&&S.call(this,Z,!0);var ce=R==="string"&&se.binary===!1&&se.base64===!1;G&&G.binary!==void 0||(se.binary=!ce),(X instanceof T&&X.uncompressedSize===0||se.dir||!X||X.length===0)&&(se.base64=!1,se.binary=!0,X="",se.compression="STORE",R="string");var B=null;B=X instanceof T||X instanceof c?X:E.isNode&&E.isStream(X)?new v(L,X):s.prepareContent(L,X,se.binary,se.optimizedBinaryString,se.base64);var K=new x(L,B,se);this.files[L]=K}var o=r("./utf8"),s=r("./utils"),c=r("./stream/GenericWorker"),y=r("./stream/StreamHelper"),b=r("./defaults"),T=r("./compressedObject"),x=r("./zipObject"),w=r("./generate"),E=r("./nodejsUtils"),v=r("./nodejs/NodejsStreamInputAdapter"),A=function(L){L.slice(-1)==="/"&&(L=L.substring(0,L.length-1));var X=L.lastIndexOf("/");return 0<X?L.substring(0,X):""},p=function(L){return L.slice(-1)!=="/"&&(L+="/"),L},S=function(L,X){return X=X!==void 0?X:b.createFolders,L=p(L),this.files[L]||l.call(this,L,null,{dir:!0,createFolders:X}),this.files[L]};function k(L){return Object.prototype.toString.call(L)==="[object RegExp]"}var F={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(L){var X,G,Z;for(X in this.files)Z=this.files[X],(G=X.slice(this.root.length,X.length))&&X.slice(0,this.root.length)===this.root&&L(G,Z)},filter:function(L){var X=[];return this.forEach(function(G,Z){L(G,Z)&&X.push(Z)}),X},file:function(L,X,G){if(arguments.length!==1)return L=this.root+L,l.call(this,L,X,G),this;if(k(L)){var Z=L;return this.filter(function(se,ce){return!ce.dir&&Z.test(se)})}var R=this.files[this.root+L];return R&&!R.dir?R:null},folder:function(L){if(!L)return this;if(k(L))return this.filter(function(R,se){return se.dir&&L.test(R)});var X=this.root+L,G=S.call(this,X),Z=this.clone();return Z.root=G.name,Z},remove:function(L){L=this.root+L;var X=this.files[L];if(X||(L.slice(-1)!=="/"&&(L+="/"),X=this.files[L]),X&&!X.dir)delete this.files[L];else for(var G=this.filter(function(R,se){return se.name.slice(0,L.length)===L}),Z=0;Z<G.length;Z++)delete this.files[G[Z].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(L){var X,G={};try{if((G=s.extend(L||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=G.type.toLowerCase(),G.compression=G.compression.toUpperCase(),G.type==="binarystring"&&(G.type="string"),!G.type)throw new Error("No output type specified.");s.checkSupport(G.type),G.platform!=="darwin"&&G.platform!=="freebsd"&&G.platform!=="linux"&&G.platform!=="sunos"||(G.platform="UNIX"),G.platform==="win32"&&(G.platform="DOS");var Z=G.comment||this.comment||"";X=w.generateWorker(this,G,Z)}catch(R){(X=new c("error")).error(R)}return new y(X,G.type||"string",G.mimeType)},generateAsync:function(L,X){return this.generateInternalStream(L).accumulate(X)},generateNodeStream:function(L,X){return(L=L||{}).type||(L.type="nodebuffer"),this.generateInternalStream(L).toNodejsStream(X)}};a.exports=F},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(r,a,u){a.exports=r("stream")},{stream:void 0}],17:[function(r,a,u){var l=r("./DataReader");function o(s){l.call(this,s);for(var c=0;c<this.data.length;c++)s[c]=255&s[c]}r("../utils").inherits(o,l),o.prototype.byteAt=function(s){return this.data[this.zero+s]},o.prototype.lastIndexOfSignature=function(s){for(var c=s.charCodeAt(0),y=s.charCodeAt(1),b=s.charCodeAt(2),T=s.charCodeAt(3),x=this.length-4;0<=x;--x)if(this.data[x]===c&&this.data[x+1]===y&&this.data[x+2]===b&&this.data[x+3]===T)return x-this.zero;return-1},o.prototype.readAndCheckSignature=function(s){var c=s.charCodeAt(0),y=s.charCodeAt(1),b=s.charCodeAt(2),T=s.charCodeAt(3),x=this.readData(4);return c===x[0]&&y===x[1]&&b===x[2]&&T===x[3]},o.prototype.readData=function(s){if(this.checkOffset(s),s===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,c},a.exports=o},{"../utils":32,"./DataReader":18}],18:[function(r,a,u){var l=r("../utils");function o(s){this.data=s,this.length=s.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(s){this.checkIndex(this.index+s)},checkIndex:function(s){if(this.length<this.zero+s||s<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+s+"). Corrupted zip ?")},setIndex:function(s){this.checkIndex(s),this.index=s},skip:function(s){this.setIndex(this.index+s)},byteAt:function(){},readInt:function(s){var c,y=0;for(this.checkOffset(s),c=this.index+s-1;c>=this.index;c--)y=(y<<8)+this.byteAt(c);return this.index+=s,y},readString:function(s){return l.transformTo("string",this.readData(s))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var s=this.readInt(4);return new Date(Date.UTC(1980+(s>>25&127),(s>>21&15)-1,s>>16&31,s>>11&31,s>>5&63,(31&s)<<1))}},a.exports=o},{"../utils":32}],19:[function(r,a,u){var l=r("./Uint8ArrayReader");function o(s){l.call(this,s)}r("../utils").inherits(o,l),o.prototype.readData=function(s){this.checkOffset(s);var c=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,c},a.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(r,a,u){var l=r("./DataReader");function o(s){l.call(this,s)}r("../utils").inherits(o,l),o.prototype.byteAt=function(s){return this.data.charCodeAt(this.zero+s)},o.prototype.lastIndexOfSignature=function(s){return this.data.lastIndexOf(s)-this.zero},o.prototype.readAndCheckSignature=function(s){return s===this.readData(4)},o.prototype.readData=function(s){this.checkOffset(s);var c=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,c},a.exports=o},{"../utils":32,"./DataReader":18}],21:[function(r,a,u){var l=r("./ArrayReader");function o(s){l.call(this,s)}r("../utils").inherits(o,l),o.prototype.readData=function(s){if(this.checkOffset(s),s===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+s);return this.index+=s,c},a.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(r,a,u){var l=r("../utils"),o=r("../support"),s=r("./ArrayReader"),c=r("./StringReader"),y=r("./NodeBufferReader"),b=r("./Uint8ArrayReader");a.exports=function(T){var x=l.getTypeOf(T);return l.checkSupport(x),x!=="string"||o.uint8array?x==="nodebuffer"?new y(T):o.uint8array?new b(l.transformTo("uint8array",T)):new s(l.transformTo("array",T)):new c(T)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(r,a,u){u.LOCAL_FILE_HEADER="PK",u.CENTRAL_FILE_HEADER="PK",u.CENTRAL_DIRECTORY_END="PK",u.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",u.ZIP64_CENTRAL_DIRECTORY_END="PK",u.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(r,a,u){var l=r("./GenericWorker"),o=r("../utils");function s(c){l.call(this,"ConvertWorker to "+c),this.destType=c}o.inherits(s,l),s.prototype.processChunk=function(c){this.push({data:o.transformTo(this.destType,c.data),meta:c.meta})},a.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(r,a,u){var l=r("./GenericWorker"),o=r("../crc32");function s(){l.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}r("../utils").inherits(s,l),s.prototype.processChunk=function(c){this.streamInfo.crc32=o(c.data,this.streamInfo.crc32||0),this.push(c)},a.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(r,a,u){var l=r("../utils"),o=r("./GenericWorker");function s(c){o.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}l.inherits(s,o),s.prototype.processChunk=function(c){if(c){var y=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=y+c.data.length}o.prototype.processChunk.call(this,c)},a.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(r,a,u){var l=r("../utils"),o=r("./GenericWorker");function s(c){o.call(this,"DataWorker");var y=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(b){y.dataIsReady=!0,y.data=b,y.max=b&&b.length||0,y.type=l.getTypeOf(b),y.isPaused||y._tickAndRepeat()},function(b){y.error(b)})}l.inherits(s,o),s.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,l.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(l.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,y=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,y);break;case"uint8array":c=this.data.subarray(this.index,y);break;case"array":case"nodebuffer":c=this.data.slice(this.index,y)}return this.index=y,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},a.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(r,a,u){function l(o){this.name=o||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}l.prototype={push:function(o){this.emit("data",o)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(o){this.emit("error",o)}return!0},error:function(o){return!this.isFinished&&(this.isPaused?this.generatedError=o:(this.isFinished=!0,this.emit("error",o),this.previous&&this.previous.error(o),this.cleanUp()),!0)},on:function(o,s){return this._listeners[o].push(s),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(o,s){if(this._listeners[o])for(var c=0;c<this._listeners[o].length;c++)this._listeners[o][c].call(this,s)},pipe:function(o){return o.registerPrevious(this)},registerPrevious:function(o){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=o.streamInfo,this.mergeStreamInfo(),this.previous=o;var s=this;return o.on("data",function(c){s.processChunk(c)}),o.on("end",function(){s.end()}),o.on("error",function(c){s.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var o=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),o=!0),this.previous&&this.previous.resume(),!o},flush:function(){},processChunk:function(o){this.push(o)},withStreamInfo:function(o,s){return this.extraStreamInfo[o]=s,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var o in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,o)&&(this.streamInfo[o]=this.extraStreamInfo[o])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var o="Worker "+this.name;return this.previous?this.previous+" -> "+o:o}},a.exports=l},{}],29:[function(r,a,u){var l=r("../utils"),o=r("./ConvertWorker"),s=r("./GenericWorker"),c=r("../base64"),y=r("../support"),b=r("../external"),T=null;if(y.nodestream)try{T=r("../nodejs/NodejsStreamOutputAdapter")}catch{}function x(E,v){return new b.Promise(function(A,p){var S=[],k=E._internalType,F=E._outputType,L=E._mimeType;E.on("data",function(X,G){S.push(X),v&&v(G)}).on("error",function(X){S=[],p(X)}).on("end",function(){try{var X=function(G,Z,R){switch(G){case"blob":return l.newBlob(l.transformTo("arraybuffer",Z),R);case"base64":return c.encode(Z);default:return l.transformTo(G,Z)}}(F,function(G,Z){var R,se=0,ce=null,B=0;for(R=0;R<Z.length;R++)B+=Z[R].length;switch(G){case"string":return Z.join("");case"array":return Array.prototype.concat.apply([],Z);case"uint8array":for(ce=new Uint8Array(B),R=0;R<Z.length;R++)ce.set(Z[R],se),se+=Z[R].length;return ce;case"nodebuffer":return Buffer.concat(Z);default:throw new Error("concat : unsupported type '"+G+"'")}}(k,S),L);A(X)}catch(G){p(G)}S=[]}).resume()})}function w(E,v,A){var p=v;switch(v){case"blob":case"arraybuffer":p="uint8array";break;case"base64":p="string"}try{this._internalType=p,this._outputType=v,this._mimeType=A,l.checkSupport(p),this._worker=E.pipe(new o(p)),E.lock()}catch(S){this._worker=new s("error"),this._worker.error(S)}}w.prototype={accumulate:function(E){return x(this,E)},on:function(E,v){var A=this;return E==="data"?this._worker.on(E,function(p){v.call(A,p.data,p.meta)}):this._worker.on(E,function(){l.delay(v,arguments,A)}),this},resume:function(){return l.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(E){if(l.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new T(this,{objectMode:this._outputType!=="nodebuffer"},E)}},a.exports=w},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(r,a,u){if(u.base64=!0,u.array=!0,u.string=!0,u.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",u.nodebuffer=typeof Buffer<"u",u.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")u.blob=!1;else{var l=new ArrayBuffer(0);try{u.blob=new Blob([l],{type:"application/zip"}).size===0}catch{try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);o.append(l),u.blob=o.getBlob("application/zip").size===0}catch{u.blob=!1}}}try{u.nodestream=!!r("readable-stream").Readable}catch{u.nodestream=!1}},{"readable-stream":16}],31:[function(r,a,u){for(var l=r("./utils"),o=r("./support"),s=r("./nodejsUtils"),c=r("./stream/GenericWorker"),y=new Array(256),b=0;b<256;b++)y[b]=252<=b?6:248<=b?5:240<=b?4:224<=b?3:192<=b?2:1;y[254]=y[254]=1;function T(){c.call(this,"utf-8 decode"),this.leftOver=null}function x(){c.call(this,"utf-8 encode")}u.utf8encode=function(w){return o.nodebuffer?s.newBufferFrom(w,"utf-8"):function(E){var v,A,p,S,k,F=E.length,L=0;for(S=0;S<F;S++)(64512&(A=E.charCodeAt(S)))==55296&&S+1<F&&(64512&(p=E.charCodeAt(S+1)))==56320&&(A=65536+(A-55296<<10)+(p-56320),S++),L+=A<128?1:A<2048?2:A<65536?3:4;for(v=o.uint8array?new Uint8Array(L):new Array(L),S=k=0;k<L;S++)(64512&(A=E.charCodeAt(S)))==55296&&S+1<F&&(64512&(p=E.charCodeAt(S+1)))==56320&&(A=65536+(A-55296<<10)+(p-56320),S++),A<128?v[k++]=A:(A<2048?v[k++]=192|A>>>6:(A<65536?v[k++]=224|A>>>12:(v[k++]=240|A>>>18,v[k++]=128|A>>>12&63),v[k++]=128|A>>>6&63),v[k++]=128|63&A);return v}(w)},u.utf8decode=function(w){return o.nodebuffer?l.transformTo("nodebuffer",w).toString("utf-8"):function(E){var v,A,p,S,k=E.length,F=new Array(2*k);for(v=A=0;v<k;)if((p=E[v++])<128)F[A++]=p;else if(4<(S=y[p]))F[A++]=65533,v+=S-1;else{for(p&=S===2?31:S===3?15:7;1<S&&v<k;)p=p<<6|63&E[v++],S--;1<S?F[A++]=65533:p<65536?F[A++]=p:(p-=65536,F[A++]=55296|p>>10&1023,F[A++]=56320|1023&p)}return F.length!==A&&(F.subarray?F=F.subarray(0,A):F.length=A),l.applyFromCharCode(F)}(w=l.transformTo(o.uint8array?"uint8array":"array",w))},l.inherits(T,c),T.prototype.processChunk=function(w){var E=l.transformTo(o.uint8array?"uint8array":"array",w.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var v=E;(E=new Uint8Array(v.length+this.leftOver.length)).set(this.leftOver,0),E.set(v,this.leftOver.length)}else E=this.leftOver.concat(E);this.leftOver=null}var A=function(S,k){var F;for((k=k||S.length)>S.length&&(k=S.length),F=k-1;0<=F&&(192&S[F])==128;)F--;return F<0||F===0?k:F+y[S[F]]>k?F:k}(E),p=E;A!==E.length&&(o.uint8array?(p=E.subarray(0,A),this.leftOver=E.subarray(A,E.length)):(p=E.slice(0,A),this.leftOver=E.slice(A,E.length))),this.push({data:u.utf8decode(p),meta:w.meta})},T.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:u.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},u.Utf8DecodeWorker=T,l.inherits(x,c),x.prototype.processChunk=function(w){this.push({data:u.utf8encode(w.data),meta:w.meta})},u.Utf8EncodeWorker=x},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(r,a,u){var l=r("./support"),o=r("./base64"),s=r("./nodejsUtils"),c=r("./external");function y(v){return v}function b(v,A){for(var p=0;p<v.length;++p)A[p]=255&v.charCodeAt(p);return A}r("setimmediate"),u.newBlob=function(v,A){u.checkSupport("blob");try{return new Blob([v],{type:A})}catch{try{var p=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return p.append(v),p.getBlob(A)}catch{throw new Error("Bug : can't construct the Blob.")}}};var T={stringifyByChunk:function(v,A,p){var S=[],k=0,F=v.length;if(F<=p)return String.fromCharCode.apply(null,v);for(;k<F;)A==="array"||A==="nodebuffer"?S.push(String.fromCharCode.apply(null,v.slice(k,Math.min(k+p,F)))):S.push(String.fromCharCode.apply(null,v.subarray(k,Math.min(k+p,F)))),k+=p;return S.join("")},stringifyByChar:function(v){for(var A="",p=0;p<v.length;p++)A+=String.fromCharCode(v[p]);return A},applyCanBeUsed:{uint8array:function(){try{return l.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return l.nodebuffer&&String.fromCharCode.apply(null,s.allocBuffer(1)).length===1}catch{return!1}}()}};function x(v){var A=65536,p=u.getTypeOf(v),S=!0;if(p==="uint8array"?S=T.applyCanBeUsed.uint8array:p==="nodebuffer"&&(S=T.applyCanBeUsed.nodebuffer),S)for(;1<A;)try{return T.stringifyByChunk(v,p,A)}catch{A=Math.floor(A/2)}return T.stringifyByChar(v)}function w(v,A){for(var p=0;p<v.length;p++)A[p]=v[p];return A}u.applyFromCharCode=x;var E={};E.string={string:y,array:function(v){return b(v,new Array(v.length))},arraybuffer:function(v){return E.string.uint8array(v).buffer},uint8array:function(v){return b(v,new Uint8Array(v.length))},nodebuffer:function(v){return b(v,s.allocBuffer(v.length))}},E.array={string:x,array:y,arraybuffer:function(v){return new Uint8Array(v).buffer},uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return s.newBufferFrom(v)}},E.arraybuffer={string:function(v){return x(new Uint8Array(v))},array:function(v){return w(new Uint8Array(v),new Array(v.byteLength))},arraybuffer:y,uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return s.newBufferFrom(new Uint8Array(v))}},E.uint8array={string:x,array:function(v){return w(v,new Array(v.length))},arraybuffer:function(v){return v.buffer},uint8array:y,nodebuffer:function(v){return s.newBufferFrom(v)}},E.nodebuffer={string:x,array:function(v){return w(v,new Array(v.length))},arraybuffer:function(v){return E.nodebuffer.uint8array(v).buffer},uint8array:function(v){return w(v,new Uint8Array(v.length))},nodebuffer:y},u.transformTo=function(v,A){if(A=A||"",!v)return A;u.checkSupport(v);var p=u.getTypeOf(A);return E[p][v](A)},u.resolve=function(v){for(var A=v.split("/"),p=[],S=0;S<A.length;S++){var k=A[S];k==="."||k===""&&S!==0&&S!==A.length-1||(k===".."?p.pop():p.push(k))}return p.join("/")},u.getTypeOf=function(v){return typeof v=="string"?"string":Object.prototype.toString.call(v)==="[object Array]"?"array":l.nodebuffer&&s.isBuffer(v)?"nodebuffer":l.uint8array&&v instanceof Uint8Array?"uint8array":l.arraybuffer&&v instanceof ArrayBuffer?"arraybuffer":void 0},u.checkSupport=function(v){if(!l[v.toLowerCase()])throw new Error(v+" is not supported by this platform")},u.MAX_VALUE_16BITS=65535,u.MAX_VALUE_32BITS=-1,u.pretty=function(v){var A,p,S="";for(p=0;p<(v||"").length;p++)S+="\\x"+((A=v.charCodeAt(p))<16?"0":"")+A.toString(16).toUpperCase();return S},u.delay=function(v,A,p){setImmediate(function(){v.apply(p||null,A||[])})},u.inherits=function(v,A){function p(){}p.prototype=A.prototype,v.prototype=new p},u.extend=function(){var v,A,p={};for(v=0;v<arguments.length;v++)for(A in arguments[v])Object.prototype.hasOwnProperty.call(arguments[v],A)&&p[A]===void 0&&(p[A]=arguments[v][A]);return p},u.prepareContent=function(v,A,p,S,k){return c.Promise.resolve(A).then(function(F){return l.blob&&(F instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(F))!==-1)&&typeof FileReader<"u"?new c.Promise(function(L,X){var G=new FileReader;G.onload=function(Z){L(Z.target.result)},G.onerror=function(Z){X(Z.target.error)},G.readAsArrayBuffer(F)}):F}).then(function(F){var L=u.getTypeOf(F);return L?(L==="arraybuffer"?F=u.transformTo("uint8array",F):L==="string"&&(k?F=o.decode(F):p&&S!==!0&&(F=function(X){return b(X,l.uint8array?new Uint8Array(X.length):new Array(X.length))}(F))),F):c.Promise.reject(new Error("Can't read the data of '"+v+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(r,a,u){var l=r("./reader/readerFor"),o=r("./utils"),s=r("./signature"),c=r("./zipEntry"),y=r("./support");function b(T){this.files=[],this.loadOptions=T}b.prototype={checkSignature:function(T){if(!this.reader.readAndCheckSignature(T)){this.reader.index-=4;var x=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(x)+", expected "+o.pretty(T)+")")}},isSignature:function(T,x){var w=this.reader.index;this.reader.setIndex(T);var E=this.reader.readString(4)===x;return this.reader.setIndex(w),E},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var T=this.reader.readData(this.zipCommentLength),x=y.uint8array?"uint8array":"array",w=o.transformTo(x,T);this.zipComment=this.loadOptions.decodeFileName(w)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var T,x,w,E=this.zip64EndOfCentralSize-44;0<E;)T=this.reader.readInt(2),x=this.reader.readInt(4),w=this.reader.readData(x),this.zip64ExtensibleData[T]={id:T,length:x,value:w}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var T,x;for(T=0;T<this.files.length;T++)x=this.files[T],this.reader.setIndex(x.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),x.readLocalPart(this.reader),x.handleUTF8(),x.processAttributes()},readCentralDir:function(){var T;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(T=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(T);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var T=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(T<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(T);var x=T;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,(T=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(T),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var w=this.centralDirOffset+this.centralDirSize;this.zip64&&(w+=20,w+=12+this.zip64EndOfCentralSize);var E=x-w;if(0<E)this.isSignature(x,s.CENTRAL_FILE_HEADER)||(this.reader.zero=E);else if(E<0)throw new Error("Corrupted zip: missing "+Math.abs(E)+" bytes.")},prepareReader:function(T){this.reader=l(T)},load:function(T){this.prepareReader(T),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},a.exports=b},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(r,a,u){var l=r("./reader/readerFor"),o=r("./utils"),s=r("./compressedObject"),c=r("./crc32"),y=r("./utf8"),b=r("./compressions"),T=r("./support");function x(w,E){this.options=w,this.loadOptions=E}x.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(w){var E,v;if(w.skip(22),this.fileNameLength=w.readInt(2),v=w.readInt(2),this.fileName=w.readData(this.fileNameLength),w.skip(v),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((E=function(A){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p)&&b[p].magic===A)return b[p];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,E,w.readData(this.compressedSize))},readCentralPart:function(w){this.versionMadeBy=w.readInt(2),w.skip(2),this.bitFlag=w.readInt(2),this.compressionMethod=w.readString(2),this.date=w.readDate(),this.crc32=w.readInt(4),this.compressedSize=w.readInt(4),this.uncompressedSize=w.readInt(4);var E=w.readInt(2);if(this.extraFieldsLength=w.readInt(2),this.fileCommentLength=w.readInt(2),this.diskNumberStart=w.readInt(2),this.internalFileAttributes=w.readInt(2),this.externalFileAttributes=w.readInt(4),this.localHeaderOffset=w.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");w.skip(E),this.readExtraFields(w),this.parseZIP64ExtraField(w),this.fileComment=w.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var w=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),w==0&&(this.dosPermissions=63&this.externalFileAttributes),w==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var w=l(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=w.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=w.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=w.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=w.readInt(4))}},readExtraFields:function(w){var E,v,A,p=w.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});w.index+4<p;)E=w.readInt(2),v=w.readInt(2),A=w.readData(v),this.extraFields[E]={id:E,length:v,value:A};w.setIndex(p)},handleUTF8:function(){var w=T.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=y.utf8decode(this.fileName),this.fileCommentStr=y.utf8decode(this.fileComment);else{var E=this.findExtraFieldUnicodePath();if(E!==null)this.fileNameStr=E;else{var v=o.transformTo(w,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(v)}var A=this.findExtraFieldUnicodeComment();if(A!==null)this.fileCommentStr=A;else{var p=o.transformTo(w,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(p)}}},findExtraFieldUnicodePath:function(){var w=this.extraFields[28789];if(w){var E=l(w.value);return E.readInt(1)!==1||c(this.fileName)!==E.readInt(4)?null:y.utf8decode(E.readData(w.length-5))}return null},findExtraFieldUnicodeComment:function(){var w=this.extraFields[25461];if(w){var E=l(w.value);return E.readInt(1)!==1||c(this.fileComment)!==E.readInt(4)?null:y.utf8decode(E.readData(w.length-5))}return null}},a.exports=x},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(r,a,u){function l(E,v,A){this.name=E,this.dir=A.dir,this.date=A.date,this.comment=A.comment,this.unixPermissions=A.unixPermissions,this.dosPermissions=A.dosPermissions,this._data=v,this._dataBinary=A.binary,this.options={compression:A.compression,compressionOptions:A.compressionOptions}}var o=r("./stream/StreamHelper"),s=r("./stream/DataWorker"),c=r("./utf8"),y=r("./compressedObject"),b=r("./stream/GenericWorker");l.prototype={internalStream:function(E){var v=null,A="string";try{if(!E)throw new Error("No output type specified.");var p=(A=E.toLowerCase())==="string"||A==="text";A!=="binarystring"&&A!=="text"||(A="string"),v=this._decompressWorker();var S=!this._dataBinary;S&&!p&&(v=v.pipe(new c.Utf8EncodeWorker)),!S&&p&&(v=v.pipe(new c.Utf8DecodeWorker))}catch(k){(v=new b("error")).error(k)}return new o(v,A,"")},async:function(E,v){return this.internalStream(E).accumulate(v)},nodeStream:function(E,v){return this.internalStream(E||"nodebuffer").toNodejsStream(v)},_compressWorker:function(E,v){if(this._data instanceof y&&this._data.compression.magic===E.magic)return this._data.getCompressedWorker();var A=this._decompressWorker();return this._dataBinary||(A=A.pipe(new c.Utf8EncodeWorker)),y.createWorkerFrom(A,E,v)},_decompressWorker:function(){return this._data instanceof y?this._data.getContentWorker():this._data instanceof b?this._data:new s(this._data)}};for(var T=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],x=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},w=0;w<T.length;w++)l.prototype[T[w]]=x;a.exports=l},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(r,a,u){(function(l){var o,s,c=l.MutationObserver||l.WebKitMutationObserver;if(c){var y=0,b=new c(E),T=l.document.createTextNode("");b.observe(T,{characterData:!0}),o=function(){T.data=y=++y%2}}else if(l.setImmediate||l.MessageChannel===void 0)o="document"in l&&"onreadystatechange"in l.document.createElement("script")?function(){var v=l.document.createElement("script");v.onreadystatechange=function(){E(),v.onreadystatechange=null,v.parentNode.removeChild(v),v=null},l.document.documentElement.appendChild(v)}:function(){setTimeout(E,0)};else{var x=new l.MessageChannel;x.port1.onmessage=E,o=function(){x.port2.postMessage(0)}}var w=[];function E(){var v,A;s=!0;for(var p=w.length;p;){for(A=w,w=[],v=-1;++v<p;)A[v]();p=w.length}s=!1}a.exports=function(v){w.push(v)!==1||s||o()}}).call(this,typeof Ge<"u"?Ge:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(r,a,u){var l=r("immediate");function o(){}var s={},c=["REJECTED"],y=["FULFILLED"],b=["PENDING"];function T(p){if(typeof p!="function")throw new TypeError("resolver must be a function");this.state=b,this.queue=[],this.outcome=void 0,p!==o&&v(this,p)}function x(p,S,k){this.promise=p,typeof S=="function"&&(this.onFulfilled=S,this.callFulfilled=this.otherCallFulfilled),typeof k=="function"&&(this.onRejected=k,this.callRejected=this.otherCallRejected)}function w(p,S,k){l(function(){var F;try{F=S(k)}catch(L){return s.reject(p,L)}F===p?s.reject(p,new TypeError("Cannot resolve promise with itself")):s.resolve(p,F)})}function E(p){var S=p&&p.then;if(p&&(typeof p=="object"||typeof p=="function")&&typeof S=="function")return function(){S.apply(p,arguments)}}function v(p,S){var k=!1;function F(G){k||(k=!0,s.reject(p,G))}function L(G){k||(k=!0,s.resolve(p,G))}var X=A(function(){S(L,F)});X.status==="error"&&F(X.value)}function A(p,S){var k={};try{k.value=p(S),k.status="success"}catch(F){k.status="error",k.value=F}return k}(a.exports=T).prototype.finally=function(p){if(typeof p!="function")return this;var S=this.constructor;return this.then(function(k){return S.resolve(p()).then(function(){return k})},function(k){return S.resolve(p()).then(function(){throw k})})},T.prototype.catch=function(p){return this.then(null,p)},T.prototype.then=function(p,S){if(typeof p!="function"&&this.state===y||typeof S!="function"&&this.state===c)return this;var k=new this.constructor(o);return this.state!==b?w(k,this.state===y?p:S,this.outcome):this.queue.push(new x(k,p,S)),k},x.prototype.callFulfilled=function(p){s.resolve(this.promise,p)},x.prototype.otherCallFulfilled=function(p){w(this.promise,this.onFulfilled,p)},x.prototype.callRejected=function(p){s.reject(this.promise,p)},x.prototype.otherCallRejected=function(p){w(this.promise,this.onRejected,p)},s.resolve=function(p,S){var k=A(E,S);if(k.status==="error")return s.reject(p,k.value);var F=k.value;if(F)v(p,F);else{p.state=y,p.outcome=S;for(var L=-1,X=p.queue.length;++L<X;)p.queue[L].callFulfilled(S)}return p},s.reject=function(p,S){p.state=c,p.outcome=S;for(var k=-1,F=p.queue.length;++k<F;)p.queue[k].callRejected(S);return p},T.resolve=function(p){return p instanceof this?p:s.resolve(new this(o),p)},T.reject=function(p){var S=new this(o);return s.reject(S,p)},T.all=function(p){var S=this;if(Object.prototype.toString.call(p)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=p.length,F=!1;if(!k)return this.resolve([]);for(var L=new Array(k),X=0,G=-1,Z=new this(o);++G<k;)R(p[G],G);return Z;function R(se,ce){S.resolve(se).then(function(B){L[ce]=B,++X!==k||F||(F=!0,s.resolve(Z,L))},function(B){F||(F=!0,s.reject(Z,B))})}},T.race=function(p){var S=this;if(Object.prototype.toString.call(p)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=p.length,F=!1;if(!k)return this.resolve([]);for(var L=-1,X=new this(o);++L<k;)G=p[L],S.resolve(G).then(function(Z){F||(F=!0,s.resolve(X,Z))},function(Z){F||(F=!0,s.reject(X,Z))});var G;return X}},{immediate:36}],38:[function(r,a,u){var l={};(0,r("./lib/utils/common").assign)(l,r("./lib/deflate"),r("./lib/inflate"),r("./lib/zlib/constants")),a.exports=l},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(r,a,u){var l=r("./zlib/deflate"),o=r("./utils/common"),s=r("./utils/strings"),c=r("./zlib/messages"),y=r("./zlib/zstream"),b=Object.prototype.toString,T=0,x=-1,w=0,E=8;function v(p){if(!(this instanceof v))return new v(p);this.options=o.assign({level:x,method:E,chunkSize:16384,windowBits:15,memLevel:8,strategy:w,to:""},p||{});var S=this.options;S.raw&&0<S.windowBits?S.windowBits=-S.windowBits:S.gzip&&0<S.windowBits&&S.windowBits<16&&(S.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new y,this.strm.avail_out=0;var k=l.deflateInit2(this.strm,S.level,S.method,S.windowBits,S.memLevel,S.strategy);if(k!==T)throw new Error(c[k]);if(S.header&&l.deflateSetHeader(this.strm,S.header),S.dictionary){var F;if(F=typeof S.dictionary=="string"?s.string2buf(S.dictionary):b.call(S.dictionary)==="[object ArrayBuffer]"?new Uint8Array(S.dictionary):S.dictionary,(k=l.deflateSetDictionary(this.strm,F))!==T)throw new Error(c[k]);this._dict_set=!0}}function A(p,S){var k=new v(S);if(k.push(p,!0),k.err)throw k.msg||c[k.err];return k.result}v.prototype.push=function(p,S){var k,F,L=this.strm,X=this.options.chunkSize;if(this.ended)return!1;F=S===~~S?S:S===!0?4:0,typeof p=="string"?L.input=s.string2buf(p):b.call(p)==="[object ArrayBuffer]"?L.input=new Uint8Array(p):L.input=p,L.next_in=0,L.avail_in=L.input.length;do{if(L.avail_out===0&&(L.output=new o.Buf8(X),L.next_out=0,L.avail_out=X),(k=l.deflate(L,F))!==1&&k!==T)return this.onEnd(k),!(this.ended=!0);L.avail_out!==0&&(L.avail_in!==0||F!==4&&F!==2)||(this.options.to==="string"?this.onData(s.buf2binstring(o.shrinkBuf(L.output,L.next_out))):this.onData(o.shrinkBuf(L.output,L.next_out)))}while((0<L.avail_in||L.avail_out===0)&&k!==1);return F===4?(k=l.deflateEnd(this.strm),this.onEnd(k),this.ended=!0,k===T):F!==2||(this.onEnd(T),!(L.avail_out=0))},v.prototype.onData=function(p){this.chunks.push(p)},v.prototype.onEnd=function(p){p===T&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=p,this.msg=this.strm.msg},u.Deflate=v,u.deflate=A,u.deflateRaw=function(p,S){return(S=S||{}).raw=!0,A(p,S)},u.gzip=function(p,S){return(S=S||{}).gzip=!0,A(p,S)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(r,a,u){var l=r("./zlib/inflate"),o=r("./utils/common"),s=r("./utils/strings"),c=r("./zlib/constants"),y=r("./zlib/messages"),b=r("./zlib/zstream"),T=r("./zlib/gzheader"),x=Object.prototype.toString;function w(v){if(!(this instanceof w))return new w(v);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},v||{});var A=this.options;A.raw&&0<=A.windowBits&&A.windowBits<16&&(A.windowBits=-A.windowBits,A.windowBits===0&&(A.windowBits=-15)),!(0<=A.windowBits&&A.windowBits<16)||v&&v.windowBits||(A.windowBits+=32),15<A.windowBits&&A.windowBits<48&&!(15&A.windowBits)&&(A.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new b,this.strm.avail_out=0;var p=l.inflateInit2(this.strm,A.windowBits);if(p!==c.Z_OK)throw new Error(y[p]);this.header=new T,l.inflateGetHeader(this.strm,this.header)}function E(v,A){var p=new w(A);if(p.push(v,!0),p.err)throw p.msg||y[p.err];return p.result}w.prototype.push=function(v,A){var p,S,k,F,L,X,G=this.strm,Z=this.options.chunkSize,R=this.options.dictionary,se=!1;if(this.ended)return!1;S=A===~~A?A:A===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof v=="string"?G.input=s.binstring2buf(v):x.call(v)==="[object ArrayBuffer]"?G.input=new Uint8Array(v):G.input=v,G.next_in=0,G.avail_in=G.input.length;do{if(G.avail_out===0&&(G.output=new o.Buf8(Z),G.next_out=0,G.avail_out=Z),(p=l.inflate(G,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&R&&(X=typeof R=="string"?s.string2buf(R):x.call(R)==="[object ArrayBuffer]"?new Uint8Array(R):R,p=l.inflateSetDictionary(this.strm,X)),p===c.Z_BUF_ERROR&&se===!0&&(p=c.Z_OK,se=!1),p!==c.Z_STREAM_END&&p!==c.Z_OK)return this.onEnd(p),!(this.ended=!0);G.next_out&&(G.avail_out!==0&&p!==c.Z_STREAM_END&&(G.avail_in!==0||S!==c.Z_FINISH&&S!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(k=s.utf8border(G.output,G.next_out),F=G.next_out-k,L=s.buf2string(G.output,k),G.next_out=F,G.avail_out=Z-F,F&&o.arraySet(G.output,G.output,k,F,0),this.onData(L)):this.onData(o.shrinkBuf(G.output,G.next_out)))),G.avail_in===0&&G.avail_out===0&&(se=!0)}while((0<G.avail_in||G.avail_out===0)&&p!==c.Z_STREAM_END);return p===c.Z_STREAM_END&&(S=c.Z_FINISH),S===c.Z_FINISH?(p=l.inflateEnd(this.strm),this.onEnd(p),this.ended=!0,p===c.Z_OK):S!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(G.avail_out=0))},w.prototype.onData=function(v){this.chunks.push(v)},w.prototype.onEnd=function(v){v===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},u.Inflate=w,u.inflate=E,u.inflateRaw=function(v,A){return(A=A||{}).raw=!0,E(v,A)},u.ungzip=E},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(r,a,u){var l=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";u.assign=function(c){for(var y=Array.prototype.slice.call(arguments,1);y.length;){var b=y.shift();if(b){if(typeof b!="object")throw new TypeError(b+"must be non-object");for(var T in b)b.hasOwnProperty(T)&&(c[T]=b[T])}}return c},u.shrinkBuf=function(c,y){return c.length===y?c:c.subarray?c.subarray(0,y):(c.length=y,c)};var o={arraySet:function(c,y,b,T,x){if(y.subarray&&c.subarray)c.set(y.subarray(b,b+T),x);else for(var w=0;w<T;w++)c[x+w]=y[b+w]},flattenChunks:function(c){var y,b,T,x,w,E;for(y=T=0,b=c.length;y<b;y++)T+=c[y].length;for(E=new Uint8Array(T),y=x=0,b=c.length;y<b;y++)w=c[y],E.set(w,x),x+=w.length;return E}},s={arraySet:function(c,y,b,T,x){for(var w=0;w<T;w++)c[x+w]=y[b+w]},flattenChunks:function(c){return[].concat.apply([],c)}};u.setTyped=function(c){c?(u.Buf8=Uint8Array,u.Buf16=Uint16Array,u.Buf32=Int32Array,u.assign(u,o)):(u.Buf8=Array,u.Buf16=Array,u.Buf32=Array,u.assign(u,s))},u.setTyped(l)},{}],42:[function(r,a,u){var l=r("./common"),o=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{s=!1}for(var c=new l.Buf8(256),y=0;y<256;y++)c[y]=252<=y?6:248<=y?5:240<=y?4:224<=y?3:192<=y?2:1;function b(T,x){if(x<65537&&(T.subarray&&s||!T.subarray&&o))return String.fromCharCode.apply(null,l.shrinkBuf(T,x));for(var w="",E=0;E<x;E++)w+=String.fromCharCode(T[E]);return w}c[254]=c[254]=1,u.string2buf=function(T){var x,w,E,v,A,p=T.length,S=0;for(v=0;v<p;v++)(64512&(w=T.charCodeAt(v)))==55296&&v+1<p&&(64512&(E=T.charCodeAt(v+1)))==56320&&(w=65536+(w-55296<<10)+(E-56320),v++),S+=w<128?1:w<2048?2:w<65536?3:4;for(x=new l.Buf8(S),v=A=0;A<S;v++)(64512&(w=T.charCodeAt(v)))==55296&&v+1<p&&(64512&(E=T.charCodeAt(v+1)))==56320&&(w=65536+(w-55296<<10)+(E-56320),v++),w<128?x[A++]=w:(w<2048?x[A++]=192|w>>>6:(w<65536?x[A++]=224|w>>>12:(x[A++]=240|w>>>18,x[A++]=128|w>>>12&63),x[A++]=128|w>>>6&63),x[A++]=128|63&w);return x},u.buf2binstring=function(T){return b(T,T.length)},u.binstring2buf=function(T){for(var x=new l.Buf8(T.length),w=0,E=x.length;w<E;w++)x[w]=T.charCodeAt(w);return x},u.buf2string=function(T,x){var w,E,v,A,p=x||T.length,S=new Array(2*p);for(w=E=0;w<p;)if((v=T[w++])<128)S[E++]=v;else if(4<(A=c[v]))S[E++]=65533,w+=A-1;else{for(v&=A===2?31:A===3?15:7;1<A&&w<p;)v=v<<6|63&T[w++],A--;1<A?S[E++]=65533:v<65536?S[E++]=v:(v-=65536,S[E++]=55296|v>>10&1023,S[E++]=56320|1023&v)}return b(S,E)},u.utf8border=function(T,x){var w;for((x=x||T.length)>T.length&&(x=T.length),w=x-1;0<=w&&(192&T[w])==128;)w--;return w<0||w===0?x:w+c[T[w]]>x?w:x}},{"./common":41}],43:[function(r,a,u){a.exports=function(l,o,s,c){for(var y=65535&l|0,b=l>>>16&65535|0,T=0;s!==0;){for(s-=T=2e3<s?2e3:s;b=b+(y=y+o[c++]|0)|0,--T;);y%=65521,b%=65521}return y|b<<16|0}},{}],44:[function(r,a,u){a.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(r,a,u){var l=function(){for(var o,s=[],c=0;c<256;c++){o=c;for(var y=0;y<8;y++)o=1&o?3988292384^o>>>1:o>>>1;s[c]=o}return s}();a.exports=function(o,s,c,y){var b=l,T=y+c;o^=-1;for(var x=y;x<T;x++)o=o>>>8^b[255&(o^s[x])];return-1^o}},{}],46:[function(r,a,u){var l,o=r("../utils/common"),s=r("./trees"),c=r("./adler32"),y=r("./crc32"),b=r("./messages"),T=0,x=4,w=0,E=-2,v=-1,A=4,p=2,S=8,k=9,F=286,L=30,X=19,G=2*F+1,Z=15,R=3,se=258,ce=se+R+1,B=42,K=113,_=1,$=2,le=3,V=4;function de(d,q){return d.msg=b[q],q}function ee(d){return(d<<1)-(4<d?9:0)}function fe(d){for(var q=d.length;0<=--q;)d[q]=0}function W(d){var q=d.state,g=q.pending;g>d.avail_out&&(g=d.avail_out),g!==0&&(o.arraySet(d.output,q.pending_buf,q.pending_out,g,d.next_out),d.next_out+=g,q.pending_out+=g,d.total_out+=g,d.avail_out-=g,q.pending-=g,q.pending===0&&(q.pending_out=0))}function C(d,q){s._tr_flush_block(d,0<=d.block_start?d.block_start:-1,d.strstart-d.block_start,q),d.block_start=d.strstart,W(d.strm)}function z(d,q){d.pending_buf[d.pending++]=q}function H(d,q){d.pending_buf[d.pending++]=q>>>8&255,d.pending_buf[d.pending++]=255&q}function Q(d,q){var g,n,i=d.max_chain_length,f=d.strstart,O=d.prev_length,U=d.nice_match,P=d.strstart>d.w_size-ce?d.strstart-(d.w_size-ce):0,te=d.window,oe=d.w_mask,ie=d.prev,ue=d.strstart+se,he=te[f+O-1],me=te[f+O];d.prev_length>=d.good_match&&(i>>=2),U>d.lookahead&&(U=d.lookahead);do if(te[(g=q)+O]===me&&te[g+O-1]===he&&te[g]===te[f]&&te[++g]===te[f+1]){f+=2,g++;do;while(te[++f]===te[++g]&&te[++f]===te[++g]&&te[++f]===te[++g]&&te[++f]===te[++g]&&te[++f]===te[++g]&&te[++f]===te[++g]&&te[++f]===te[++g]&&te[++f]===te[++g]&&f<ue);if(n=se-(ue-f),f=ue-se,O<n){if(d.match_start=q,U<=(O=n))break;he=te[f+O-1],me=te[f+O]}}while((q=ie[q&oe])>P&&--i!=0);return O<=d.lookahead?O:d.lookahead}function j(d){var q,g,n,i,f,O,U,P,te,oe,ie=d.w_size;do{if(i=d.window_size-d.lookahead-d.strstart,d.strstart>=ie+(ie-ce)){for(o.arraySet(d.window,d.window,ie,ie,0),d.match_start-=ie,d.strstart-=ie,d.block_start-=ie,q=g=d.hash_size;n=d.head[--q],d.head[q]=ie<=n?n-ie:0,--g;);for(q=g=ie;n=d.prev[--q],d.prev[q]=ie<=n?n-ie:0,--g;);i+=ie}if(d.strm.avail_in===0)break;if(O=d.strm,U=d.window,P=d.strstart+d.lookahead,te=i,oe=void 0,oe=O.avail_in,te<oe&&(oe=te),g=oe===0?0:(O.avail_in-=oe,o.arraySet(U,O.input,O.next_in,oe,P),O.state.wrap===1?O.adler=c(O.adler,U,oe,P):O.state.wrap===2&&(O.adler=y(O.adler,U,oe,P)),O.next_in+=oe,O.total_in+=oe,oe),d.lookahead+=g,d.lookahead+d.insert>=R)for(f=d.strstart-d.insert,d.ins_h=d.window[f],d.ins_h=(d.ins_h<<d.hash_shift^d.window[f+1])&d.hash_mask;d.insert&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[f+R-1])&d.hash_mask,d.prev[f&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=f,f++,d.insert--,!(d.lookahead+d.insert<R)););}while(d.lookahead<ce&&d.strm.avail_in!==0)}function m(d,q){for(var g,n;;){if(d.lookahead<ce){if(j(d),d.lookahead<ce&&q===T)return _;if(d.lookahead===0)break}if(g=0,d.lookahead>=R&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+R-1])&d.hash_mask,g=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart),g!==0&&d.strstart-g<=d.w_size-ce&&(d.match_length=Q(d,g)),d.match_length>=R)if(n=s._tr_tally(d,d.strstart-d.match_start,d.match_length-R),d.lookahead-=d.match_length,d.match_length<=d.max_lazy_match&&d.lookahead>=R){for(d.match_length--;d.strstart++,d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+R-1])&d.hash_mask,g=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart,--d.match_length!=0;);d.strstart++}else d.strstart+=d.match_length,d.match_length=0,d.ins_h=d.window[d.strstart],d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+1])&d.hash_mask;else n=s._tr_tally(d,0,d.window[d.strstart]),d.lookahead--,d.strstart++;if(n&&(C(d,!1),d.strm.avail_out===0))return _}return d.insert=d.strstart<R-1?d.strstart:R-1,q===x?(C(d,!0),d.strm.avail_out===0?le:V):d.last_lit&&(C(d,!1),d.strm.avail_out===0)?_:$}function h(d,q){for(var g,n,i;;){if(d.lookahead<ce){if(j(d),d.lookahead<ce&&q===T)return _;if(d.lookahead===0)break}if(g=0,d.lookahead>=R&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+R-1])&d.hash_mask,g=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart),d.prev_length=d.match_length,d.prev_match=d.match_start,d.match_length=R-1,g!==0&&d.prev_length<d.max_lazy_match&&d.strstart-g<=d.w_size-ce&&(d.match_length=Q(d,g),d.match_length<=5&&(d.strategy===1||d.match_length===R&&4096<d.strstart-d.match_start)&&(d.match_length=R-1)),d.prev_length>=R&&d.match_length<=d.prev_length){for(i=d.strstart+d.lookahead-R,n=s._tr_tally(d,d.strstart-1-d.prev_match,d.prev_length-R),d.lookahead-=d.prev_length-1,d.prev_length-=2;++d.strstart<=i&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+R-1])&d.hash_mask,g=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart),--d.prev_length!=0;);if(d.match_available=0,d.match_length=R-1,d.strstart++,n&&(C(d,!1),d.strm.avail_out===0))return _}else if(d.match_available){if((n=s._tr_tally(d,0,d.window[d.strstart-1]))&&C(d,!1),d.strstart++,d.lookahead--,d.strm.avail_out===0)return _}else d.match_available=1,d.strstart++,d.lookahead--}return d.match_available&&(n=s._tr_tally(d,0,d.window[d.strstart-1]),d.match_available=0),d.insert=d.strstart<R-1?d.strstart:R-1,q===x?(C(d,!0),d.strm.avail_out===0?le:V):d.last_lit&&(C(d,!1),d.strm.avail_out===0)?_:$}function M(d,q,g,n,i){this.good_length=d,this.max_lazy=q,this.nice_length=g,this.max_chain=n,this.func=i}function D(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=S,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(2*G),this.dyn_dtree=new o.Buf16(2*(2*L+1)),this.bl_tree=new o.Buf16(2*(2*X+1)),fe(this.dyn_ltree),fe(this.dyn_dtree),fe(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(Z+1),this.heap=new o.Buf16(2*F+1),fe(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*F+1),fe(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function I(d){var q;return d&&d.state?(d.total_in=d.total_out=0,d.data_type=p,(q=d.state).pending=0,q.pending_out=0,q.wrap<0&&(q.wrap=-q.wrap),q.status=q.wrap?B:K,d.adler=q.wrap===2?0:1,q.last_flush=T,s._tr_init(q),w):de(d,E)}function N(d){var q=I(d);return q===w&&function(g){g.window_size=2*g.w_size,fe(g.head),g.max_lazy_match=l[g.level].max_lazy,g.good_match=l[g.level].good_length,g.nice_match=l[g.level].nice_length,g.max_chain_length=l[g.level].max_chain,g.strstart=0,g.block_start=0,g.lookahead=0,g.insert=0,g.match_length=g.prev_length=R-1,g.match_available=0,g.ins_h=0}(d.state),q}function Y(d,q,g,n,i,f){if(!d)return E;var O=1;if(q===v&&(q=6),n<0?(O=0,n=-n):15<n&&(O=2,n-=16),i<1||k<i||g!==S||n<8||15<n||q<0||9<q||f<0||A<f)return de(d,E);n===8&&(n=9);var U=new D;return(d.state=U).strm=d,U.wrap=O,U.gzhead=null,U.w_bits=n,U.w_size=1<<U.w_bits,U.w_mask=U.w_size-1,U.hash_bits=i+7,U.hash_size=1<<U.hash_bits,U.hash_mask=U.hash_size-1,U.hash_shift=~~((U.hash_bits+R-1)/R),U.window=new o.Buf8(2*U.w_size),U.head=new o.Buf16(U.hash_size),U.prev=new o.Buf16(U.w_size),U.lit_bufsize=1<<i+6,U.pending_buf_size=4*U.lit_bufsize,U.pending_buf=new o.Buf8(U.pending_buf_size),U.d_buf=1*U.lit_bufsize,U.l_buf=3*U.lit_bufsize,U.level=q,U.strategy=f,U.method=g,N(d)}l=[new M(0,0,0,0,function(d,q){var g=65535;for(g>d.pending_buf_size-5&&(g=d.pending_buf_size-5);;){if(d.lookahead<=1){if(j(d),d.lookahead===0&&q===T)return _;if(d.lookahead===0)break}d.strstart+=d.lookahead,d.lookahead=0;var n=d.block_start+g;if((d.strstart===0||d.strstart>=n)&&(d.lookahead=d.strstart-n,d.strstart=n,C(d,!1),d.strm.avail_out===0)||d.strstart-d.block_start>=d.w_size-ce&&(C(d,!1),d.strm.avail_out===0))return _}return d.insert=0,q===x?(C(d,!0),d.strm.avail_out===0?le:V):(d.strstart>d.block_start&&(C(d,!1),d.strm.avail_out),_)}),new M(4,4,8,4,m),new M(4,5,16,8,m),new M(4,6,32,32,m),new M(4,4,16,16,h),new M(8,16,32,32,h),new M(8,16,128,128,h),new M(8,32,128,256,h),new M(32,128,258,1024,h),new M(32,258,258,4096,h)],u.deflateInit=function(d,q){return Y(d,q,S,15,8,0)},u.deflateInit2=Y,u.deflateReset=N,u.deflateResetKeep=I,u.deflateSetHeader=function(d,q){return d&&d.state?d.state.wrap!==2?E:(d.state.gzhead=q,w):E},u.deflate=function(d,q){var g,n,i,f;if(!d||!d.state||5<q||q<0)return d?de(d,E):E;if(n=d.state,!d.output||!d.input&&d.avail_in!==0||n.status===666&&q!==x)return de(d,d.avail_out===0?-5:E);if(n.strm=d,g=n.last_flush,n.last_flush=q,n.status===B)if(n.wrap===2)d.adler=0,z(n,31),z(n,139),z(n,8),n.gzhead?(z(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),z(n,255&n.gzhead.time),z(n,n.gzhead.time>>8&255),z(n,n.gzhead.time>>16&255),z(n,n.gzhead.time>>24&255),z(n,n.level===9?2:2<=n.strategy||n.level<2?4:0),z(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(z(n,255&n.gzhead.extra.length),z(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(d.adler=y(d.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(z(n,0),z(n,0),z(n,0),z(n,0),z(n,0),z(n,n.level===9?2:2<=n.strategy||n.level<2?4:0),z(n,3),n.status=K);else{var O=S+(n.w_bits-8<<4)<<8;O|=(2<=n.strategy||n.level<2?0:n.level<6?1:n.level===6?2:3)<<6,n.strstart!==0&&(O|=32),O+=31-O%31,n.status=K,H(n,O),n.strstart!==0&&(H(n,d.adler>>>16),H(n,65535&d.adler)),d.adler=1}if(n.status===69)if(n.gzhead.extra){for(i=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>i&&(d.adler=y(d.adler,n.pending_buf,n.pending-i,i)),W(d),i=n.pending,n.pending!==n.pending_buf_size));)z(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>i&&(d.adler=y(d.adler,n.pending_buf,n.pending-i,i)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(n.status===73)if(n.gzhead.name){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(d.adler=y(d.adler,n.pending_buf,n.pending-i,i)),W(d),i=n.pending,n.pending===n.pending_buf_size)){f=1;break}f=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,z(n,f)}while(f!==0);n.gzhead.hcrc&&n.pending>i&&(d.adler=y(d.adler,n.pending_buf,n.pending-i,i)),f===0&&(n.gzindex=0,n.status=91)}else n.status=91;if(n.status===91)if(n.gzhead.comment){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(d.adler=y(d.adler,n.pending_buf,n.pending-i,i)),W(d),i=n.pending,n.pending===n.pending_buf_size)){f=1;break}f=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,z(n,f)}while(f!==0);n.gzhead.hcrc&&n.pending>i&&(d.adler=y(d.adler,n.pending_buf,n.pending-i,i)),f===0&&(n.status=103)}else n.status=103;if(n.status===103&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&W(d),n.pending+2<=n.pending_buf_size&&(z(n,255&d.adler),z(n,d.adler>>8&255),d.adler=0,n.status=K)):n.status=K),n.pending!==0){if(W(d),d.avail_out===0)return n.last_flush=-1,w}else if(d.avail_in===0&&ee(q)<=ee(g)&&q!==x)return de(d,-5);if(n.status===666&&d.avail_in!==0)return de(d,-5);if(d.avail_in!==0||n.lookahead!==0||q!==T&&n.status!==666){var U=n.strategy===2?function(P,te){for(var oe;;){if(P.lookahead===0&&(j(P),P.lookahead===0)){if(te===T)return _;break}if(P.match_length=0,oe=s._tr_tally(P,0,P.window[P.strstart]),P.lookahead--,P.strstart++,oe&&(C(P,!1),P.strm.avail_out===0))return _}return P.insert=0,te===x?(C(P,!0),P.strm.avail_out===0?le:V):P.last_lit&&(C(P,!1),P.strm.avail_out===0)?_:$}(n,q):n.strategy===3?function(P,te){for(var oe,ie,ue,he,me=P.window;;){if(P.lookahead<=se){if(j(P),P.lookahead<=se&&te===T)return _;if(P.lookahead===0)break}if(P.match_length=0,P.lookahead>=R&&0<P.strstart&&(ie=me[ue=P.strstart-1])===me[++ue]&&ie===me[++ue]&&ie===me[++ue]){he=P.strstart+se;do;while(ie===me[++ue]&&ie===me[++ue]&&ie===me[++ue]&&ie===me[++ue]&&ie===me[++ue]&&ie===me[++ue]&&ie===me[++ue]&&ie===me[++ue]&&ue<he);P.match_length=se-(he-ue),P.match_length>P.lookahead&&(P.match_length=P.lookahead)}if(P.match_length>=R?(oe=s._tr_tally(P,1,P.match_length-R),P.lookahead-=P.match_length,P.strstart+=P.match_length,P.match_length=0):(oe=s._tr_tally(P,0,P.window[P.strstart]),P.lookahead--,P.strstart++),oe&&(C(P,!1),P.strm.avail_out===0))return _}return P.insert=0,te===x?(C(P,!0),P.strm.avail_out===0?le:V):P.last_lit&&(C(P,!1),P.strm.avail_out===0)?_:$}(n,q):l[n.level].func(n,q);if(U!==le&&U!==V||(n.status=666),U===_||U===le)return d.avail_out===0&&(n.last_flush=-1),w;if(U===$&&(q===1?s._tr_align(n):q!==5&&(s._tr_stored_block(n,0,0,!1),q===3&&(fe(n.head),n.lookahead===0&&(n.strstart=0,n.block_start=0,n.insert=0))),W(d),d.avail_out===0))return n.last_flush=-1,w}return q!==x?w:n.wrap<=0?1:(n.wrap===2?(z(n,255&d.adler),z(n,d.adler>>8&255),z(n,d.adler>>16&255),z(n,d.adler>>24&255),z(n,255&d.total_in),z(n,d.total_in>>8&255),z(n,d.total_in>>16&255),z(n,d.total_in>>24&255)):(H(n,d.adler>>>16),H(n,65535&d.adler)),W(d),0<n.wrap&&(n.wrap=-n.wrap),n.pending!==0?w:1)},u.deflateEnd=function(d){var q;return d&&d.state?(q=d.state.status)!==B&&q!==69&&q!==73&&q!==91&&q!==103&&q!==K&&q!==666?de(d,E):(d.state=null,q===K?de(d,-3):w):E},u.deflateSetDictionary=function(d,q){var g,n,i,f,O,U,P,te,oe=q.length;if(!d||!d.state||(f=(g=d.state).wrap)===2||f===1&&g.status!==B||g.lookahead)return E;for(f===1&&(d.adler=c(d.adler,q,oe,0)),g.wrap=0,oe>=g.w_size&&(f===0&&(fe(g.head),g.strstart=0,g.block_start=0,g.insert=0),te=new o.Buf8(g.w_size),o.arraySet(te,q,oe-g.w_size,g.w_size,0),q=te,oe=g.w_size),O=d.avail_in,U=d.next_in,P=d.input,d.avail_in=oe,d.next_in=0,d.input=q,j(g);g.lookahead>=R;){for(n=g.strstart,i=g.lookahead-(R-1);g.ins_h=(g.ins_h<<g.hash_shift^g.window[n+R-1])&g.hash_mask,g.prev[n&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=n,n++,--i;);g.strstart=n,g.lookahead=R-1,j(g)}return g.strstart+=g.lookahead,g.block_start=g.strstart,g.insert=g.lookahead,g.lookahead=0,g.match_length=g.prev_length=R-1,g.match_available=0,d.next_in=U,d.input=P,d.avail_in=O,g.wrap=f,w},u.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(r,a,u){a.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(r,a,u){a.exports=function(l,o){var s,c,y,b,T,x,w,E,v,A,p,S,k,F,L,X,G,Z,R,se,ce,B,K,_,$;s=l.state,c=l.next_in,_=l.input,y=c+(l.avail_in-5),b=l.next_out,$=l.output,T=b-(o-l.avail_out),x=b+(l.avail_out-257),w=s.dmax,E=s.wsize,v=s.whave,A=s.wnext,p=s.window,S=s.hold,k=s.bits,F=s.lencode,L=s.distcode,X=(1<<s.lenbits)-1,G=(1<<s.distbits)-1;e:do{k<15&&(S+=_[c++]<<k,k+=8,S+=_[c++]<<k,k+=8),Z=F[S&X];t:for(;;){if(S>>>=R=Z>>>24,k-=R,(R=Z>>>16&255)===0)$[b++]=65535&Z;else{if(!(16&R)){if(!(64&R)){Z=F[(65535&Z)+(S&(1<<R)-1)];continue t}if(32&R){s.mode=12;break e}l.msg="invalid literal/length code",s.mode=30;break e}se=65535&Z,(R&=15)&&(k<R&&(S+=_[c++]<<k,k+=8),se+=S&(1<<R)-1,S>>>=R,k-=R),k<15&&(S+=_[c++]<<k,k+=8,S+=_[c++]<<k,k+=8),Z=L[S&G];r:for(;;){if(S>>>=R=Z>>>24,k-=R,!(16&(R=Z>>>16&255))){if(!(64&R)){Z=L[(65535&Z)+(S&(1<<R)-1)];continue r}l.msg="invalid distance code",s.mode=30;break e}if(ce=65535&Z,k<(R&=15)&&(S+=_[c++]<<k,(k+=8)<R&&(S+=_[c++]<<k,k+=8)),w<(ce+=S&(1<<R)-1)){l.msg="invalid distance too far back",s.mode=30;break e}if(S>>>=R,k-=R,(R=b-T)<ce){if(v<(R=ce-R)&&s.sane){l.msg="invalid distance too far back",s.mode=30;break e}if(K=p,(B=0)===A){if(B+=E-R,R<se){for(se-=R;$[b++]=p[B++],--R;);B=b-ce,K=$}}else if(A<R){if(B+=E+A-R,(R-=A)<se){for(se-=R;$[b++]=p[B++],--R;);if(B=0,A<se){for(se-=R=A;$[b++]=p[B++],--R;);B=b-ce,K=$}}}else if(B+=A-R,R<se){for(se-=R;$[b++]=p[B++],--R;);B=b-ce,K=$}for(;2<se;)$[b++]=K[B++],$[b++]=K[B++],$[b++]=K[B++],se-=3;se&&($[b++]=K[B++],1<se&&($[b++]=K[B++]))}else{for(B=b-ce;$[b++]=$[B++],$[b++]=$[B++],$[b++]=$[B++],2<(se-=3););se&&($[b++]=$[B++],1<se&&($[b++]=$[B++]))}break}}break}}while(c<y&&b<x);c-=se=k>>3,S&=(1<<(k-=se<<3))-1,l.next_in=c,l.next_out=b,l.avail_in=c<y?y-c+5:5-(c-y),l.avail_out=b<x?x-b+257:257-(b-x),s.hold=S,s.bits=k}},{}],49:[function(r,a,u){var l=r("../utils/common"),o=r("./adler32"),s=r("./crc32"),c=r("./inffast"),y=r("./inftrees"),b=1,T=2,x=0,w=-2,E=1,v=852,A=592;function p(B){return(B>>>24&255)+(B>>>8&65280)+((65280&B)<<8)+((255&B)<<24)}function S(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new l.Buf16(320),this.work=new l.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function k(B){var K;return B&&B.state?(K=B.state,B.total_in=B.total_out=K.total=0,B.msg="",K.wrap&&(B.adler=1&K.wrap),K.mode=E,K.last=0,K.havedict=0,K.dmax=32768,K.head=null,K.hold=0,K.bits=0,K.lencode=K.lendyn=new l.Buf32(v),K.distcode=K.distdyn=new l.Buf32(A),K.sane=1,K.back=-1,x):w}function F(B){var K;return B&&B.state?((K=B.state).wsize=0,K.whave=0,K.wnext=0,k(B)):w}function L(B,K){var _,$;return B&&B.state?($=B.state,K<0?(_=0,K=-K):(_=1+(K>>4),K<48&&(K&=15)),K&&(K<8||15<K)?w:($.window!==null&&$.wbits!==K&&($.window=null),$.wrap=_,$.wbits=K,F(B))):w}function X(B,K){var _,$;return B?($=new S,(B.state=$).window=null,(_=L(B,K))!==x&&(B.state=null),_):w}var G,Z,R=!0;function se(B){if(R){var K;for(G=new l.Buf32(512),Z=new l.Buf32(32),K=0;K<144;)B.lens[K++]=8;for(;K<256;)B.lens[K++]=9;for(;K<280;)B.lens[K++]=7;for(;K<288;)B.lens[K++]=8;for(y(b,B.lens,0,288,G,0,B.work,{bits:9}),K=0;K<32;)B.lens[K++]=5;y(T,B.lens,0,32,Z,0,B.work,{bits:5}),R=!1}B.lencode=G,B.lenbits=9,B.distcode=Z,B.distbits=5}function ce(B,K,_,$){var le,V=B.state;return V.window===null&&(V.wsize=1<<V.wbits,V.wnext=0,V.whave=0,V.window=new l.Buf8(V.wsize)),$>=V.wsize?(l.arraySet(V.window,K,_-V.wsize,V.wsize,0),V.wnext=0,V.whave=V.wsize):($<(le=V.wsize-V.wnext)&&(le=$),l.arraySet(V.window,K,_-$,le,V.wnext),($-=le)?(l.arraySet(V.window,K,_-$,$,0),V.wnext=$,V.whave=V.wsize):(V.wnext+=le,V.wnext===V.wsize&&(V.wnext=0),V.whave<V.wsize&&(V.whave+=le))),0}u.inflateReset=F,u.inflateReset2=L,u.inflateResetKeep=k,u.inflateInit=function(B){return X(B,15)},u.inflateInit2=X,u.inflate=function(B,K){var _,$,le,V,de,ee,fe,W,C,z,H,Q,j,m,h,M,D,I,N,Y,d,q,g,n,i=0,f=new l.Buf8(4),O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!B||!B.state||!B.output||!B.input&&B.avail_in!==0)return w;(_=B.state).mode===12&&(_.mode=13),de=B.next_out,le=B.output,fe=B.avail_out,V=B.next_in,$=B.input,ee=B.avail_in,W=_.hold,C=_.bits,z=ee,H=fe,q=x;e:for(;;)switch(_.mode){case E:if(_.wrap===0){_.mode=13;break}for(;C<16;){if(ee===0)break e;ee--,W+=$[V++]<<C,C+=8}if(2&_.wrap&&W===35615){f[_.check=0]=255&W,f[1]=W>>>8&255,_.check=s(_.check,f,2,0),C=W=0,_.mode=2;break}if(_.flags=0,_.head&&(_.head.done=!1),!(1&_.wrap)||(((255&W)<<8)+(W>>8))%31){B.msg="incorrect header check",_.mode=30;break}if((15&W)!=8){B.msg="unknown compression method",_.mode=30;break}if(C-=4,d=8+(15&(W>>>=4)),_.wbits===0)_.wbits=d;else if(d>_.wbits){B.msg="invalid window size",_.mode=30;break}_.dmax=1<<d,B.adler=_.check=1,_.mode=512&W?10:12,C=W=0;break;case 2:for(;C<16;){if(ee===0)break e;ee--,W+=$[V++]<<C,C+=8}if(_.flags=W,(255&_.flags)!=8){B.msg="unknown compression method",_.mode=30;break}if(57344&_.flags){B.msg="unknown header flags set",_.mode=30;break}_.head&&(_.head.text=W>>8&1),512&_.flags&&(f[0]=255&W,f[1]=W>>>8&255,_.check=s(_.check,f,2,0)),C=W=0,_.mode=3;case 3:for(;C<32;){if(ee===0)break e;ee--,W+=$[V++]<<C,C+=8}_.head&&(_.head.time=W),512&_.flags&&(f[0]=255&W,f[1]=W>>>8&255,f[2]=W>>>16&255,f[3]=W>>>24&255,_.check=s(_.check,f,4,0)),C=W=0,_.mode=4;case 4:for(;C<16;){if(ee===0)break e;ee--,W+=$[V++]<<C,C+=8}_.head&&(_.head.xflags=255&W,_.head.os=W>>8),512&_.flags&&(f[0]=255&W,f[1]=W>>>8&255,_.check=s(_.check,f,2,0)),C=W=0,_.mode=5;case 5:if(1024&_.flags){for(;C<16;){if(ee===0)break e;ee--,W+=$[V++]<<C,C+=8}_.length=W,_.head&&(_.head.extra_len=W),512&_.flags&&(f[0]=255&W,f[1]=W>>>8&255,_.check=s(_.check,f,2,0)),C=W=0}else _.head&&(_.head.extra=null);_.mode=6;case 6:if(1024&_.flags&&(ee<(Q=_.length)&&(Q=ee),Q&&(_.head&&(d=_.head.extra_len-_.length,_.head.extra||(_.head.extra=new Array(_.head.extra_len)),l.arraySet(_.head.extra,$,V,Q,d)),512&_.flags&&(_.check=s(_.check,$,Q,V)),ee-=Q,V+=Q,_.length-=Q),_.length))break e;_.length=0,_.mode=7;case 7:if(2048&_.flags){if(ee===0)break e;for(Q=0;d=$[V+Q++],_.head&&d&&_.length<65536&&(_.head.name+=String.fromCharCode(d)),d&&Q<ee;);if(512&_.flags&&(_.check=s(_.check,$,Q,V)),ee-=Q,V+=Q,d)break e}else _.head&&(_.head.name=null);_.length=0,_.mode=8;case 8:if(4096&_.flags){if(ee===0)break e;for(Q=0;d=$[V+Q++],_.head&&d&&_.length<65536&&(_.head.comment+=String.fromCharCode(d)),d&&Q<ee;);if(512&_.flags&&(_.check=s(_.check,$,Q,V)),ee-=Q,V+=Q,d)break e}else _.head&&(_.head.comment=null);_.mode=9;case 9:if(512&_.flags){for(;C<16;){if(ee===0)break e;ee--,W+=$[V++]<<C,C+=8}if(W!==(65535&_.check)){B.msg="header crc mismatch",_.mode=30;break}C=W=0}_.head&&(_.head.hcrc=_.flags>>9&1,_.head.done=!0),B.adler=_.check=0,_.mode=12;break;case 10:for(;C<32;){if(ee===0)break e;ee--,W+=$[V++]<<C,C+=8}B.adler=_.check=p(W),C=W=0,_.mode=11;case 11:if(_.havedict===0)return B.next_out=de,B.avail_out=fe,B.next_in=V,B.avail_in=ee,_.hold=W,_.bits=C,2;B.adler=_.check=1,_.mode=12;case 12:if(K===5||K===6)break e;case 13:if(_.last){W>>>=7&C,C-=7&C,_.mode=27;break}for(;C<3;){if(ee===0)break e;ee--,W+=$[V++]<<C,C+=8}switch(_.last=1&W,C-=1,3&(W>>>=1)){case 0:_.mode=14;break;case 1:if(se(_),_.mode=20,K!==6)break;W>>>=2,C-=2;break e;case 2:_.mode=17;break;case 3:B.msg="invalid block type",_.mode=30}W>>>=2,C-=2;break;case 14:for(W>>>=7&C,C-=7&C;C<32;){if(ee===0)break e;ee--,W+=$[V++]<<C,C+=8}if((65535&W)!=(W>>>16^65535)){B.msg="invalid stored block lengths",_.mode=30;break}if(_.length=65535&W,C=W=0,_.mode=15,K===6)break e;case 15:_.mode=16;case 16:if(Q=_.length){if(ee<Q&&(Q=ee),fe<Q&&(Q=fe),Q===0)break e;l.arraySet(le,$,V,Q,de),ee-=Q,V+=Q,fe-=Q,de+=Q,_.length-=Q;break}_.mode=12;break;case 17:for(;C<14;){if(ee===0)break e;ee--,W+=$[V++]<<C,C+=8}if(_.nlen=257+(31&W),W>>>=5,C-=5,_.ndist=1+(31&W),W>>>=5,C-=5,_.ncode=4+(15&W),W>>>=4,C-=4,286<_.nlen||30<_.ndist){B.msg="too many length or distance symbols",_.mode=30;break}_.have=0,_.mode=18;case 18:for(;_.have<_.ncode;){for(;C<3;){if(ee===0)break e;ee--,W+=$[V++]<<C,C+=8}_.lens[O[_.have++]]=7&W,W>>>=3,C-=3}for(;_.have<19;)_.lens[O[_.have++]]=0;if(_.lencode=_.lendyn,_.lenbits=7,g={bits:_.lenbits},q=y(0,_.lens,0,19,_.lencode,0,_.work,g),_.lenbits=g.bits,q){B.msg="invalid code lengths set",_.mode=30;break}_.have=0,_.mode=19;case 19:for(;_.have<_.nlen+_.ndist;){for(;M=(i=_.lencode[W&(1<<_.lenbits)-1])>>>16&255,D=65535&i,!((h=i>>>24)<=C);){if(ee===0)break e;ee--,W+=$[V++]<<C,C+=8}if(D<16)W>>>=h,C-=h,_.lens[_.have++]=D;else{if(D===16){for(n=h+2;C<n;){if(ee===0)break e;ee--,W+=$[V++]<<C,C+=8}if(W>>>=h,C-=h,_.have===0){B.msg="invalid bit length repeat",_.mode=30;break}d=_.lens[_.have-1],Q=3+(3&W),W>>>=2,C-=2}else if(D===17){for(n=h+3;C<n;){if(ee===0)break e;ee--,W+=$[V++]<<C,C+=8}C-=h,d=0,Q=3+(7&(W>>>=h)),W>>>=3,C-=3}else{for(n=h+7;C<n;){if(ee===0)break e;ee--,W+=$[V++]<<C,C+=8}C-=h,d=0,Q=11+(127&(W>>>=h)),W>>>=7,C-=7}if(_.have+Q>_.nlen+_.ndist){B.msg="invalid bit length repeat",_.mode=30;break}for(;Q--;)_.lens[_.have++]=d}}if(_.mode===30)break;if(_.lens[256]===0){B.msg="invalid code -- missing end-of-block",_.mode=30;break}if(_.lenbits=9,g={bits:_.lenbits},q=y(b,_.lens,0,_.nlen,_.lencode,0,_.work,g),_.lenbits=g.bits,q){B.msg="invalid literal/lengths set",_.mode=30;break}if(_.distbits=6,_.distcode=_.distdyn,g={bits:_.distbits},q=y(T,_.lens,_.nlen,_.ndist,_.distcode,0,_.work,g),_.distbits=g.bits,q){B.msg="invalid distances set",_.mode=30;break}if(_.mode=20,K===6)break e;case 20:_.mode=21;case 21:if(6<=ee&&258<=fe){B.next_out=de,B.avail_out=fe,B.next_in=V,B.avail_in=ee,_.hold=W,_.bits=C,c(B,H),de=B.next_out,le=B.output,fe=B.avail_out,V=B.next_in,$=B.input,ee=B.avail_in,W=_.hold,C=_.bits,_.mode===12&&(_.back=-1);break}for(_.back=0;M=(i=_.lencode[W&(1<<_.lenbits)-1])>>>16&255,D=65535&i,!((h=i>>>24)<=C);){if(ee===0)break e;ee--,W+=$[V++]<<C,C+=8}if(M&&!(240&M)){for(I=h,N=M,Y=D;M=(i=_.lencode[Y+((W&(1<<I+N)-1)>>I)])>>>16&255,D=65535&i,!(I+(h=i>>>24)<=C);){if(ee===0)break e;ee--,W+=$[V++]<<C,C+=8}W>>>=I,C-=I,_.back+=I}if(W>>>=h,C-=h,_.back+=h,_.length=D,M===0){_.mode=26;break}if(32&M){_.back=-1,_.mode=12;break}if(64&M){B.msg="invalid literal/length code",_.mode=30;break}_.extra=15&M,_.mode=22;case 22:if(_.extra){for(n=_.extra;C<n;){if(ee===0)break e;ee--,W+=$[V++]<<C,C+=8}_.length+=W&(1<<_.extra)-1,W>>>=_.extra,C-=_.extra,_.back+=_.extra}_.was=_.length,_.mode=23;case 23:for(;M=(i=_.distcode[W&(1<<_.distbits)-1])>>>16&255,D=65535&i,!((h=i>>>24)<=C);){if(ee===0)break e;ee--,W+=$[V++]<<C,C+=8}if(!(240&M)){for(I=h,N=M,Y=D;M=(i=_.distcode[Y+((W&(1<<I+N)-1)>>I)])>>>16&255,D=65535&i,!(I+(h=i>>>24)<=C);){if(ee===0)break e;ee--,W+=$[V++]<<C,C+=8}W>>>=I,C-=I,_.back+=I}if(W>>>=h,C-=h,_.back+=h,64&M){B.msg="invalid distance code",_.mode=30;break}_.offset=D,_.extra=15&M,_.mode=24;case 24:if(_.extra){for(n=_.extra;C<n;){if(ee===0)break e;ee--,W+=$[V++]<<C,C+=8}_.offset+=W&(1<<_.extra)-1,W>>>=_.extra,C-=_.extra,_.back+=_.extra}if(_.offset>_.dmax){B.msg="invalid distance too far back",_.mode=30;break}_.mode=25;case 25:if(fe===0)break e;if(Q=H-fe,_.offset>Q){if((Q=_.offset-Q)>_.whave&&_.sane){B.msg="invalid distance too far back",_.mode=30;break}j=Q>_.wnext?(Q-=_.wnext,_.wsize-Q):_.wnext-Q,Q>_.length&&(Q=_.length),m=_.window}else m=le,j=de-_.offset,Q=_.length;for(fe<Q&&(Q=fe),fe-=Q,_.length-=Q;le[de++]=m[j++],--Q;);_.length===0&&(_.mode=21);break;case 26:if(fe===0)break e;le[de++]=_.length,fe--,_.mode=21;break;case 27:if(_.wrap){for(;C<32;){if(ee===0)break e;ee--,W|=$[V++]<<C,C+=8}if(H-=fe,B.total_out+=H,_.total+=H,H&&(B.adler=_.check=_.flags?s(_.check,le,H,de-H):o(_.check,le,H,de-H)),H=fe,(_.flags?W:p(W))!==_.check){B.msg="incorrect data check",_.mode=30;break}C=W=0}_.mode=28;case 28:if(_.wrap&&_.flags){for(;C<32;){if(ee===0)break e;ee--,W+=$[V++]<<C,C+=8}if(W!==(4294967295&_.total)){B.msg="incorrect length check",_.mode=30;break}C=W=0}_.mode=29;case 29:q=1;break e;case 30:q=-3;break e;case 31:return-4;case 32:default:return w}return B.next_out=de,B.avail_out=fe,B.next_in=V,B.avail_in=ee,_.hold=W,_.bits=C,(_.wsize||H!==B.avail_out&&_.mode<30&&(_.mode<27||K!==4))&&ce(B,B.output,B.next_out,H-B.avail_out)?(_.mode=31,-4):(z-=B.avail_in,H-=B.avail_out,B.total_in+=z,B.total_out+=H,_.total+=H,_.wrap&&H&&(B.adler=_.check=_.flags?s(_.check,le,H,B.next_out-H):o(_.check,le,H,B.next_out-H)),B.data_type=_.bits+(_.last?64:0)+(_.mode===12?128:0)+(_.mode===20||_.mode===15?256:0),(z==0&&H===0||K===4)&&q===x&&(q=-5),q)},u.inflateEnd=function(B){if(!B||!B.state)return w;var K=B.state;return K.window&&(K.window=null),B.state=null,x},u.inflateGetHeader=function(B,K){var _;return B&&B.state&&2&(_=B.state).wrap?((_.head=K).done=!1,x):w},u.inflateSetDictionary=function(B,K){var _,$=K.length;return B&&B.state?(_=B.state).wrap!==0&&_.mode!==11?w:_.mode===11&&o(1,K,$,0)!==_.check?-3:ce(B,K,$,$)?(_.mode=31,-4):(_.havedict=1,x):w},u.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(r,a,u){var l=r("../utils/common"),o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],y=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];a.exports=function(b,T,x,w,E,v,A,p){var S,k,F,L,X,G,Z,R,se,ce=p.bits,B=0,K=0,_=0,$=0,le=0,V=0,de=0,ee=0,fe=0,W=0,C=null,z=0,H=new l.Buf16(16),Q=new l.Buf16(16),j=null,m=0;for(B=0;B<=15;B++)H[B]=0;for(K=0;K<w;K++)H[T[x+K]]++;for(le=ce,$=15;1<=$&&H[$]===0;$--);if($<le&&(le=$),$===0)return E[v++]=20971520,E[v++]=20971520,p.bits=1,0;for(_=1;_<$&&H[_]===0;_++);for(le<_&&(le=_),B=ee=1;B<=15;B++)if(ee<<=1,(ee-=H[B])<0)return-1;if(0<ee&&(b===0||$!==1))return-1;for(Q[1]=0,B=1;B<15;B++)Q[B+1]=Q[B]+H[B];for(K=0;K<w;K++)T[x+K]!==0&&(A[Q[T[x+K]]++]=K);if(G=b===0?(C=j=A,19):b===1?(C=o,z-=257,j=s,m-=257,256):(C=c,j=y,-1),B=_,X=v,de=K=W=0,F=-1,L=(fe=1<<(V=le))-1,b===1&&852<fe||b===2&&592<fe)return 1;for(;;){for(Z=B-de,se=A[K]<G?(R=0,A[K]):A[K]>G?(R=j[m+A[K]],C[z+A[K]]):(R=96,0),S=1<<B-de,_=k=1<<V;E[X+(W>>de)+(k-=S)]=Z<<24|R<<16|se|0,k!==0;);for(S=1<<B-1;W&S;)S>>=1;if(S!==0?(W&=S-1,W+=S):W=0,K++,--H[B]==0){if(B===$)break;B=T[x+A[K]]}if(le<B&&(W&L)!==F){for(de===0&&(de=le),X+=_,ee=1<<(V=B-de);V+de<$&&!((ee-=H[V+de])<=0);)V++,ee<<=1;if(fe+=1<<V,b===1&&852<fe||b===2&&592<fe)return 1;E[F=W&L]=le<<24|V<<16|X-v|0}}return W!==0&&(E[X+W]=B-de<<24|64<<16|0),p.bits=le,0}},{"../utils/common":41}],51:[function(r,a,u){a.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(r,a,u){var l=r("../utils/common"),o=0,s=1;function c(i){for(var f=i.length;0<=--f;)i[f]=0}var y=0,b=29,T=256,x=T+1+b,w=30,E=19,v=2*x+1,A=15,p=16,S=7,k=256,F=16,L=17,X=18,G=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Z=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],R=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],se=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ce=new Array(2*(x+2));c(ce);var B=new Array(2*w);c(B);var K=new Array(512);c(K);var _=new Array(256);c(_);var $=new Array(b);c($);var le,V,de,ee=new Array(w);function fe(i,f,O,U,P){this.static_tree=i,this.extra_bits=f,this.extra_base=O,this.elems=U,this.max_length=P,this.has_stree=i&&i.length}function W(i,f){this.dyn_tree=i,this.max_code=0,this.stat_desc=f}function C(i){return i<256?K[i]:K[256+(i>>>7)]}function z(i,f){i.pending_buf[i.pending++]=255&f,i.pending_buf[i.pending++]=f>>>8&255}function H(i,f,O){i.bi_valid>p-O?(i.bi_buf|=f<<i.bi_valid&65535,z(i,i.bi_buf),i.bi_buf=f>>p-i.bi_valid,i.bi_valid+=O-p):(i.bi_buf|=f<<i.bi_valid&65535,i.bi_valid+=O)}function Q(i,f,O){H(i,O[2*f],O[2*f+1])}function j(i,f){for(var O=0;O|=1&i,i>>>=1,O<<=1,0<--f;);return O>>>1}function m(i,f,O){var U,P,te=new Array(A+1),oe=0;for(U=1;U<=A;U++)te[U]=oe=oe+O[U-1]<<1;for(P=0;P<=f;P++){var ie=i[2*P+1];ie!==0&&(i[2*P]=j(te[ie]++,ie))}}function h(i){var f;for(f=0;f<x;f++)i.dyn_ltree[2*f]=0;for(f=0;f<w;f++)i.dyn_dtree[2*f]=0;for(f=0;f<E;f++)i.bl_tree[2*f]=0;i.dyn_ltree[2*k]=1,i.opt_len=i.static_len=0,i.last_lit=i.matches=0}function M(i){8<i.bi_valid?z(i,i.bi_buf):0<i.bi_valid&&(i.pending_buf[i.pending++]=i.bi_buf),i.bi_buf=0,i.bi_valid=0}function D(i,f,O,U){var P=2*f,te=2*O;return i[P]<i[te]||i[P]===i[te]&&U[f]<=U[O]}function I(i,f,O){for(var U=i.heap[O],P=O<<1;P<=i.heap_len&&(P<i.heap_len&&D(f,i.heap[P+1],i.heap[P],i.depth)&&P++,!D(f,U,i.heap[P],i.depth));)i.heap[O]=i.heap[P],O=P,P<<=1;i.heap[O]=U}function N(i,f,O){var U,P,te,oe,ie=0;if(i.last_lit!==0)for(;U=i.pending_buf[i.d_buf+2*ie]<<8|i.pending_buf[i.d_buf+2*ie+1],P=i.pending_buf[i.l_buf+ie],ie++,U===0?Q(i,P,f):(Q(i,(te=_[P])+T+1,f),(oe=G[te])!==0&&H(i,P-=$[te],oe),Q(i,te=C(--U),O),(oe=Z[te])!==0&&H(i,U-=ee[te],oe)),ie<i.last_lit;);Q(i,k,f)}function Y(i,f){var O,U,P,te=f.dyn_tree,oe=f.stat_desc.static_tree,ie=f.stat_desc.has_stree,ue=f.stat_desc.elems,he=-1;for(i.heap_len=0,i.heap_max=v,O=0;O<ue;O++)te[2*O]!==0?(i.heap[++i.heap_len]=he=O,i.depth[O]=0):te[2*O+1]=0;for(;i.heap_len<2;)te[2*(P=i.heap[++i.heap_len]=he<2?++he:0)]=1,i.depth[P]=0,i.opt_len--,ie&&(i.static_len-=oe[2*P+1]);for(f.max_code=he,O=i.heap_len>>1;1<=O;O--)I(i,te,O);for(P=ue;O=i.heap[1],i.heap[1]=i.heap[i.heap_len--],I(i,te,1),U=i.heap[1],i.heap[--i.heap_max]=O,i.heap[--i.heap_max]=U,te[2*P]=te[2*O]+te[2*U],i.depth[P]=(i.depth[O]>=i.depth[U]?i.depth[O]:i.depth[U])+1,te[2*O+1]=te[2*U+1]=P,i.heap[1]=P++,I(i,te,1),2<=i.heap_len;);i.heap[--i.heap_max]=i.heap[1],function(me,De){var Ze,je,At,Ae,Ut,gr,Ke=De.dyn_tree,Yn=De.max_code,fa=De.stat_desc.static_tree,da=De.stat_desc.has_stree,ha=De.stat_desc.extra_bits,Zn=De.stat_desc.extra_base,kt=De.stat_desc.max_length,jt=0;for(Ae=0;Ae<=A;Ae++)me.bl_count[Ae]=0;for(Ke[2*me.heap[me.heap_max]+1]=0,Ze=me.heap_max+1;Ze<v;Ze++)kt<(Ae=Ke[2*Ke[2*(je=me.heap[Ze])+1]+1]+1)&&(Ae=kt,jt++),Ke[2*je+1]=Ae,Yn<je||(me.bl_count[Ae]++,Ut=0,Zn<=je&&(Ut=ha[je-Zn]),gr=Ke[2*je],me.opt_len+=gr*(Ae+Ut),da&&(me.static_len+=gr*(fa[2*je+1]+Ut)));if(jt!==0){do{for(Ae=kt-1;me.bl_count[Ae]===0;)Ae--;me.bl_count[Ae]--,me.bl_count[Ae+1]+=2,me.bl_count[kt]--,jt-=2}while(0<jt);for(Ae=kt;Ae!==0;Ae--)for(je=me.bl_count[Ae];je!==0;)Yn<(At=me.heap[--Ze])||(Ke[2*At+1]!==Ae&&(me.opt_len+=(Ae-Ke[2*At+1])*Ke[2*At],Ke[2*At+1]=Ae),je--)}}(i,f),m(te,he,i.bl_count)}function d(i,f,O){var U,P,te=-1,oe=f[1],ie=0,ue=7,he=4;for(oe===0&&(ue=138,he=3),f[2*(O+1)+1]=65535,U=0;U<=O;U++)P=oe,oe=f[2*(U+1)+1],++ie<ue&&P===oe||(ie<he?i.bl_tree[2*P]+=ie:P!==0?(P!==te&&i.bl_tree[2*P]++,i.bl_tree[2*F]++):ie<=10?i.bl_tree[2*L]++:i.bl_tree[2*X]++,te=P,he=(ie=0)===oe?(ue=138,3):P===oe?(ue=6,3):(ue=7,4))}function q(i,f,O){var U,P,te=-1,oe=f[1],ie=0,ue=7,he=4;for(oe===0&&(ue=138,he=3),U=0;U<=O;U++)if(P=oe,oe=f[2*(U+1)+1],!(++ie<ue&&P===oe)){if(ie<he)for(;Q(i,P,i.bl_tree),--ie!=0;);else P!==0?(P!==te&&(Q(i,P,i.bl_tree),ie--),Q(i,F,i.bl_tree),H(i,ie-3,2)):ie<=10?(Q(i,L,i.bl_tree),H(i,ie-3,3)):(Q(i,X,i.bl_tree),H(i,ie-11,7));te=P,he=(ie=0)===oe?(ue=138,3):P===oe?(ue=6,3):(ue=7,4)}}c(ee);var g=!1;function n(i,f,O,U){H(i,(y<<1)+(U?1:0),3),function(P,te,oe,ie){M(P),z(P,oe),z(P,~oe),l.arraySet(P.pending_buf,P.window,te,oe,P.pending),P.pending+=oe}(i,f,O)}u._tr_init=function(i){g||(function(){var f,O,U,P,te,oe=new Array(A+1);for(P=U=0;P<b-1;P++)for($[P]=U,f=0;f<1<<G[P];f++)_[U++]=P;for(_[U-1]=P,P=te=0;P<16;P++)for(ee[P]=te,f=0;f<1<<Z[P];f++)K[te++]=P;for(te>>=7;P<w;P++)for(ee[P]=te<<7,f=0;f<1<<Z[P]-7;f++)K[256+te++]=P;for(O=0;O<=A;O++)oe[O]=0;for(f=0;f<=143;)ce[2*f+1]=8,f++,oe[8]++;for(;f<=255;)ce[2*f+1]=9,f++,oe[9]++;for(;f<=279;)ce[2*f+1]=7,f++,oe[7]++;for(;f<=287;)ce[2*f+1]=8,f++,oe[8]++;for(m(ce,x+1,oe),f=0;f<w;f++)B[2*f+1]=5,B[2*f]=j(f,5);le=new fe(ce,G,T+1,x,A),V=new fe(B,Z,0,w,A),de=new fe(new Array(0),R,0,E,S)}(),g=!0),i.l_desc=new W(i.dyn_ltree,le),i.d_desc=new W(i.dyn_dtree,V),i.bl_desc=new W(i.bl_tree,de),i.bi_buf=0,i.bi_valid=0,h(i)},u._tr_stored_block=n,u._tr_flush_block=function(i,f,O,U){var P,te,oe=0;0<i.level?(i.strm.data_type===2&&(i.strm.data_type=function(ie){var ue,he=4093624447;for(ue=0;ue<=31;ue++,he>>>=1)if(1&he&&ie.dyn_ltree[2*ue]!==0)return o;if(ie.dyn_ltree[18]!==0||ie.dyn_ltree[20]!==0||ie.dyn_ltree[26]!==0)return s;for(ue=32;ue<T;ue++)if(ie.dyn_ltree[2*ue]!==0)return s;return o}(i)),Y(i,i.l_desc),Y(i,i.d_desc),oe=function(ie){var ue;for(d(ie,ie.dyn_ltree,ie.l_desc.max_code),d(ie,ie.dyn_dtree,ie.d_desc.max_code),Y(ie,ie.bl_desc),ue=E-1;3<=ue&&ie.bl_tree[2*se[ue]+1]===0;ue--);return ie.opt_len+=3*(ue+1)+5+5+4,ue}(i),P=i.opt_len+3+7>>>3,(te=i.static_len+3+7>>>3)<=P&&(P=te)):P=te=O+5,O+4<=P&&f!==-1?n(i,f,O,U):i.strategy===4||te===P?(H(i,2+(U?1:0),3),N(i,ce,B)):(H(i,4+(U?1:0),3),function(ie,ue,he,me){var De;for(H(ie,ue-257,5),H(ie,he-1,5),H(ie,me-4,4),De=0;De<me;De++)H(ie,ie.bl_tree[2*se[De]+1],3);q(ie,ie.dyn_ltree,ue-1),q(ie,ie.dyn_dtree,he-1)}(i,i.l_desc.max_code+1,i.d_desc.max_code+1,oe+1),N(i,i.dyn_ltree,i.dyn_dtree)),h(i),U&&M(i)},u._tr_tally=function(i,f,O){return i.pending_buf[i.d_buf+2*i.last_lit]=f>>>8&255,i.pending_buf[i.d_buf+2*i.last_lit+1]=255&f,i.pending_buf[i.l_buf+i.last_lit]=255&O,i.last_lit++,f===0?i.dyn_ltree[2*O]++:(i.matches++,f--,i.dyn_ltree[2*(_[O]+T+1)]++,i.dyn_dtree[2*C(f)]++),i.last_lit===i.lit_bufsize-1},u._tr_align=function(i){H(i,2,3),Q(i,k,ce),function(f){f.bi_valid===16?(z(f,f.bi_buf),f.bi_buf=0,f.bi_valid=0):8<=f.bi_valid&&(f.pending_buf[f.pending++]=255&f.bi_buf,f.bi_buf>>=8,f.bi_valid-=8)}(i)}},{"../utils/common":41}],53:[function(r,a,u){a.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(r,a,u){(function(l){(function(o,s){if(!o.setImmediate){var c,y,b,T,x=1,w={},E=!1,v=o.document,A=Object.getPrototypeOf&&Object.getPrototypeOf(o);A=A&&A.setTimeout?A:o,c={}.toString.call(o.process)==="[object process]"?function(F){ge.nextTick(function(){S(F)})}:function(){if(o.postMessage&&!o.importScripts){var F=!0,L=o.onmessage;return o.onmessage=function(){F=!1},o.postMessage("","*"),o.onmessage=L,F}}()?(T="setImmediate$"+Math.random()+"$",o.addEventListener?o.addEventListener("message",k,!1):o.attachEvent("onmessage",k),function(F){o.postMessage(T+F,"*")}):o.MessageChannel?((b=new MessageChannel).port1.onmessage=function(F){S(F.data)},function(F){b.port2.postMessage(F)}):v&&"onreadystatechange"in v.createElement("script")?(y=v.documentElement,function(F){var L=v.createElement("script");L.onreadystatechange=function(){S(F),L.onreadystatechange=null,y.removeChild(L),L=null},y.appendChild(L)}):function(F){setTimeout(S,0,F)},A.setImmediate=function(F){typeof F!="function"&&(F=new Function(""+F));for(var L=new Array(arguments.length-1),X=0;X<L.length;X++)L[X]=arguments[X+1];var G={callback:F,args:L};return w[x]=G,c(x),x++},A.clearImmediate=p}function p(F){delete w[F]}function S(F){if(E)setTimeout(S,0,F);else{var L=w[F];if(L){E=!0;try{(function(X){var G=X.callback,Z=X.args;switch(Z.length){case 0:G();break;case 1:G(Z[0]);break;case 2:G(Z[0],Z[1]);break;case 3:G(Z[0],Z[1],Z[2]);break;default:G.apply(s,Z)}})(L)}finally{p(F),E=!1}}}}function k(F){F.source===o&&typeof F.data=="string"&&F.data.indexOf(T)===0&&S(+F.data.slice(T.length))}})(typeof self>"u"?l===void 0?this:l:self)}).call(this,typeof Ge<"u"?Ge:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(la);var Yc=la.exports;const Zc=os(Yc);var ir={exports:{}},Jc={"&":"&amp;",'"':"&quot;","'":"&apos;","<":"&lt;",">":"&gt;"};function Qc(t){return t&&t.replace?t.replace(/([&"<>'])/g,function(e,r){return Jc[r]}):t}var ef=Qc,_n=ef,ns=In.Stream,tf="    ";function rf(t,e){typeof e!="object"&&(e={indent:e});var r=e.stream?new ns:null,a="",u=!1,l=e.indent?e.indent===!0?tf:e.indent:"",o=!0;function s(x){o?ge.nextTick(x):x()}function c(x,w){if(w!==void 0&&(a+=w),x&&!u&&(r=r||new ns,u=!0),x&&u){var E=a;s(function(){r.emit("data",E)}),a=""}}function y(x,w){jn(c,sr(x,l,l?1:0),w)}function b(){if(r){var x=a;s(function(){r.emit("data",x),r.emit("end"),r.readable=!1,r.emit("close")})}}function T(x){var w=x.encoding||"UTF-8",E={version:"1.0",encoding:w};x.standalone&&(E.standalone=x.standalone),y({"?xml":{_attr:E}}),a=a.replace("/>","?>")}return s(function(){o=!1}),e.declaration&&T(e.declaration),t&&t.forEach?t.forEach(function(x,w){var E;w+1===t.length&&(E=b),y(x,E)}):y(t,b),r?(r.readable=!0,r):a}function nf(){var t=Array.prototype.slice.call(arguments),e={_elem:sr(t)};return e.push=function(r){if(!this.append)throw new Error("not assigned to a parent!");var a=this,u=this._elem.indent;jn(this.append,sr(r,u,this._elem.icount+(u?1:0)),function(){a.append(!0)})},e.close=function(r){r!==void 0&&this.push(r),this.end&&this.end()},e}function sf(t,e){return new Array(e||0).join(t||"")}function sr(t,e,r){r=r||0;var a=sf(e,r),u,l=t,o=!1;if(typeof t=="object"){var s=Object.keys(t);if(u=s[0],l=t[u],l&&l._elem)return l._elem.name=u,l._elem.icount=r,l._elem.indent=e,l._elem.indents=a,l._elem.interrupt=l,l._elem}var c=[],y=[],b;function T(x){var w=Object.keys(x);w.forEach(function(E){c.push(af(E,x[E]))})}switch(typeof l){case"object":if(l===null)break;l._attr&&T(l._attr),l._cdata&&y.push(("<![CDATA["+l._cdata).replace(/\]\]>/g,"]]]]><![CDATA[>")+"]]>"),l.forEach&&(b=!1,y.push(""),l.forEach(function(x){if(typeof x=="object"){var w=Object.keys(x)[0];w=="_attr"?T(x._attr):y.push(sr(x,e,r+1))}else y.pop(),b=!0,y.push(_n(x))}),b||y.push(""));break;default:y.push(_n(l))}return{name:u,interrupt:o,attributes:c,content:y,icount:r,indents:a,indent:e}}function jn(t,e,r){if(typeof e!="object")return t(!1,e);var a=e.interrupt?1:e.content.length;function u(){for(;e.content.length;){var o=e.content.shift();if(o!==void 0){if(l(o))return;jn(t,o)}}t(!1,(a>1?e.indents:"")+(e.name?"</"+e.name+">":"")+(e.indent&&!r?`
`:"")),r&&r()}function l(o){return o.interrupt?(o.interrupt.append=t,o.interrupt.end=u,o.interrupt=!1,t(!0),!0):!1}if(t(!1,e.indents+(e.name?"<"+e.name:"")+(e.attributes.length?" "+e.attributes.join(" "):"")+(a?e.name?">":"":e.name?"/>":"")+(e.indent&&a>1?`
`:"")),!a)return t(!1,e.indent?`
`:"");l(e)||u()}function af(t,e){return t+'="'+_n(e)+'"'}ir.exports=rf;ir.exports.element=ir.exports.Element=nf;var of=ir.exports;const ke=os(of),is=0,ss=32,lf=32,uf=(t,e)=>{const r=e.replace(/-/g,"");if(r.length!==lf)throw new Error(`Error: Cannot extract GUID from font filename: ${e}`);const u=r.replace(/(..)/g,"$1 ").trim().split(" ").map(c=>parseInt(c,16));u.reverse();const o=t.slice(is,ss).map((c,y)=>c^u[y%u.length]);return Buffer.concat([t.slice(0,is),o,t.slice(ss)])};class cf{format(e,r={stack:[]}){const a=e.prepForXml(r);if(a)return a;throw Error("XMLComponent did not format correctly")}}class ff{replace(e,r,a){let u=e;return r.forEach((l,o)=>{u=u.replace(new RegExp(`{${l.fileName}}`,"g"),(a+o).toString())}),u}getMediaData(e,r){return r.Array.filter(a=>e.search(`{${a.fileName}}`)>0)}}class df{replace(e,r){let a=e;for(const u of r)a=a.replace(new RegExp(`{${u.reference}-${u.instance}}`,"g"),u.numId.toString());return a}}class hf{constructor(){re(this,"formatter"),re(this,"imageReplacer"),re(this,"numberingReplacer"),this.formatter=new cf,this.imageReplacer=new ff,this.numberingReplacer=new df}compile(e,r){const a=new Zc,u=this.xmlifyFile(e,r),l=new Map(Object.entries(u));for(const[,o]of l)if(Array.isArray(o))for(const s of o)a.file(s.path,s.data);else a.file(o.path,o.data);for(const{stream:o,fileName:s}of e.Media.Array)a.file(`word/media/${s}`,o);for(const{data:o,name:s,fontKey:c}of e.FontTable.fontOptionsWithKey){const[y]=s.split(".");a.file(`word/fonts/${y}.odttf`,uf(o,c))}return a}xmlifyFile(e,r){const a=e.Document.Relationships.RelationshipCount+1,u=ke(this.formatter.format(e.Document.View,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),l=this.imageReplacer.getMediaData(u,e.Media);return{Relationships:{data:(l.forEach((o,s)=>{e.Document.Relationships.createRelationship(a+s,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${o.fileName}`)}),ke(this.formatter.format(e.Document.Relationships,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}})),path:"word/_rels/document.xml.rels"},Document:{data:(()=>{const o=this.imageReplacer.replace(u,l,a);return this.numberingReplacer.replace(o,e.Numbering.ConcreteNumbering)})(),path:"word/document.xml"},Styles:{data:(()=>{const o=ke(this.formatter.format(e.Styles,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}});return this.numberingReplacer.replace(o,e.Numbering.ConcreteNumbering)})(),path:"word/styles.xml"},Properties:{data:ke(this.formatter.format(e.CoreProperties,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/core.xml"},Numbering:{data:ke(this.formatter.format(e.Numbering,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/numbering.xml"},FileRelationships:{data:ke(this.formatter.format(e.FileRelationships,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"_rels/.rels"},HeaderRelationships:e.Headers.map((o,s)=>{const c=ke(this.formatter.format(o.View,{viewWrapper:o,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(c,e.Media).forEach((b,T)=>{o.Relationships.createRelationship(T,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${b.fileName}`)}),{data:ke(this.formatter.format(o.Relationships,{viewWrapper:o,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:`word/_rels/header${s+1}.xml.rels`}}),FooterRelationships:e.Footers.map((o,s)=>{const c=ke(this.formatter.format(o.View,{viewWrapper:o,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(c,e.Media).forEach((b,T)=>{o.Relationships.createRelationship(T,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${b.fileName}`)}),{data:ke(this.formatter.format(o.Relationships,{viewWrapper:o,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:`word/_rels/footer${s+1}.xml.rels`}}),Headers:e.Headers.map((o,s)=>{const c=ke(this.formatter.format(o.View,{viewWrapper:o,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),y=this.imageReplacer.getMediaData(c,e.Media),b=this.imageReplacer.replace(c,y,0);return{data:this.numberingReplacer.replace(b,e.Numbering.ConcreteNumbering),path:`word/header${s+1}.xml`}}),Footers:e.Footers.map((o,s)=>{const c=ke(this.formatter.format(o.View,{viewWrapper:o,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),y=this.imageReplacer.getMediaData(c,e.Media),b=this.imageReplacer.replace(c,y,0);return{data:this.numberingReplacer.replace(b,e.Numbering.ConcreteNumbering),path:`word/footer${s+1}.xml`}}),ContentTypes:{data:ke(this.formatter.format(e.ContentTypes,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"[Content_Types].xml"},CustomProperties:{data:ke(this.formatter.format(e.CustomProperties,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/custom.xml"},AppProperties:{data:ke(this.formatter.format(e.AppProperties,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/app.xml"},FootNotes:{data:ke(this.formatter.format(e.FootNotes.View,{viewWrapper:e.FootNotes,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"word/footnotes.xml"},FootNotesRelationships:{data:ke(this.formatter.format(e.FootNotes.Relationships,{viewWrapper:e.FootNotes,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"word/_rels/footnotes.xml.rels"},Settings:{data:ke(this.formatter.format(e.Settings,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/settings.xml"},Comments:{data:ke(this.formatter.format(e.Comments,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/comments.xml"},FontTable:{data:ke(this.formatter.format(e.FontTable.View,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/fontTable.xml"},FontTableRelationships:{data:ke(this.formatter.format(e.FontTable.Relationships,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"word/_rels/fontTable.xml.rels"}}}}const pf={WITH_2_BLANKS:"  "},Nt=t=>t===!0?pf.WITH_2_BLANKS:t===!1?void 0:t;class ua{static toString(e,r){return zt(this,null,function*(){return yield this.compiler.compile(e,Nt(r)).generateAsync({type:"string",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toBuffer(e,r){return zt(this,null,function*(){return yield this.compiler.compile(e,Nt(r)).generateAsync({type:"nodebuffer",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toBase64String(e,r){return zt(this,null,function*(){return yield this.compiler.compile(e,Nt(r)).generateAsync({type:"base64",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toBlob(e,r){return zt(this,null,function*(){return yield this.compiler.compile(e,Nt(r)).generateAsync({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toStream(e,r){const a=new In.Stream;return this.compiler.compile(e,Nt(r)).generateAsync({type:"nodebuffer",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"}).then(l=>{a.emit("data",l),a.emit("end")}),a}}re(ua,"compiler",new hf);var Ot=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ca={exports:{}};(function(t,e){(function(r,a){a()})(Ot,function(){function r(y,b){return typeof b>"u"?b={autoBom:!1}:typeof b!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),b={autoBom:!b}),b.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(y.type)?new Blob(["\uFEFF",y],{type:y.type}):y}function a(y,b,T){var x=new XMLHttpRequest;x.open("GET",y),x.responseType="blob",x.onload=function(){c(x.response,b,T)},x.onerror=function(){console.error("could not download file")},x.send()}function u(y){var b=new XMLHttpRequest;b.open("HEAD",y,!1);try{b.send()}catch{}return 200<=b.status&&299>=b.status}function l(y){try{y.dispatchEvent(new MouseEvent("click"))}catch{var b=document.createEvent("MouseEvents");b.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),y.dispatchEvent(b)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Ot=="object"&&Ot.global===Ot?Ot:void 0,s=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),c=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(y,b,T){var x=o.URL||o.webkitURL,w=document.createElement("a");b=b||y.name||"download",w.download=b,w.rel="noopener",typeof y=="string"?(w.href=y,w.origin===location.origin?l(w):u(w.href)?a(y,b,T):l(w,w.target="_blank")):(w.href=x.createObjectURL(y),setTimeout(function(){x.revokeObjectURL(w.href)},4e4),setTimeout(function(){l(w)},0))}:"msSaveOrOpenBlob"in navigator?function(y,b,T){if(b=b||y.name||"download",typeof y!="string")navigator.msSaveOrOpenBlob(r(y,T),b);else if(u(y))a(y,b,T);else{var x=document.createElement("a");x.href=y,x.target="_blank",setTimeout(function(){l(x)})}}:function(y,b,T,x){if(x=x||open("","_blank"),x&&(x.document.title=x.document.body.innerText="downloading..."),typeof y=="string")return a(y,b,T);var w=y.type==="application/octet-stream",E=/constructor/i.test(o.HTMLElement)||o.safari,v=/CriOS\/[\d]+/.test(navigator.userAgent);if((v||w&&E||s)&&typeof FileReader<"u"){var A=new FileReader;A.onloadend=function(){var k=A.result;k=v?k:k.replace(/^data:[^;]*;/,"data:attachment/file;"),x?x.location.href=k:location=k,x=null},A.readAsDataURL(y)}else{var p=o.URL||o.webkitURL,S=p.createObjectURL(y);x?x.location=S:location.href=S,x=null,setTimeout(function(){p.revokeObjectURL(S)},4e4)}});o.saveAs=c.saveAs=c,t.exports=c})})(ca);var mf=ca.exports;async function wf(){const t=ye.get().resume,e={primary:"Times New Roman"},r={NAME:32,BODY:24},a=[];a.push(new xe({text:(t.personal.firstName+" "+t.personal.lastName).toUpperCase(),heading:_l.TITLE,alignment:Ne.CENTER,style:"ResumeTitle",spacing:{after:0}}),new xe({text:(t.personal.jobTitle||"").toUpperCase(),alignment:Ne.CENTER,style:"JobTitle",spacing:{before:50,after:0}}),new xe({text:[t.personal.city,t.personal.country].filter(Boolean).join(", "),alignment:Ne.CENTER,style:"SmallInfo",spacing:{before:50,after:0}}),new xe({text:[t.personal.email,t.personal.phone].filter(Boolean).join(" | "),alignment:Ne.CENTER,style:"SmallInfo",spacing:{before:50,after:0}}),new xe({text:[t.personal.linkedin,t.personal.address,...t.socials.map(c=>c.url)].filter(Boolean).join(" | "),alignment:Ne.CENTER,style:"SmallInfo",spacing:{before:50,after:200},border:{bottom:{color:"000000",space:5,value:"single",size:6}}}));const u=c=>new xe({children:[new Pe({text:c.toUpperCase(),bold:!0,font:e.primary,size:28})],shading:{fill:"E0E0E0",color:"auto",type:"clear"},spacing:{before:240,after:120},alignment:Ne.LEFT}),l=(c,y,b=!0)=>new xe({children:[new Pe({text:c,bold:b,font:e.primary,size:24}),new Pe({text:"	"+(y||""),bold:b,font:e.primary,size:24})],tabStops:[{type:tr.RIGHT,position:10300}],spacing:{after:0}}),o=(c,y)=>new xe({children:[new Pe({text:c,italics:!0,font:e.primary,size:24}),new Pe({text:"	"+(y||""),italics:!0,font:e.primary,size:24})],tabStops:[{type:tr.RIGHT,position:10300}],spacing:{after:50}});if(t.summary&&t.summary.trim()&&(a.push(u("PROFESSIONAL SUMMARY")),a.push(new xe({text:t.summary,style:"Normal"}))),t.experience.length>0&&(a.push(u("EXPERIENCE")),t.experience.forEach(c=>{a.push(l(c.jobTitle,`${c.startDate} â€“ ${c.endDate}`)),a.push(o(c.employer,c.city)),c.desc.split(`
`).filter(b=>b.trim()).forEach(b=>{a.push(new xe({text:b,bullet:{level:0},style:"Normal",spacing:{after:0}}))}),a.push(new xe({text:"",spacing:{after:120}}))})),t.education.length>0&&(a.push(u("EDUCATION")),t.education.forEach(c=>{a.push(l(c.institution,`${c.startDate} â€“ ${c.endDate}`)),a.push(o(c.degree,c.city)),c.desc&&a.push(new xe({text:c.desc,style:"Normal"})),a.push(new xe({text:"",spacing:{after:120}}))})),t.skills.length>0){a.push(u("SKILLS"));const c=[];for(let y=0;y<t.skills.length;y+=2){const b=t.skills[y],T=t.skills[y+1];c.push(new ku({children:[new nr({children:[new xe({children:[new Pe({text:"â€¢ ",font:e.primary}),new Pe({text:b.name,bold:!0,font:e.primary,size:24})]})],borders:{top:{style:Ie.NONE},bottom:{style:Ie.NONE},left:{style:Ie.NONE},right:{style:Ie.NONE}}}),new nr({children:[T?new xe({children:[new Pe({text:"â€¢ ",font:e.primary}),new Pe({text:T.name,bold:!0,font:e.primary,size:24})]}):new xe({})],borders:{top:{style:Ie.NONE},bottom:{style:Ie.NONE},left:{style:Ie.NONE},right:{style:Ie.NONE}}})]}))}a.push(new Eu({rows:c,width:{size:100,type:rr.PERCENTAGE},borders:{top:{style:Ie.NONE},bottom:{style:Ie.NONE},left:{style:Ie.NONE},right:{style:Ie.NONE},insideHorizontal:{style:Ie.NONE},insideVertical:{style:Ie.NONE}}}))}if(t.languages.length>0){a.push(u("LANGUAGES"));const c=t.languages.map(y=>`${y.language} (${y.proficiency})`).join("  â€¢  ");a.push(new xe({text:c,style:"Normal"}))}t.projects.length>0&&(a.push(u("PROJECTS")),t.projects.forEach(c=>{a.push(new xe({children:[new Pe({text:c.title,bold:!0,font:e.primary,size:24})],spacing:{after:0}})),a.push(new xe({text:c.desc,style:"Normal",spacing:{after:120}}))})),t.certifications.length>0&&(a.push(u("CERTIFICATIONS")),t.certifications.forEach(c=>{a.push(new xe({text:c.name,bullet:{level:0},style:"Normal",spacing:{after:0}}))})),t.awards.length>0&&(a.push(u("AWARDS")),t.awards.forEach(c=>{a.push(new xe({children:[new Pe({text:c.name,bold:!0}),new Pe({text:c.desc?" - "+c.desc:""})],bullet:{level:0},style:"Normal",spacing:{after:0}}))})),t.interests&&(a.push(u("INTERESTS")),a.push(new xe({text:t.interests,style:"Normal"}))),t.references.length>0&&(a.push(u("REFERENCES")),t.references.forEach(c=>{a.push(new xe({children:[new Pe({text:`${c.name} (${c.contact})`})],bullet:{level:0},style:"Normal",spacing:{after:0}}))})),t.custom.length>0&&t.custom.forEach(c=>{a.push(u(c.title)),a.push(new xe({text:c.content,style:"Normal"}))});const s=new Xc({styles:{paragraphStyles:[{id:"ResumeTitle",name:"Resume Title",run:{font:e.primary,size:r.NAME,bold:!0,color:"000000"}},{id:"JobTitle",name:"Job Title",run:{font:e.primary,size:24,smallCaps:!0,color:"000000"}},{id:"SmallInfo",name:"Small Info",run:{font:e.primary,size:20,color:"000000"}},{id:"Normal",name:"Normal",run:{font:e.primary,size:r.BODY,color:"000000"}}]},sections:[{properties:{page:{margin:{top:720,right:720,bottom:720,left:720},borders:t.meta.border?{pageBorder:{style:Ie.SINGLE,size:12,color:"000000",display:"allPages",offsetFrom:"page"}}:void 0}},children:a}]});try{const c=await ua.toBlob(s);mf.saveAs(c,`${(t.personal.firstName+"_"+t.personal.lastName).replace(/\s+/g,"_")||"Resume"}.docx`)}catch(c){console.error(c),alert("Error generating resume")}}const gf=()=>ye.get().resume,yf=()=>{const t=gf();let e=0;return t.personal.fullName&&(e+=10),t.personal.email&&(e+=10),t.personal.phone&&(e+=5),t.summary&&(e+=10),t.education.length>0&&(e+=15),t.experience.length>0&&(e+=20),t.skills.length>0&&(e+=15),t.projects.length>0&&(e+=10),t.additional&&(e+=5),Math.min(100,e)},et={LATENCY:1500,improveExperience:async(t,e,r)=>new Promise(a=>{setTimeout(()=>{const u=[`Spearheaded key initiatives at ${e||"the company"}, driving operational efficiency and process improvements.`,`Collaborated with cross-functional teams to deliver high-quality solutions for ${t||"various projects"}, ensuring timely execution.`,"Analyzed complex data sets to identify trends and optimize performance metrics, resulting in measurable growth.","Mentored junior team members and fostered a culture of continuous learning and professional development."];a(u.join(`
`))},et.LATENCY)}),generateSummary:async(t,e)=>new Promise(r=>{setTimeout(()=>{const a=`Results-oriented ${t||"Professional"} with a proven track record. Skilled in ${e.slice(0,3).map(u=>u.name).join(", ")||"various technologies"} and dedicated to driving organizational success. Adept at problem-solving and leveraging data-driven insights to achieve strategic goals. Committed to delivering excellence and continuously expanding professional expertise.`;r(a)},et.LATENCY)}),suggestSkills:async t=>new Promise(e=>{setTimeout(()=>{const r=["React","Node.js","TypeScript","Docker","AWS","Python","SQL","Git","Agile","Figma"],a=t.map(l=>l.name.toLowerCase()),u=r.filter(l=>!a.includes(l.toLowerCase()));e(u.slice(0,5))},et.LATENCY)}),analyzeJobMatch:async(t,e)=>new Promise(r=>{setTimeout(()=>{const a=["leadership","communication","python","javascript","project management","agile","data analysis"],u=e.toLowerCase(),l=JSON.stringify(t).toLowerCase(),o=a.filter(c=>u.includes(c)&&!l.includes(c)),s=Math.max(10,Math.min(95,100-o.length*10));r({score:s,missingKeywords:o,suggestions:o.length>0?[`Consider adding keywords like "${o[0]}" and "${o[1]||"others"}" to your resume to match the job description.`]:["Great match! Your resume aligns well with the job description."]})},et.LATENCY)})};let ar=null;function vf(t){ar=t,bf(),xf(),gt(),Mt()}function bf(){ar.innerHTML=`
        <div class="builder-layout">
            <!-- Left Pane: Editor -->
            <aside class="editor-pane">
                <div style="padding: 1.5rem; border-bottom: 1px solid rgba(0,0,0,0.05); display:flex; align-items:center; gap:0.5rem;">
               <div style="width:24px; height:24px; background:var(--grad-primary); border-radius:4px;"></div>
               <h2 style="font-family:'Outfit', sans-serif; font-weight:700; font-size:1.25rem;">Formatly</h2>
            </div>
                <nav class="step-nav">
                    ${["Contacts","Experience","Education","Skills","Summary","Add-ons","Finalize"].map((t,e)=>`
                        <div class="step-tab ${e===0?"active":""}" data-step="${e+1}">
                            <div class="step-indicator">${e+1}</div>
                            <span>${t}</span>
                        </div>
                    `).join("")}
                </nav>

                <div class="form-container">
                    <!-- Step 1: Contacts -->
                    <div id="step-1" class="form-step-content">
                        <div class="section-header">
                            <h2>Personal Details</h2>
                            <p>Get started with the basics.</p>
                        </div>
                        <div class="flex-row">
                            <div class="input-group w-full">
                                <label>First Name</label>
                                <input type="text" data-path="resume.personal.firstName" placeholder="e.g. John">
                            </div>
                            <div class="input-group w-full">
                                <label>Last Name</label>
                                <input type="text" data-path="resume.personal.lastName" placeholder="e.g. Doe">
                            </div>
                        </div>
                        <div class="input-group">
                            <label>Job Title</label>
                            <input type="text" data-path="resume.personal.jobTitle" placeholder="e.g. Senior Software Engineer">
                        </div>
                        <div class="input-group">
                            <label>Email</label>
                            <input type="email" data-path="resume.personal.email" placeholder="e.g. john@example.com">
                        </div>
                        <div class="input-group">
                            <label>Phone</label>
                            <input type="tel" data-path="resume.personal.phone" placeholder="e.g. +1 555 123 4567">
                        </div>
                        
                        <h4 class="mt-4 mb-2">Location</h4>
                        <div class="flex-row">
                            <div class="input-group w-full">
                                <label>City</label>
                                <input type="text" data-path="resume.personal.city" placeholder="e.g. New York">
                            </div>
                            <div class="input-group w-full">
                                <label>Country</label>
                                <input type="text" data-path="resume.personal.country" placeholder="e.g. USA">
                            </div>
                        </div>
                         <div class="flex-row">
                            <div class="input-group w-full">
                                <label>Address</label>
                                <input type="text" data-path="resume.personal.address" placeholder="e.g. 123 Main St">
                            </div>
                             <div class="input-group w-full">
                                <label>Postal Code</label>
                                <input type="text" data-path="resume.personal.postalCode" placeholder="e.g. 10001">
                            </div>
                        </div>

                        <button class="btn btn-primary w-full mt-4" onclick="window.nextStep()">Next: Experience</button>
                    </div>

                    <!-- Step 2: Experience -->
                    <div id="step-2" class="form-step-content hidden">
                        <div class="section-header">
                            <h2>Experience</h2>
                            <p>Add your work history. (Most recent first)</p>
                        </div>
                        <div id="experience-list"></div>
                        <button class="btn btn-secondary add-btn" id="add-exp-btn">+ Add Experience</button>
                        <div class="flex-row mt-4">
                             <button class="btn btn-secondary" onclick="window.prevStep()">Back</button>
                             <button class="btn btn-primary" onclick="window.nextStep()">Next: Education</button>
                        </div>
                    </div>

                    <!-- Step 3: Education -->
                    <div id="step-3" class="form-step-content hidden">
                         <div class="section-header">
                            <h2>Education</h2>
                            <p>Your academic background.</p>
                        </div>
                        <div id="education-list"></div>
                        <button class="btn btn-secondary add-btn" id="add-edu-btn">+ Add Education</button>
                         <div class="flex-row mt-4">
                             <button class="btn btn-secondary" onclick="window.prevStep()">Back</button>
                             <button class="btn btn-primary" onclick="window.nextStep()">Next: Skills</button>
                        </div>
                    </div>

                    <!-- Step 4: Skills -->
                    <div id="step-4" class="form-step-content hidden">
                        <div class="section-header">
                            <h2>Skills</h2>
                            <p>Technical & Soft Skills.</p>
                        </div>
                        <div id="skills-list" style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;"></div>
                        
                        <div id="ai-skills-suggestions" style="display:flex; flex-wrap:wrap; gap:0.5rem; margin-top:10px; margin-bottom:10px;"></div>
                        
                        <div class="flex-row" style="gap:10px;">
                            <button class="btn-ai" id="ai-suggest-skills">âœ¨ Suggest Skills</button>
                            <button class="btn btn-secondary add-btn" id="add-skill-btn">+ Add Skill</button>
                        </div>
                         <div class="flex-row mt-4">
                             <button class="btn btn-secondary" onclick="window.prevStep()">Back</button>
                             <button class="btn btn-primary" onclick="window.nextStep()">Next: Summary</button>
                        </div>
                    </div>

                    <!-- Step 5: Summary -->
                    <div id="step-5" class="form-step-content hidden">
                         <div class="section-header">
                            <h2>Professional Summary</h2>
                            <p>Summarize your career highlights.</p>
                        </div>
                        <div class="input-group">
                            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:0.5rem;">
                                <label>Professional Summary</label>
                                <button type="button" class="btn-ai" id="ai-generate-summary">âœ¨ Turn Pro</button>
                            </div>
                            <textarea rows="6" data-path="resume.summary" placeholder="e.g. Experienced Project Manager..."></textarea>
                        </div>
                         <div class="flex-row mt-4">
                             <button class="btn btn-secondary" onclick="window.prevStep()">Back</button>
                             <button class="btn btn-primary" onclick="window.nextStep()">Next: Add-ons</button>
                        </div>
                    </div>

                    <!-- Step 6: Add-ons (Projects / Langs / Certs) -->
                    <div id="step-6" class="form-step-content hidden">
                         <div class="section-header">
                            <h2>Additional Sections</h2>
                            <p>Add Projects, Languages, Certifications, etc.</p>
                        </div>
                        
                        <!-- Projects Accordion -->
                        <details class="card-entry" open>
                            <summary class="card-header" style="cursor:pointer; list-style:none;"><b>ðŸ“‚ Projects</b></summary>
                            <div id="projects-list"></div>
                            <button class="btn btn-secondary add-btn" id="add-proj-btn">+ Add Project</button>
                        </details>

                        <!-- Languages Accordion -->
                        <details class="card-entry">
                             <summary class="card-header" style="cursor:pointer; list-style:none;"><b>ðŸ—£ Languages</b></summary>
                             <div id="languages-list"></div>
                             <button class="btn btn-secondary add-btn" id="add-lang-btn">+ Add Language</button>
                        </details>

                        <!-- Certifications Accordion -->
                        <details class="card-entry">
                             <summary class="card-header" style="cursor:pointer; list-style:none;"><b>ðŸ† Certifications</b></summary>
                             <div id="certs-list"></div>
                             <button class="btn btn-secondary add-btn" id="add-cert-btn">+ Add Certification</button>
                        </details>

                        <!-- Awards Accordion -->
                        <details class="card-entry">
                             <summary class="card-header" style="cursor:pointer; list-style:none;"><b>ðŸŽ– Awards</b></summary>
                             <div id="awards-list"></div>
                             <button class="btn btn-secondary add-btn" id="add-award-btn">+ Add Award</button>
                        </details>

                        <!-- Socials Accordion -->
                        <details class="card-entry">
                             <summary class="card-header" style="cursor:pointer; list-style:none;"><b>ðŸ”— Socials / Websites</b></summary>
                             <div id="socials-list"></div>
                             <button class="btn btn-secondary add-btn" id="add-social-btn">+ Add Link</button>
                        </details>

                        <!-- References Accordion -->
                        <details class="card-entry">
                             <summary class="card-header" style="cursor:pointer; list-style:none;"><b>ðŸ‘¥ References</b></summary>
                             <div id="refs-list"></div>
                             <button class="btn btn-secondary add-btn" id="add-ref-btn">+ Add Reference</button>
                        </details>
                        
                        <!-- Interests -->
                         <div class="input-group mt-4">
                            <label>Hobbies & Interests</label>
                            <textarea rows="3" data-path="resume.interests" placeholder="e.g. Photography, Marathon Running..."></textarea>
                        </div>

                        <!-- Custom Section -->
                        <details class="card-entry">
                             <summary class="card-header" style="cursor:pointer; list-style:none;"><b>âž• Custom Section</b></summary>
                             <div id="custom-list"></div>
                             <button class="btn btn-secondary add-btn" id="add-custom-btn">+ Add Custom Entry</button>
                        </details>



                        <div class="flex-row mt-4">
                             <button class="btn btn-secondary" onclick="window.prevStep()">Back</button>
                             <button class="btn btn-primary" onclick="window.nextStep()">Next: Finalize</button>
                        </div>
                    </div>

                    <!-- Step 7: Finalize -->
                    <div id="step-7" class="form-step-content hidden">
                         <div class="section-header">
                            <h2>Finalize & Export</h2>
                            <p>Review and download.</p>
                        </div>
                        
                        <div class="card-entry">
                            <div class="input-group">
                                <label style="display:flex; align-items:center; cursor:pointer;">
                                    <input type="checkbox" id="border-toggle" style="width:auto; margin-right:0.5rem;"> 
                                    <b>Add Page Border (1.5pt Black)</b>
                                </label>
                            </div>
                        </div>

                        <div class="card-entry" style="background: #f0fdf4; border-color: #bbf7d0;">
                            <h4>âœ… Checklist</h4>
                            <ul style="padding-left:1.2rem; font-size:0.9rem; color: #166534; margin-top:0.5rem;">
                                <li>Check for spelling errors.</li>
                                <li>Ensure contact details are correct.</li>
                                <li>Verify dates in experience.</li>
                            </ul>
                        </div>

                        <!-- Job Analysis -->
                        <div class="card-entry" style="border-color: #818cf8; background: #eef2ff;">
                            <h4 style="color:#4338ca;">ðŸŽ¯ Job Match Analysis</h4>
                            <p style="font-size:0.9rem; color:#6366f1; margin-bottom:0.5rem;">Paste the job description to see how well you match.</p>
                            <textarea id="job-desc-input" rows="4" placeholder="Paste Job Description here..." style="width:100%; border:1px solid #c7d2fe; padding:0.5rem; border-radius:0.3rem;"></textarea>
                            <button class="btn-ai w-full mt-2" id="ai-analyze-job">âœ¨ Analyze Match</button>
                            
                            <div id="ai-job-result" style="margin-top:1rem; display:none;">
                                <div style="display:flex; justify-content:space-between; align-items:center;">
                                    <b>Match Score:</b>
                                    <span id="ai-match-score" style="font-size:1.2rem; font-weight:bold; color:#4338ca;">0%</span>
                                </div>
                                <div id="ai-missing-keywords" style="margin-top:0.5rem; font-size:0.9rem;"></div>
                            </div>
                        </div>

                         <div class="flex-row mt-4">
                             <button class="btn btn-secondary" onclick="window.prevStep()">Back</button>
                             <button class="btn btn-primary" id="download-btn">Download .DOCX</button>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Right Pane: Preview -->
            <main class="preview-pane">
                <div class="ats-score-bar">
                    <span>ATS Score</span>
                    <div class="score-circle"></div>
                    <span id="score-text">0%</span>
                </div>
                <div id="resume-preview" class="resume-paper"></div>
            </main>
        </div>
    `,Ef()}function xf(){ar.addEventListener("input",r=>{r.target.dataset.path&&(ye.update(r.target.dataset.path,r.target.value),gt(),Mt())});const t=document.getElementById("border-toggle");t&&t.addEventListener("change",r=>{ye.update("resume.meta.border",r.target.checked),gt()}),window.currentStep=1,window.nextStep=()=>dn(window.currentStep+1),window.prevStep=()=>dn(window.currentStep-1),ar.querySelectorAll(".step-tab").forEach(r=>{r.addEventListener("click",()=>{const a=parseInt(r.dataset.step);dn(a)})});const e=(r,a,u,l)=>{const o=document.getElementById(r);o&&o.addEventListener("click",()=>{ye.addItem(a,{id:Date.now(),...u}),l()})};e("add-exp-btn","resume.experience",{jobTitle:"",employer:"",city:"",startDate:"",endDate:"",desc:""},zn),e("add-edu-btn","resume.education",{institution:"",degree:"",city:"",startDate:"",endDate:"",desc:""},Wn),e("add-skill-btn","resume.skills",{name:"",level:""},wr),e("add-proj-btn","resume.projects",{title:"",link:"",desc:""},Hn),e("add-lang-btn","resume.languages",{language:"",proficiency:""},Gn),e("add-cert-btn","resume.certifications",{name:"",issuer:"",date:""},Kn),e("add-award-btn","resume.awards",{name:"",date:"",desc:""},qn),e("add-social-btn","resume.socials",{network:"",url:""},$n),e("add-ref-btn","resume.references",{name:"",contact:""},Vn),e("add-custom-btn","resume.custom",{title:"",content:""},Xn),Sf(),document.getElementById("download-btn").addEventListener("click",()=>{wf()})}function dn(t){t<1||t>7||(window.currentStep=t,_f(t))}function _f(t){const e=["step-1","step-2","step-3","step-4","step-5","step-6","step-7"];document.querySelectorAll(".form-step-content").forEach(u=>u.classList.add("hidden"));const a=document.getElementById(e[t-1]);a&&(a.classList.remove("hidden"),a.style.animation="none",a.offsetHeight,a.style.animation="slideInRight 0.3s ease"),document.querySelectorAll(".step-tab").forEach((u,l)=>{l===t-1?u.classList.add("active"):u.classList.remove("active")})}function mr(t,e,r,a,u){return`
    <details class="card-entry" open>
        <summary class="card-header" style="cursor:pointer; list-style:none; display:flex; justify-content:space-between; align-items:center;">
            <b>${e||"(New Entry)"}</b>
            <button class="btn btn-danger" style="padding:2px 8px;" onclick="window.removeGlItem('${r}', ${t.id}, '${u}')">x</button>
        </summary>
        ${a(t)}
    </details>`}function zn(){const t=ye.get().resume.experience;document.getElementById("experience-list").innerHTML=t.map(e=>mr(e,e.jobTitle,"resume.experience",r=>`
        <div class="input-group"><input type="text" value="${r.jobTitle}" placeholder="Job Title" oninput="window.updateGlItem('resume.experience', ${r.id}, 'jobTitle', this.value)"></div>
        <div class="input-group"><input type="text" value="${r.employer}" placeholder="Employer" oninput="window.updateGlItem('resume.experience', ${r.id}, 'employer', this.value)"></div>
        <div class="flex-row">
            <div class="input-group w-full"><input type="text" value="${r.startDate}" placeholder="Start Date" oninput="window.updateGlItem('resume.experience', ${r.id}, 'startDate', this.value)"></div>
            <div class="input-group w-full"><input type="text" value="${r.endDate}" placeholder="End Date" oninput="window.updateGlItem('resume.experience', ${r.id}, 'endDate', this.value)"></div>
        </div>
         <div class="input-group"><input type="text" value="${r.city}" placeholder="City, Country" oninput="window.updateGlItem('resume.experience', ${r.id}, 'city', this.value)"></div>
        <div class="input-group">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:0.2rem;">
                 <label>Description</label> 
                 <button class="btn-ai" style="font-size:0.7rem; padding:0.2rem 0.5rem;" onclick="window.improveExperience(${r.id})">âœ¨ Improve</button>
            </div>
            <textarea id="exp-desc-${r.id}" placeholder="Description (Bullet points)" oninput="window.updateGlItem('resume.experience', ${r.id}, 'desc', this.value)">${r.desc}</textarea>
        </div>
    `,"exp")).join("")}function Wn(){const t=ye.get().resume.education;document.getElementById("education-list").innerHTML=t.map(e=>mr(e,e.institution,"resume.education",r=>`
        <div class="input-group"><input type="text" value="${r.institution}" placeholder="School / University" oninput="window.updateGlItem('resume.education', ${r.id}, 'institution', this.value)"></div>
        <div class="input-group"><input type="text" value="${r.degree}" placeholder="Degree / Course" oninput="window.updateGlItem('resume.education', ${r.id}, 'degree', this.value)"></div>
        <div class="flex-row">
            <div class="input-group w-full"><input type="text" value="${r.startDate}" placeholder="Start Date" oninput="window.updateGlItem('resume.education', ${r.id}, 'startDate', this.value)"></div>
            <div class="input-group w-full"><input type="text" value="${r.endDate}" placeholder="End Date" oninput="window.updateGlItem('resume.education', ${r.id}, 'endDate', this.value)"></div>
        </div>
        <div class="input-group"><textarea placeholder="Description (Optional)" oninput="window.updateGlItem('resume.education', ${r.id}, 'desc', this.value)">${r.desc}</textarea></div>
    `,"edu")).join("")}function wr(){const t=ye.get().resume.skills;document.getElementById("skills-list").innerHTML=t.map(e=>`
        <div style="background:white; border:1px solid #e2e8f0; padding:10px; border-radius:8px; display:flex; gap:5px;">
             <input type="text" value="${e.name}" placeholder="Skill" oninput="window.updateGlItem('resume.skills', ${e.id}, 'name', this.value)">
             <button class="btn btn-danger" onclick="window.removeGlItem('resume.skills', ${e.id}, 'skill')">x</button>
        </div>
    `).join("")}function Hn(){const t=ye.get().resume.projects;document.getElementById("projects-list").innerHTML=t.map(e=>mr(e,e.title,"resume.projects",r=>`
        <div class="input-group"><input type="text" value="${r.title}" placeholder="Project Title" oninput="window.updateGlItem('resume.projects', ${r.id}, 'title', this.value)"></div>
        <div class="input-group"><textarea placeholder="Description" oninput="window.updateGlItem('resume.projects', ${r.id}, 'desc', this.value)">${r.desc}</textarea></div>
    `,"proj")).join("")}function Gn(){const t=ye.get().resume.languages;document.getElementById("languages-list").innerHTML=t.map(e=>`
        <div style="background:white; border:1px solid #e2e8f0; padding:10px; border-radius:8px; display:flex; gap:5px; margin-bottom:10px;">
             <input type="text" value="${e.language}" placeholder="Language" oninput="window.updateGlItem('resume.languages', ${e.id}, 'language', this.value)">
             <input type="text" value="${e.proficiency}" placeholder="Proficiency (e.g. Native)" oninput="window.updateGlItem('resume.languages', ${e.id}, 'proficiency', this.value)">
             <button class="btn btn-danger" onclick="window.removeGlItem('resume.languages', ${e.id}, 'lang')">x</button>
        </div>
    `).join("")}function Kn(){const t=ye.get().resume.certifications;document.getElementById("certs-list").innerHTML=t.map(e=>`
        <div style="background:white; border:1px solid #e2e8f0; padding:10px; border-radius:8px; margin-bottom:10px;">
             <div style="display:flex; justify-content:space-between;"><b>Certification</b> <button class="btn btn-danger" onclick="window.removeGlItem('resume.certifications', ${e.id}, 'cert')">x</button></div>
             <input type="text" value="${e.name}" placeholder="Name" class="mt-4" oninput="window.updateGlItem('resume.certifications', ${e.id}, 'name', this.value)">
        </div>
    `).join("")}function qn(){const t=ye.get().resume.awards;document.getElementById("awards-list").innerHTML=t.map(e=>`
        <div style="background:white; border:1px solid #e2e8f0; padding:10px; border-radius:8px; margin-bottom:10px;">
             <div style="display:flex; justify-content:space-between;"><b>Award</b> <button class="btn btn-danger" onclick="window.removeGlItem('resume.awards', ${e.id}, 'award')">x</button></div>
             <input type="text" value="${e.name}" placeholder="Award Name" class="mt-4" oninput="window.updateGlItem('resume.awards', ${e.id}, 'name', this.value)">
             <input type="text" value="${e.desc}" placeholder="Description" class="mt-4" oninput="window.updateGlItem('resume.awards', ${e.id}, 'desc', this.value)">
        </div>
    `).join("")}function $n(){const t=ye.get().resume.socials;document.getElementById("socials-list").innerHTML=t.map(e=>`
        <div style="background:white; border:1px solid #e2e8f0; padding:10px; border-radius:8px; margin-bottom:10px;">
             <div style="display:flex; justify-content:space-between;"><b>Link</b> <button class="btn btn-danger" onclick="window.removeGlItem('resume.socials', ${e.id}, 'social')">x</button></div>
             <input type="text" value="${e.network}" placeholder="Platform (e.g. GitHub)" class="mt-4" oninput="window.updateGlItem('resume.socials', ${e.id}, 'network', this.value)">
             <input type="text" value="${e.url}" placeholder="URL" class="mt-4" oninput="window.updateGlItem('resume.socials', ${e.id}, 'url', this.value)">
        </div>
    `).join("")}function Vn(){const t=ye.get().resume.references;document.getElementById("refs-list").innerHTML=t.map(e=>`
        <div style="background:white; border:1px solid #e2e8f0; padding:10px; border-radius:8px; margin-bottom:10px;">
             <div style="display:flex; justify-content:space-between;"><b>Reference</b> <button class="btn btn-danger" onclick="window.removeGlItem('resume.references', ${e.id}, 'ref')">x</button></div>
             <input type="text" value="${e.name}" placeholder="Name" class="mt-4" oninput="window.updateGlItem('resume.references', ${e.id}, 'name', this.value)">
             <input type="text" value="${e.contact}" placeholder="Contact Info" class="mt-4" oninput="window.updateGlItem('resume.references', ${e.id}, 'contact', this.value)">
        </div>
    `).join("")}function Xn(){const t=ye.get().resume.custom;document.getElementById("custom-list").innerHTML=t.map(e=>mr(e,e.title,"resume.custom",r=>`
        <div class="input-group"><input type="text" value="${r.title}" placeholder="Section Title" oninput="window.updateGlItem('resume.custom', ${r.id}, 'title', this.value)"></div>
        <div class="input-group"><textarea placeholder="Content" oninput="window.updateGlItem('resume.custom', ${r.id}, 'content', this.value)">${r.content}</textarea></div>
`,"custom")).join("")}window.updateGlItem=(t,e,r,a)=>{const u=t.split(".");let l=ye.get();for(let s of u)l=l[s];const o=l.find(s=>s.id===e);o&&(o[r]=a,ye.update(t,l),gt(),Mt())};window.removeGlItem=(t,e,r)=>{ye.removeItem(t,e),r==="exp"&&zn(),r==="edu"&&Wn(),r==="skill"&&wr(),r==="proj"&&Hn(),r==="lang"&&Gn(),r==="cert"&&Kn(),r==="award"&&qn(),r==="social"&&$n(),r==="ref"&&Vn(),r==="custom"&&Xn(),gt(),Mt()};function Ef(){const t=ye.get().resume;document.querySelectorAll("input[data-path]").forEach(e=>{const r=e.dataset.path.split(".");let a=t;for(let u of r.slice(1))a=a[u];e.value=a||""}),zn(),Wn(),wr(),Hn(),Gn(),Kn(),qn(),$n(),Vn(),Xn()}function Qt(t){const e=ye.get(),r=e.aiUsage[t],a=e.limits.free;return r>=a?(alert(`You have reached the free limit for ${t} generations (${a}/${a}). Upgrade to Premium for unlimited AI.`),!1):(e.aiUsage[t]++,ye.update(`aiUsage.${t}`,e.aiUsage[t]),!0)}function Qe(t,e){e?(t.dataset.text=t.innerText,t.innerHTML='<span class="loading-spinner"></span> Generating...',t.disabled=!0):(t.innerHTML=t.dataset.text,t.disabled=!1)}window.improveExperience=async t=>{if(!Qt("experience"))return;const r=ye.get().resume.experience.find(u=>u.id===t);if(!r)return;const a=document.querySelector(`button[onclick="window.improveExperience(${t})"]`);Qe(a,!0);try{const u=await et.improveExperience(r.jobTitle,r.employer,r.desc);window.updateGlItem("resume.experience",t,"desc",u);const l=document.getElementById(`exp-desc-${t}`);l&&(l.value=u)}catch(u){alert("AI Error: "+u.message)}finally{Qe(a,!1)}};function Sf(){const t=document.getElementById("ai-generate-summary");t&&t.addEventListener("click",async()=>{if(Qt("summary")){Qe(t,!0);try{const a=ye.get().resume,u=await et.generateSummary(a.personal.jobTitle,a.skills);ye.update("resume.summary",u),document.querySelector('textarea[data-path="resume.summary"]').value=u,gt(),Mt()}catch(a){alert(a.message)}finally{Qe(t,!1)}}});const e=document.getElementById("ai-suggest-skills");e&&e.addEventListener("click",async()=>{if(Qt("skills")){Qe(e,!0);try{const a=ye.get().resume.skills,u=await et.suggestSkills(a),l=document.getElementById("ai-skills-suggestions");l.innerHTML=u.map(o=>`
                    <div class="suggestion-chip" onclick="window.addSuggestedSkill('${o}')">+ ${o}</div>
                 `).join("")}catch(a){alert(a.message)}finally{Qe(e,!1)}}});const r=document.getElementById("ai-analyze-job");r&&r.addEventListener("click",async()=>{if(!Qt("jobMatch"))return;const a=document.getElementById("job-desc-input").value;if(!a.trim()){alert("Please paste a job description first.");return}Qe(r,!0);try{const u=await et.analyzeJobMatch(ye.get().resume,a);document.getElementById("ai-job-result").style.display="block",document.getElementById("ai-match-score").innerText=u.score+"%";const l=u.score>75?"green":u.score>50?"orange":"red";document.getElementById("ai-match-score").style.color=l,document.getElementById("ai-missing-keywords").innerHTML=`
                    <p><b>Missing Keywords:</b> ${u.missingKeywords.join(", ")||"None found!"}</p>
                    <ul style="margin-top:5px; padding-left:15px; color:#555;">
                        ${u.suggestions.map(o=>`<li>${o}</li>`).join("")}
                    </ul>
                 `}catch(u){alert(u.message)}finally{Qe(r,!1)}})}window.addSuggestedSkill=t=>{ye.addItem("resume.skills",{id:Date.now(),name:t,level:"Intermediate"}),wr(),document.querySelectorAll(".suggestion-chip").forEach(r=>{r.innerText.includes(t)&&r.remove()})};function Mt(){const t=yf(),e=document.getElementById("score-text"),r=document.querySelector(".score-circle"),a=Math.round(t);let u=0;try{u=parseInt(e.innerText)||0}catch{}const l=1e3,o=performance.now();function s(c){const y=c-o,b=Math.min(y/l,1),T=1-Math.pow(1-b,3),x=Math.floor(u+(a-u)*T);e.innerText=x+"%",x<50?(e.style.color="var(--danger)",r.style.backgroundColor="var(--danger)"):x<80?(e.style.color="var(--warning)",r.style.backgroundColor="var(--warning)"):(e.style.color="var(--success)",r.style.backgroundColor="var(--success)"),b<1&&requestAnimationFrame(s)}requestAnimationFrame(s)}const Bt=document.getElementById("app");function Nf(){as(),ye.subscribe(t=>{Bt.dataset.currentView!==t.view&&as()}),window.addEventListener("popstate",t=>{t.state&&t.state.view&&ye.update("view",t.state.view)})}function as(){const t=ye.get().view;Bt.dataset.currentView=t,Bt.innerHTML="",t==="dashboard"?pa(Bt):t==="builder"&&vf(Bt)}function Tf(t){ye.update("view",t),history.pushState({view:t},"",`#${t}`)}window.navigate=Tf;window.addEventListener("hashchange",()=>{const t=window.location.hash.replace("#","");t&&ye.update("view",t)});export{Nf as initRouter,Tf as navigate};
