import{P as n,A as r,I as D,T as h,a as O,b as y,B as p,W as f,c as w,F,d as k,e as L,f as I,g as U}from"./router-Bo_kZ_w2.js";import"./index-Df0-0_TI.js";const i=360,d="Times New Roman";function H(e){const t=[];t.push(...v(e)),t.push(N()),t.push(new n({alignment:r.CENTER,children:[l(`${(e.collegeName||"").toUpperCase()}${e.collegeAddress?`, ${e.collegeAddress.toUpperCase()}`:""}`,26,!0)],spacing:{after:60,line:i,lineRule:"auto"}})),t.push(new n({alignment:r.CENTER,children:[l(`DEPARTMENT OF ${(e.departmentName||"").toUpperCase()}`,26,!0)],spacing:{after:240,line:i,lineRule:"auto"}}));const u=e.certificateLogo||e.universityLogo;if(u)try{const a=new D({data:u.split(",")[1],transformation:{width:100,height:100}});t.push(new n({alignment:r.CENTER,children:[a],spacing:{after:240,line:i,lineRule:"auto"}}))}catch(a){console.warn("Failed to add certificate logo to DOCX",a)}t.push(new n({alignment:r.CENTER,children:[new h({text:"CERTIFICATE",font:d,size:28,bold:!0,color:"000000"})],spacing:{after:480,line:i,lineRule:"auto"},keepNext:!0,keepLines:!0}));const o=e.certificateText||G(e);o&&o.split(`
`).filter(a=>a.trim()).forEach(a=>{t.push(C(a))}),t.push(...S(e)),t.push(N()),t.push(x("DECLARATION")),e.declarationText&&e.declarationText.split(`
`).filter(a=>a.trim()).forEach(a=>{t.push(C(a))}),t.push(new n({spacing:{before:800}})),t.push(new O({width:{size:100,type:f.PERCENTAGE},borders:{top:{style:p.NONE},bottom:{style:p.NONE},left:{style:p.NONE},right:{style:p.NONE},insideVertical:{style:p.NONE},insideHorizontal:{style:p.NONE}},rows:[new y({children:[new w({children:[new n({children:[l("Date :",24,!0)]})],width:{size:50,type:f.PERCENTAGE}}),new w({children:[new n({alignment:r.RIGHT,children:[l("Signature :",24,!0)]})],width:{size:50,type:f.PERCENTAGE}})]})]})),t.push(N()),e.acknowledgement&&(t.push(x("ACKNOWLEDGEMENT")),e.acknowledgement.split(`
`).filter(a=>a.trim()).forEach(a=>{t.push(C(a))}),t.push(N())),e.abstract&&(t.push(x("ABSTRACT")),e.abstract.split(`
`).filter(a=>a.trim()).forEach(a=>{t.push(C(a))}),t.push(N()));const s=[];e.chapters.forEach((a,g)=>{g>0&&s.push(N()),s.push(new n({alignment:r.CENTER,children:[l(`Chapter ${g+1}`,32,!0)],spacing:{after:120,line:i,lineRule:"auto"},keepNext:!0})),s.push(new n({alignment:r.CENTER,children:[l(a.title.toUpperCase(),32,!0)],spacing:{after:360,line:i,lineRule:"auto"},keepNext:!0}));let m=0,R=0;a.subsections.forEach((c,b)=>{if(c.image){m++;try{const E=(c.width||75)/100,T=6*96*E;let A={width:T,height:T*.75};if(c.imgWidth&&c.imgHeight){const z=c.imgHeight/c.imgWidth;A={width:T,height:T*z}}const P=new D({data:c.image.split(",")[1],transformation:A});s.push(new n({alignment:r.CENTER,children:[P],spacing:{before:240,after:120,line:i,lineRule:"auto"},keepNext:!0})),s.push(new n({alignment:r.CENTER,children:[new h({text:`Figure ${g+1}.${m}: ${c.caption||""}`,font:d,size:22,italics:!0})],spacing:{after:360,line:i,lineRule:"auto"}}))}catch(E){console.warn("Failed to add diagram to DOCX",E)}return}R++,c.title&&s.push(new n({alignment:r.LEFT,children:[l(`${g+1}.${R} ${c.title}`,28,!0)],spacing:{before:240,after:120,line:i,lineRule:"auto"},keepNext:!0,keepLines:!0})),c.content&&c.content.split(`
`).filter(E=>E.trim()).forEach(E=>{s.push(new n({alignment:r.JUSTIFIED,indent:{firstLine:720},children:[l(E,24,!1)],spacing:{after:120,line:i,lineRule:"auto"}}))})})}),e.references&&e.references.trim()&&(s.push(N()),s.push(new n({alignment:r.CENTER,children:[l("REFERENCES",32,!0)],spacing:{after:360,line:i,lineRule:"auto"}})),e.references.split(`
`).filter(g=>g.trim()).forEach((g,m)=>{s.push(new n({children:[l(`[${m+1}] ${g}`,24,!1)],spacing:{after:120,line:i,lineRule:"auto"}}))}));const $=new F({styles:{default:{document:{run:{font:d,size:24},paragraph:{spacing:{line:i,lineRule:"auto"}}}}},sections:[{properties:{page:{margin:{top:1440,bottom:1440,left:2160,right:1440}}},children:t},{properties:{page:{margin:{top:1440,bottom:1440,left:2160,right:1440},pageNumbers:{start:1}}},headers:{},footers:{default:new k({children:[new n({alignment:r.CENTER,children:[new h({children:[L.CURRENT],font:d,size:20})]})]})},children:s}]});I.toBlob($).then(a=>{U.saveAs(a,`${e.projectTitle||"Project_Report"}.docx`)}).catch(a=>{console.error("DOCX generation error:",a),alert("Failed to generate DOCX. Check console for details.")})}function l(e,t,u){return new h({text:e,font:d,size:t,bold:u})}function x(e){return new n({alignment:r.CENTER,children:[new h({text:e,font:d,size:32,bold:!0,underline:{}})],spacing:{after:480,line:i,lineRule:"auto"},keepNext:!0,keepLines:!0})}function C(e){return new n({alignment:r.JUSTIFIED,children:[l(e,24,!1)],spacing:{after:200,line:i,lineRule:"auto"}})}function N(){return new n({children:[new h({break:1})],spacing:{line:i,lineRule:"auto"}})}function v(e){const t=[],u=e.members.filter(o=>o.name).map(o=>`${o.name.toUpperCase()}${o.regNo?` (${o.regNo})`:""}`);if(e.universityLogo)try{const o=new D({data:e.universityLogo.split(",")[1],transformation:{width:100,height:100}});t.push(new n({alignment:r.CENTER,children:[o],spacing:{after:240,line:i,lineRule:"auto"}}))}catch(o){console.warn("Failed to add university logo to DOCX cover page",o)}if(t.push(new n({alignment:r.CENTER,children:[l((e.projectTitle||"").toUpperCase(),32,!0)],spacing:{after:600,line:i,lineRule:"auto"}})),t.push(new n({alignment:r.CENTER,children:[l(e.reportType||"MINI PROJECT REPORT",28,!0)],spacing:{after:600,line:i,lineRule:"auto"}})),t.push(new n({alignment:r.CENTER,children:[new h({text:"Submitted by",font:d,size:24,italics:!0})],spacing:{after:120,line:i,lineRule:"auto"}})),u.forEach(o=>{t.push(new n({alignment:r.CENTER,children:[l(o,24,!0)],spacing:{after:60,line:i,lineRule:"auto"}}))}),t.push(new n({alignment:r.CENTER,children:[new h({text:"Under the guidance of",font:d,size:24,italics:!0})],spacing:{before:360,after:200,line:i,lineRule:"auto"}})),e.guideName&&t.push(new n({alignment:r.CENTER,children:[l(e.guideName.toUpperCase(),28,!0)],spacing:{after:60,line:i,lineRule:"auto"}})),e.guideDesignation&&t.push(new n({alignment:r.CENTER,children:[new h({text:e.guideDesignation,font:d,size:24,italics:!0})],spacing:{after:60,line:i,lineRule:"auto"}})),e.departmentName&&t.push(new n({alignment:r.CENTER,children:[new h({text:`Department of ${e.departmentName}`,font:d,size:24,bold:!0,italics:!0})],spacing:{after:60,line:i,lineRule:"auto"}})),e.collegeName&&t.push(new n({alignment:r.CENTER,children:[new h({text:e.collegeName,font:d,size:24,bold:!0,italics:!0})],spacing:{after:120,line:i,lineRule:"auto"}})),t.push(new n({alignment:r.CENTER,children:[l("to",24,!1)],spacing:{after:120,line:i,lineRule:"auto"}})),e.universityName){const o=`the ${e.universityName}${e.collegeAddress?`, ${e.collegeAddress}`:""}`;t.push(new n({alignment:r.CENTER,children:[l(o,24,!0)],spacing:{after:120,line:i,lineRule:"auto"}}))}if(t.push(new n({alignment:r.CENTER,children:[l("in partial fulfillment of the requirements for the award of",24,!1)],spacing:{after:60,line:i,lineRule:"auto"}})),t.push(new n({alignment:r.CENTER,children:[l(e.degreeName||e.course||"",24,!1)],spacing:{after:480,line:i,lineRule:"auto"}})),e.departmentName&&t.push(new n({alignment:r.CENTER,children:[l(`Department of ${e.departmentName}`,26,!0)],spacing:{before:480,after:60,line:i,lineRule:"auto"}})),e.collegeName){const o=`${e.collegeName}${e.collegeAddress?`, ${e.collegeAddress}`:""}`;t.push(new n({alignment:r.CENTER,children:[new h({text:o,font:d,size:24,bold:!0,italics:!0})],spacing:{line:i,lineRule:"auto"}}))}return t}function G(e){const t=e.members.filter(u=>u.name).map(u=>`${u.name.toUpperCase()}${u.regNo?` (${u.regNo})`:""}`).join(", ")||"[Member Names]";return`Certified that this report entitled '${e.projectTitle||"[Project Title]"}' is the report of ${(e.reportType||"mini project").toLowerCase()} presented by ${t} during the year (${e.academicYear||"[Year]"}) in partial fulfilment of the requirements for the award of the Degree of ${e.degreeName||e.course||"[Degree]"} of the ${e.universityName||"[University Name]"}${e.collegeAddress?`, ${e.collegeAddress}`:""}.`}function S(e){const t=[],u=e.departmentName?`Department of ${e.departmentName}`:"",o=e.collegeName||"";function s(a,g,m,R){if(!a)return[new n({})];const c=[],b=R?`Department of ${R}`:u;return c.push(new n({alignment:r.CENTER,children:[l(a,22,!0)],spacing:{line:i,lineRule:"auto"}})),g&&c.push(new n({alignment:r.CENTER,children:[new h({text:`(${g})`,font:d,size:20,italics:!0})],spacing:{line:i,lineRule:"auto"}})),m&&c.push(new n({alignment:r.CENTER,children:[l(m,20,!1)],spacing:{line:i,lineRule:"auto"}})),b&&c.push(new n({alignment:r.CENTER,children:[l(b,20,!1)],spacing:{line:i,lineRule:"auto"}})),o&&c.push(new n({alignment:r.CENTER,children:[l(o,20,!1)],spacing:{line:i,lineRule:"auto"}})),c}t.push(new n({spacing:{before:600,line:i,lineRule:"auto"},children:[]}));const $=new O({width:{size:100,type:f.PERCENTAGE},borders:{top:{style:p.NONE},bottom:{style:p.NONE},left:{style:p.NONE},right:{style:p.NONE},insideVertical:{style:p.NONE},insideHorizontal:{style:p.NONE}},rows:[new y({children:[new w({children:s(e.guideName,"Project Guide",e.guideDesignation,e.guideDepartment),width:{size:50,type:f.PERCENTAGE},margins:{bottom:400}}),new w({children:s(e.coordinator1Name,"Project Coordinator",e.coordinator1Designation,e.coordinator1Department),width:{size:50,type:f.PERCENTAGE},margins:{bottom:400}})]}),new y({children:[new w({children:[new n({spacing:{after:400}})],columnSpan:2,borders:{top:{style:p.NONE},bottom:{style:p.NONE}}})]}),new y({children:[new w({children:s(e.coordinator2Name,"Project Coordinator",e.coordinator2Designation,e.coordinator2Department),width:{size:50,type:f.PERCENTAGE}}),new w({children:s(e.hodName,e.hodDesignation||"HOD",(e.hodDesignation,""),e.hodDepartment),width:{size:50,type:f.PERCENTAGE}})]})]});return t.push($),t}export{H as generateReportDocx};
